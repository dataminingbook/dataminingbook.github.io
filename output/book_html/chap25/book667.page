<div id="pf29b" class="pf w0 h0" data-page-no="29b"><div class="pc pc29b w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg29b.png"/><div class="t m0 x99 hb y24 ff8 fs0 fc1 sc0 ls0 ws0">Multilayer<span class="_ _3"> </span>Perceptr<span class="_"> </span>on:<span class="_ _a"> </span>One<span class="_ _3"> </span>Hidden<span class="_ _3"> </span>Layer<span class="_ _26"> </span><span class="ff2">655</span></div><div class="t m0 xdd h4 y6da ff7 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _7"> </span>25.1:<span class="_ _3"> </span><span class="ff4">MLP<span class="_ _a"> </span>Training:<span class="_ _a"> </span>Stochastic<span class="_ _3"> </span>Gradie<span class="_ _5"></span>nt<span class="_ _3"> </span>De<span class="_"> </span>sce<span class="_ _5"></span>nt</span></div><div class="t m0 x4b h16 y6db ffa fs2 fc1 sc0 ls0 ws0">MLP-T<span class="fs5">R<span class="_ _1b"></span>A<span class="_ _5"></span>I<span class="_ _1b"></span>N<span class="_ _1b"></span>I<span class="_ _1b"></span>N<span class="_ _1b"></span>G<span class="_ _7"> </span></span>(D<span class="ff6">,<span class="_ _0"></span>m,<span class="_ _f"></span>η<span class="_ _5"></span>,<span class="_ _0"> </span><span class="ffd">max<span class="_ _5"></span>iter</span></span>):</div><div class="t m0 x4b h34 y6dc ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_"> </span>bias<span class="_"> </span>vectors</div><div class="t m0 xec h16 y6dd ffa fs12 fc1 sc0 ls0 ws0">1<span class="_ _c"> </span><span class="fs2">b</span></div><div class="t m0 xde h6 y6de ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x4e h4 y6dd ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _a"> </span><span class="ff4">random<span class="_ _3"> </span><span class="ff6">m</span>-<span class="_ _5"></span>dimensional<span class="_ _a"> </span>vector<span class="_ _3"> </span>with<span class="_ _a"> </span>small<span class="_ _a"> </span>values</span></div><div class="t m0 xec h16 y6df ffa fs12 fc1 sc0 ls0 ws0">2<span class="_ _c"> </span><span class="fs2">b</span></div><div class="t m0 xde h6 y6e0 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x4e h4 y6df ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _a"> </span><span class="ff4">random<span class="_ _3"> </span><span class="ff6">p<span class="_ _5"></span></span>-dimensional<span class="_ _a"> </span>v<span class="_ _5"></span>ector<span class="_ _a"> </span>with<span class="_ _3"> </span>small<span class="_ _a"> </span>values</span></div><div class="t m0 x4b h34 y6e1 ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_"> </span>weight<span class="_"> </span>matrices</div><div class="t m0 xec h16 y6e2 ffa fs12 fc1 sc0 ls0 ws0">3<span class="_ _c"> </span><span class="fs2">W</span></div><div class="t m0 xcd h6 y6e3 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x9a h4 y6e2 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff4">random<span class="_ _a"> </span><span class="ff6">d<span class="_ _3"> </span></span></span>×<span class="_ _b"></span><span class="ff6">m<span class="_ _a"> </span><span class="ff4">matrix<span class="_ _a"> </span>with<span class="_ _a"> </span>small<span class="_ _3"> </span>va<span class="_ _5"></span>lues</span></span></div><div class="t m0 xec h16 y6e4 ffa fs12 fc1 sc0 ls0 ws0">4<span class="_ _c"> </span><span class="fs2">W</span></div><div class="t m0 xcd h6 y6e5 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x9a h4 y6e4 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff4">random<span class="_ _a"> </span><span class="ff6">m<span class="_ _b"> </span></span></span>×<span class="_ _b"></span><span class="ff6">p<span class="_ _7"> </span><span class="ff4">matrix<span class="_ _3"> </span>with<span class="_ _a"> </span>small<span class="_ _a"> </span>values</span></span></div><div class="t m0 xec h4 y6e6 ffa fs12 fc1 sc0 ls0 ws0">5<span class="_ _c"> </span><span class="ff6 fs2">t<span class="_ _7"> </span><span class="ff5">←<span class="_ _3"> </span><span class="ff4">0<span class="_ _a"> </span><span class="ffd">//<span class="_"> </span>iterati<span class="_ _5"></span>on<span class="_ _c"> </span>co<span class="_ _5"></span>unter</span></span></span></span></div><div class="t m0 xec h16 y6e7 ffa fs12 fc1 sc0 ls0 ws0">6<span class="_ _c"> </span><span class="fs2">repe<span class="_ _5"></span>at</span></div><div class="t m0 xec h16 y6e8 ffa fs12 fc1 sc0 ls0 ws0">7<span class="_ _34"> </span><span class="fs2">foreach<span class="_ _a"> </span><span class="ff6">(</span>x</span></div><div class="t m0 x6b h6 y6e9 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x3f h16 y6e8 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ffa">y</span></div><div class="t m0 x74 h6 y6e9 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x9c h8 y6e8 ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff5">∈<span class="_ _3"> </span><span class="ffa">D<span class="_ _a"> </span><span class="ff3">in<span class="_ _3"> </span>random<span class="_ _a"> </span>order<span class="_ _a"> </span></span>do</span></span></div><div class="t m0 x17 h34 y6ea ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Feed-<span class="_ _5"></span>forwar<span class="_ _5"></span>d<span class="_ _c"> </span>phase</div><div class="t m0 xcb h16 y6eb ffa fs12 fc1 sc0 ls0 ws0">8<span class="_ _35"> </span><span class="fs2">z</span></div><div class="t m0 x3e h6 y6ec ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x9b h8 y6eb ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff6">f</span></div><div class="t m0 x3f h14 y6ed ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x7 h16 y6eb ffa fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 x74 h6 y6ec ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xb3 h8 y6eb ff5 fs2 fc1 sc0 ls0 ws0">+<span class="_ _b"></span><span class="ffa">W</span></div><div class="t m0 xb4 h15 y6ee ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 xf6 h6 y6ef ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x8c h16 y6f0 ffa fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x59 h6 y6f1 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x92 h14 y6ed ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xcb h16 y6f2 ffa fs12 fc1 sc0 ls0 ws0">9<span class="_ _35"> </span><span class="fs2">o</span></div><div class="t m0 x3e h6 y6f3 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xdf h8 y6f2 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff6">f</span></div><div class="t m0 x3f h14 y6f4 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xcf h16 y6f2 ffa fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 xbe h6 y6f3 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xb3 h8 y6f2 ff5 fs2 fc1 sc0 ls0 ws0">+<span class="_ _b"></span><span class="ffa">W</span></div><div class="t m0 xa4 h15 y6f5 ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 xb4 h6 y6f6 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x40 h16 y6f2 ffa fs2 fc1 sc0 ls0 ws0">z</div><div class="t m0 x59 h6 y6f3 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x92 h14 y6f7 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x17 h34 y6f8 ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Backp<span class="_ _5"></span>ropaga<span class="_ _5"></span>tion<span class="_ _c"> </span>phase:<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts</div><div class="t m0 xdd h2b y6f9 ffa fs12 fc1 sc0 ls0 ws0">10<span class="_ _35"> </span><span class="fff fs2">δ</span></div><div class="t m0 x3e h6 y6fa ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xdf h8 y6f9 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">o</span></div><div class="t m0 x68 h6 y6fa ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xcf h8 y6f9 ff5 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _9"> </span><span class="ff6">(<span class="ffa">1<span class="_ _b"> </span></span></span>−<span class="_ _b"></span><span class="ffa">o</span></div><div class="t m0 x30 h6 y6fa ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x59 h8 y6f9 ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _6"> </span><span class="ff5">⊙<span class="_ _9"> </span></span>(<span class="ffa">o</span></div><div class="t m0 x35 h6 y6fa ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x33 h8 y6f9 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ffa">y</span></div><div class="t m0 x52 h6 y6fa ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x36 h7 y6f9 ff6 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 xdd h2b y6fb ffa fs12 fc1 sc0 ls0 ws0">11<span class="_ _35"> </span><span class="fff fs2">δ</span></div><div class="t m0 x3e h6 y6fc ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xdf h8 y6fb ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">z</span></div><div class="t m0 x6b h6 y6fc ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x7 h8 y6fb ff5 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _9"> </span><span class="ff6">(<span class="ffa">1<span class="_ _b"> </span></span></span>−<span class="_ _b"></span><span class="ffa">z</span></div><div class="t m0 x40 h6 y6fc ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x30 h8 y6fb ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _6"> </span><span class="ff5">⊙<span class="_ _9"> </span></span>(<span class="ffa">W</span></div><div class="t m0 xe6 h6 y6fc ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x2e h8 y6fb ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="fff">δ</span></div><div class="t m0 x8e h6 y6fc ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xee h7 y6fb ff6 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 x17 h34 y6fd ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ent<span class="_ _c"> </span>d<span class="_ _5"></span>escent<span class="_"> </span>for<span class="_"> </span>bias<span class="_"> </span>vectors</div><div class="t m0 xdd h2c y6fe ffa fs12 fc1 sc0 ls0 ws0">12<span class="_ _35"> </span><span class="ff10 fs2">∇</span></div><div class="t m0 xc2 h25 y6ff ffa fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 xdf h22 y700 ff6 fsb fc1 sc0 ls0 ws0">o</div><div class="t m0 x2a h8 y701 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="fff">δ</span></div><div class="t m0 x7 h6 y702 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x8 h8 y701 ff5 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ffa">b</span></div><div class="t m0 x9e h6 y702 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xb4 h8 y701 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">b</span></div><div class="t m0 x97 h6 y702 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xfc h8 y701 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff10">∇</span></div><div class="t m0 x14 h25 y702 ffa fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 x19 h22 y703 ff6 fsb fc1 sc0 ls0 ws0">o</div><div class="t m0 xdd h2c y704 ffa fs12 fc1 sc0 ls0 ws0">13<span class="_ _35"> </span><span class="ff10 fs2">∇</span></div><div class="t m0 xc2 h25 y705 ffa fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 xdf h22 y706 ff6 fsb fc1 sc0 ls0 ws0">h</div><div class="t m0 x2a h8 y704 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="fff">δ</span></div><div class="t m0 x7 h6 y705 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x8 h8 y704 ff5 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ffa">b</span></div><div class="t m0 x9e h6 y705 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xb4 h8 y704 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">b</span></div><div class="t m0 xa9 h6 y705 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xa5 h8 y704 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _4"> </span></span>·<span class="_ _b"></span><span class="ff10">∇</span></div><div class="t m0 x8e h25 y705 ffa fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 x52 h22 y706 ff6 fsb fc1 sc0 ls0 ws0">h</div><div class="t m0 x17 h34 y4a8 ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ent<span class="_ _c"> </span>d<span class="_ _5"></span>escent<span class="_"> </span>for<span class="_"> </span>weight<span class="_"> </span>matrice<span class="_ _5"></span>s</div><div class="t m0 xdd h2c y4ad ffa fs12 fc1 sc0 ls0 ws0">14<span class="_ _35"> </span><span class="ff10 fs2">∇</span></div><div class="t m0 xc2 h25 y707 ffa fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x105 h22 y708 ff6 fsb fc1 sc0 ls0 ws0">o</div><div class="t m0 x4d h8 y709 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">z</span></div><div class="t m0 x5b h6 y70a ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xbe h8 y709 ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="fff">δ</span></div><div class="t m0 x2c h15 y70b ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x2c h6 y70c ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x2d h8 y709 ff5 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ffa">W</span></div><div class="t m0 xa8 h6 y70a ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x9f h8 y709 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ffa">W</span></div><div class="t m0 x33 h6 y70a ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x54 h8 y709 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff10">∇</span></div><div class="t m0 x37 h25 y70a ffa fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x56 h22 y70d ff6 fsb fc1 sc0 ls0 ws0">o</div><div class="t m0 xdd h2c y70e ffa fs12 fc1 sc0 ls0 ws0">15<span class="_ _35"> </span><span class="ff10 fs2">∇</span></div><div class="t m0 xc2 h25 y70f ffa fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x105 h22 y710 ff6 fsb fc1 sc0 ls0 ws0">h</div><div class="t m0 xa3 h8 y70e ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">x</span></div><div class="t m0 xbf h6 y70f ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xbe h8 y70e ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="fff">δ</span></div><div class="t m0 x2c h15 y711 ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x2c h6 y712 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x77 h8 y713 ff5 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ffa">W</span></div><div class="t m0 xa8 h6 y714 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x9f h8 y713 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">W</span></div><div class="t m0 x50 h6 y714 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x2f h8 y713 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _4"> </span></span>·<span class="_ _b"></span><span class="ff10">∇</span></div><div class="t m0 x55 h25 y714 ffa fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x43 h22 y715 ff6 fsb fc1 sc0 ls0 ws0">h</div><div class="t m0 xdd h4 y716 ffa fs12 fc1 sc0 ls0 ws0">16<span class="_ _34"> </span><span class="ff6 fs2">t<span class="_ _7"> </span><span class="ff5">←<span class="_ _4"></span></span>t<span class="_ _a"> </span><span class="ff5">+<span class="_ _b"></span><span class="ff4">1</span></span></span></div><div class="t m0 x25 h8 y717 ffa fs12 fc1 sc0 ls0 ws0">17<span class="_ _c"> </span><span class="fs2">until<span class="_ _a"> </span><span class="ff6">t<span class="_ _7"> </span><span class="ff5">≥<span class="_ _3"> </span><span class="ffd">maxi<span class="_ _5"></span>ter</span></span></span></span></div><div class="t m0 x6 h4 y718 ff4 fs2 fc1 sc0 ls0 ws0">Once<span class="_ _a"> </span>the<span class="_ _a"> </span>gradients<span class="_ _3"> </span>ha<span class="_"> </span>v<span class="_ _5"></span>e<span class="_ _3"> </span>bee<span class="_ _5"></span>n<span class="_ _a"> </span>computed,<span class="_ _3"> </span>we<span class="_ _a"> </span>can<span class="_ _a"> </span>update<span class="_ _a"> </span>all<span class="_ _a"> </span>the<span class="_ _3"> </span>we<span class="_ _5"></span>ights<span class="_ _3"> </span>a<span class="_ _5"></span>nd<span class="_ _a"> </span>biases</div><div class="t m0 x3 h4 y435 ff4 fs2 fc1 sc0 ls0 ws0">as<span class="_ _a"> </span>follows</div><div class="t m0 xc4 h16 y719 ffa fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 x9f h6 y71a ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xdc h8 y719 ff5 fs2 fc1 sc0 ls0 ws0">=<span class="_ _4"></span><span class="ffa">W</span></div><div class="t m0 x2e h6 y71a ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x14 h8 y719 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff10">∇</span></div><div class="t m0 x8f h25 y71a ffa fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 xea h22 y71b ff6 fsb fc1 sc0 ls0 ws0">h</div><div class="t m0 xa8 h16 y71c ffa fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 x9f h6 y71d ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xdc h8 y71c ff5 fs2 fc1 sc0 ls0 ws0">=<span class="_ _4"></span><span class="ffa">b</span></div><div class="t m0 x33 h6 y71d ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x54 h8 y71c ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff10">∇</span></div><div class="t m0 xca h25 y71d ffa fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 x55 h22 y71e ff6 fsb fc1 sc0 ls0 ws0">h</div><div class="t m0 xac h4 y71f ff4 fs2 fc1 sc0 ls0 ws0">(25.42)</div><div class="t m0 x3 h4 y720 ff4 fs2 fc1 sc0 ls0 ws0">where<span class="_ _a"> </span><span class="ff6">η<span class="_ _a"> </span></span>is<span class="_ _a"> </span>the<span class="_ _a"> </span>step<span class="_ _3"> </span>size<span class="_ _a"> </span>(or<span class="_ _a"> </span>learning<span class="_ _a"> </span>rate).</div><div class="t m0 x3 h23 y721 ff1 fs4 fc2 sc0 ls0 ws0">25.3.3<span class="_ _d"> </span><span class="ff7 fsc fc1">MLP<span class="_ _7"> </span>T<span class="_ _18"></span>r<span class="_ _18"></span>a<span class="_ _5"></span>ining</span></div><div class="t m0 x3 h4 y722 ff4 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _7"> </span>25.1<span class="_ _7"> </span>shows<span class="_ _a"> </span>t<span class="_ _5"></span>he<span class="_ _7"> </span>pseudo-code<span class="_ _7"> </span>for<span class="_ _7"> </span>learning<span class="_ _a"> </span>t<span class="_ _5"></span>he<span class="_ _7"> </span>weights<span class="_ _7"> </span>considering<span class="_ _7"> </span>all<span class="_ _a"> </span>of<span class="_ _7"> </span>the</div><div class="t m0 x3 h4 y723 ff4 fs2 fc1 sc0 ls0 ws0">input<span class="_ _7"> </span>points<span class="_ _7"> </span>in<span class="_ _6"> </span><span class="ffa">D<span class="_ _7"> </span></span>via<span class="_ _7"> </span><span class="ff3">stochastic<span class="_ _7"> </span>gra<span class="_ _5"></span>dient<span class="_ _7"> </span>descent</span>.<span class="_ _7"> </span>The<span class="_ _6"> </span>code<span class="_ _7"> </span>is<span class="_ _7"> </span>shown<span class="_ _7"> </span>f<span class="_ _5"></span>or<span class="_ _7"> </span>an<span class="_ _7"> </span>MLP<span class="_ _6"> </span>with</div><div class="t m0 x3 h4 y724 ff4 fs2 fc1 sc0 ls0 ws0">a<span class="_ _6"> </span>single<span class="_ _6"> </span>hidden<span class="_ _6"> </span>lay<span class="_ _5"></span>er,<span class="_ _6"> </span>using<span class="_ _6"> </span>a<span class="_ _6"> </span>squared<span class="_ _6"> </span>error<span class="_ _6"> </span>funct<span class="_ _5"></span>ion,<span class="_ _6"> </span>and<span class="_ _6"> </span>sigmoid<span class="_ _6"> </span>activa<span class="_"> </span>t<span class="_ _5"></span>ions<span class="_ _7"> </span>for<span class="_ _9"> </span>all</div><div class="t m0 x3 h4 y725 ff4 fs2 fc1 sc0 ls0 ws0">hidden<span class="_ _4"> </span>and<span class="_ _4"> </span>output<span class="_ _3"> </span>neurons.<span class="_ _4"> </span>The<span class="_ _3"> </span>approach<span class="_ _4"> </span>is<span class="_ _4"> </span>ca<span class="_ _5"></span>lled<span class="_ _4"> </span>stochastic<span class="_ _4"> </span>gradient<span class="_ _4"> </span>de<span class="_"> </span>sce<span class="_ _5"></span>nt<span class="_ _4"> </span>since<span class="_ _4"> </span>we</div><div class="t m0 x3 h4 y726 ff4 fs2 fc1 sc0 ls0 ws0">compute<span class="_ _a"> </span>the<span class="_ _7"> </span>weight<span class="_ _a"> </span>and<span class="_ _a"> </span>bias<span class="_ _a"> </span>g<span class="_ _5"></span>radients<span class="_ _a"> </span>aft<span class="_ _5"></span>er<span class="_ _a"> </span>observing<span class="_ _a"> </span>each<span class="_ _a"> </span>training<span class="_ _7"> </span>point<span class="_ _a"> </span>(in<span class="_ _a"> </span>random</div><div class="t m0 x3 h4 y727 ff4 fs2 fc1 sc0 ls0 ws0">order).</div><div class="t m0 x6 h4 y3ec ff4 fs2 fc1 sc0 ls0 ws0">The<span class="_ _1"> </span>MLP<span class="_ _c"> </span>algorithm<span class="_ _1"> </span>ta<span class="_ _5"></span>kes<span class="_ _1"> </span>as<span class="_ _c"> </span>input<span class="_ _1"> </span>the<span class="_ _c"> </span>dataset<span class="_ _1"> </span><span class="ffa">D<span class="_ _c"> </span></span>(with<span class="_ _1"> </span>points<span class="_ _c"> </span><span class="ffa">x</span></div><div class="t m0 x78 h6 y3ed ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x57 h4 y3ec ff4 fs2 fc1 sc0 ls0 ws0">and<span class="_ _1"> </span>desired</div><div class="t m0 x3 h4 y3ef ff4 fs2 fc1 sc0 ls0 ws0">responses<span class="_ _4"> </span><span class="ffa">y</span></div><div class="t m0 x4e h6 y3f0 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x28 h4 y3ef ff4 fs2 fc1 sc0 ls0 ws0">for<span class="_ _4"> </span><span class="ff6">i<span class="_ _3"> </span><span class="ff5">=<span class="_ _b"></span></span></span>1<span class="ff6">,<span class="_ _0"> </span></span>2<span class="ff6">,<span class="_ _0"> </span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _3"> </span></span>,<span class="_ _0"> </span>n</span>),<span class="_ _3"> </span>the<span class="_ _4"> </span>number<span class="_ _4"> </span>of<span class="_ _3"> </span>hidden<span class="_ _4"> </span>layer<span class="_ _4"> </span>neurons<span class="_ _4"> </span><span class="ff6">m<span class="_"> </span></span>,<span class="_ _3"> </span>the<span class="_ _4"> </span>learning<span class="_ _4"> </span>rate</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
