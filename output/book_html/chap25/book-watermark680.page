<div id="pf2a8" class="pf w0 h0" data-page-no="2a8"><div class="pc pc2a8 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg2a8.png"/><div class="t m0 x11 hf y2a ff2 fs0 fc1 sc0 ls0 ws0">668<span class="_ _e"> </span><span class="ffa">Neural<span class="_ _3"> </span>Networks</span></div><div class="t m0 xc9 h4 y54f ff8 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _a"> </span>25.2:<span class="_ _a"> </span><span class="ff4">Deep<span class="_ _a"> </span>MLP<span class="_ _a"> </span>Training:<span class="_ _a"> </span>Stochastic<span class="_ _3"> </span>Gradient<span class="_ _a"> </span>Descent</span></div><div class="t m0 x42 h1a y3be ffc fs2 fc1 sc0 ls0 ws0">D<span class="fs5">E<span class="_ _54"></span>E<span class="_ _54"></span>P<span class="_ _5"></span></span>-MLP-T<span class="fs5">R<span class="_ _54"></span>A<span class="_ _54"></span>I<span class="_ _5"></span>N<span class="_ _54"></span>I<span class="_ _54"></span>N<span class="_ _54"></span>G<span class="_ _7"> </span></span>(D<span class="ff6">,<span class="_ _f"></span>h,<span class="_ _0"> </span>η<span class="_ _5"></span>,<span class="_ _f"></span><span class="fff">m<span class="_ _5"></span>axite<span class="_ _5"></span>r</span>,<span class="_ _f"></span>n</span></div><div class="t m0 xd3 h5 y3bf ff4 fs3 fc1 sc0 ls0 ws0">1</div><div class="t m0 xb1 h7 y3be ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span>n</div><div class="t m0 xa5 h5 y3bf ff4 fs3 fc1 sc0 ls0 ws0">2</div><div class="t m0 x3f h8 y3be ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span>n</div><div class="t m0 x89 h6 y3bf ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xfc h7 y3be ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span>f</div><div class="t m0 x4e h5 y13fe ff4 fs3 fc1 sc0 ls0 ws0">1</div><div class="t m0 xdf h7 y3be ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span>f</div><div class="t m0 x72 h5 y13fe ff4 fs3 fc1 sc0 ls0 ws0">2</div><div class="t m0 x86 h8 y3be ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span>f</div><div class="t m0 x77 h5 y13fe ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xf6 h1a y3be ffc fs2 fc1 sc0 ls0 ws0">):</div><div class="t m0 x105 h7 y144 ffc fs14 fc1 sc0 ls0 ws0">1<span class="_ _c"> </span><span class="ff6 fs2">n</span></div><div class="t m0 x2c h5 y145 ff4 fs3 fc1 sc0 ls0 ws0">0</div><div class="t m0 x6e h8 y144 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ff6">d<span class="_ _6"> </span><span class="fff">//<span class="_"> </span>input<span class="_"> </span>layer<span class="_"> </span>size</span></span></div><div class="t m0 x105 h7 y13ff ffc fs14 fc1 sc0 ls0 ws0">2<span class="_ _c"> </span><span class="ff6 fs2">n</span></div><div class="t m0 x2c h5 y1400 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x9a h8 y13ff ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff6">p<span class="_ _7"> </span><span class="fff">//<span class="_"> </span>output<span class="_"> </span>layer<span class="_"> </span>size</span></span></div><div class="t m0 x42 h39 y12e5 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_ _c"> </span>we<span class="_ _5"></span>ight<span class="_"> </span>matrices<span class="_"> </span>and<span class="_"> </span>bias<span class="_"> </span>vector<span class="_ _5"></span>s</div><div class="t m0 x105 h4 y1401 ffc fs14 fc1 sc0 ls0 ws0">3<span class="_ _c"> </span><span class="fs2">f<span class="_"> </span>or<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"> </span><span class="ff4">0<span class="_ _5"></span></span></span>,<span class="_ _f"></span><span class="ff4">1<span class="_ _5"></span></span>,<span class="_ _f"></span><span class="ff4">2<span class="_ _5"></span></span>,<span class="_ _f"></span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span>h<span class="_ _a"> </span></span>do</span></div><div class="t m0 x50 h1a y1402 ffc fs14 fc1 sc0 ls0 ws0">4<span class="_ _31"> </span><span class="fs2">b</span></div><div class="t m0 x9a h6 y1403 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x5 h4 y1402 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff4">random<span class="_ _a"> </span><span class="ff6">n</span></span></div><div class="t m0 xa2 h5 y1403 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x35 h4 y1402 ff4 fs2 fc1 sc0 ls0 ws0">vector<span class="_ _a"> </span>with<span class="_ _a"> </span>small<span class="_ _3"> </span>v<span class="_ _5"></span>alues</div><div class="t m0 x50 h1a y1d4 ffc fs14 fc1 sc0 ls0 ws0">5<span class="_ _31"> </span><span class="fs2">W</span></div><div class="t m0 xde h6 y11ef ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xdb h4 y1d4 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff4">random<span class="_ _a"> </span><span class="ff6">n</span></span></div><div class="t m0 xfa h6 y11ef ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x27 h8 y1d4 ff5 fs2 fc1 sc0 ls0 ws0">×<span class="_ _b"></span><span class="ff6">n</span></div><div class="t m0 x9b h5 y11ef ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x91 h4 y1d4 ff4 fs2 fc1 sc0 ls0 ws0">matrix<span class="_ _a"> </span>with<span class="_ _3"> </span>small<span class="_ _a"> </span>values</div><div class="t m0 x105 h4 y1404 ffc fs14 fc1 sc0 ls0 ws0">6<span class="_ _c"> </span><span class="ff6 fs2">t<span class="_ _7"> </span><span class="ff5">←<span class="_ _3"> </span><span class="ff4">0<span class="_ _a"> </span><span class="fff">//<span class="_"> </span>iterati<span class="_ _5"></span>on<span class="_ _c"> </span>co<span class="_ _5"></span>unter</span></span></span></span></div><div class="t m0 x105 h1a y1405 ffc fs14 fc1 sc0 ls0 ws0">7<span class="_ _c"> </span><span class="fs2">repe<span class="_ _5"></span>at</span></div><div class="t m0 x50 h1a y1406 ffc fs14 fc1 sc0 ls0 ws0">8<span class="_ _31"> </span><span class="fs2">foreach<span class="_ _a"> </span><span class="ff6">(</span>x</span></div><div class="t m0 xd2 h6 y1407 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x8f h1a y1406 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ffc">y</span></div><div class="t m0 xa1 h6 y1407 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x31 h8 y1406 ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff5">∈<span class="_ _4"> </span><span class="ffc">D<span class="_ _a"> </span><span class="ff3">in<span class="_ _a"> </span>random<span class="_ _a"> </span>order<span class="_ _a"> </span></span>do</span></span></div><div class="t m0 xc5 h39 y21d fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Feed-<span class="_ _5"></span>Forwar<span class="_ _5"></span>d<span class="_ _c"> </span>Phase</div><div class="t m0 x50 h1a y2ee ffc fs14 fc1 sc0 ls0 ws0">9<span class="_ _32"> </span><span class="fs2">z</span></div><div class="t m0 xe3 h5 y1408 ff4 fs3 fc1 sc0 ls0 ws0">0</div><div class="t m0 xb6 h8 y2ee ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">x</span></div><div class="t m0 xd2 h6 y4a9 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xc9 h4 y1409 ffc fs14 fc1 sc0 ls0 ws0">10<span class="_ _32"> </span><span class="fs2">for<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"></span><span class="ff4">0</span></span>,<span class="_ _0"> </span><span class="ff4">1</span>,<span class="_ _0"> </span><span class="ff4">2</span>,<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>,<span class="_ _0"> </span>h<span class="_ _a"> </span></span>do</span></div><div class="t m0 xc9 h1a y4 ffc fs14 fc1 sc0 ls0 ws0">11<span class="_ _57"> </span><span class="fs2">z</span></div><div class="t m0 x5e h5 y1208 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x78 h8 y4 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff6">f</span></div><div class="t m0 x26 h5 y1208 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x45 h18 y140a ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xc7 h1a y4 ffc fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 x82 h6 y1a4 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xa3 h8 y4 ff5 fs2 fc1 sc0 ls0 ws0">+<span class="_ _b"></span><span class="ffc">W</span></div><div class="t m0 xea h19 y1208 ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 xea h6 y4ab ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x1d h8 y4 ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ffc">z</span></div><div class="t m0 x1e h6 y1208 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xf2 h18 y140a ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xc9 h1a y140b ffc fs14 fc1 sc0 ls0 ws0">12<span class="_ _32"> </span><span class="fs2">o</span></div><div class="t m0 x2e h6 ye0 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xb6 h8 y140b ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">z</span></div><div class="t m0 xd2 h5 y140c ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xc5 h39 y11c fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Backp<span class="_ _5"></span>ropaga<span class="_ _5"></span>tion<span class="_ _c"> </span>Phase</div><div class="t m0 xc9 h17 y140d ffc fs14 fc1 sc0 ls0 ws0">13<span class="_ _32"> </span><span class="fs2">if<span class="_ _a"> </span><span class="ff3">independent<span class="_ _a"> </span>outputs<span class="_ _3"> </span></span>the<span class="_ _5"></span>n</span></div><div class="t m0 xc9 h30 y140e ffc fs14 fc1 sc0 ls0 ws0">14<span class="_ _57"> </span><span class="ff11 fs2">δ</span></div><div class="t m0 x5e h5 y140f ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xc2 h8 y140e ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ff6">∂<span class="_ _f"></span><span class="ffc">f</span></span></div><div class="t m0 xb8 h5 y1410 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x82 h8 y140e ff5 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _6"> </span><span class="ff6">∂<span class="_ _f"></span><span class="ff13">E</span></span></div><div class="t m0 xea h2a y465 ffc fs3 fc1 sc0 ls0 ws0">x</div><div class="t m0 x54 h26 ye7 ff6 fsd fc1 sc0 ls0 ws0">i</div><div class="t m0 x1d h39 y140e fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gra<span class="_ _5"></span>dients<span class="_ _c"> </span>a<span class="_ _5"></span>t<span class="_"> </span>output</div><div class="t m0 xc9 h1a y1411 ffc fs14 fc1 sc0 ls0 ws0">15<span class="_ _32"> </span><span class="fs2">else</span></div><div class="t m0 xc9 h30 y2f8 ffc fs14 fc1 sc0 ls0 ws0">16<span class="_ _57"> </span><span class="ff11 fs2">δ</span></div><div class="t m0 x5e h5 y515 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xc2 h8 y2f8 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ff6">∂<span class="_ _f"></span><span class="ffc">F</span></span></div><div class="t m0 x27 h5 y1412 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x82 h8 y2f8 ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff6">∂<span class="_ _f"></span><span class="ff13">E</span></span></div><div class="t m0 x53 h2a y1413 ffc fs3 fc1 sc0 ls0 ws0">x</div><div class="t m0 x39 h26 y46d ff6 fsd fc1 sc0 ls0 ws0">i</div><div class="t m0 xea h39 y2f8 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _c"> </span>a<span class="_ _5"></span>t<span class="_"> </span>output</div><div class="t m0 xc9 h4 y4b6 ffc fs14 fc1 sc0 ls0 ws0">17<span class="_ _32"> </span><span class="fs2">for<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"></span></span>h,<span class="_ _f"></span>h<span class="_ _b"> </span><span class="ff5">−<span class="_ _4"></span><span class="ff4">1</span></span>,<span class="_ _f"></span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span><span class="ff4">1<span class="_ _a"> </span></span></span>do</span></div><div class="t m0 xc9 h30 y4b8 ffc fs14 fc1 sc0 ls0 ws0">18<span class="_ _57"> </span><span class="ff11 fs2">δ</span></div><div class="t m0 x5e h6 y1414 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xeb h8 y4b8 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ff6">∂<span class="_ _f"></span><span class="ffc">f</span></span></div><div class="t m0 x32 h6 y1415 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xfe h8 y4b8 ff5 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 x35 h18 y132d ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xc7 h1a y4b8 ffc fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xa3 h6 y1416 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xe0 h8 y4b8 ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff11">δ</span></div><div class="t m0 x88 h5 y1414 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x1d h18 y132d ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x19 h39 y4b8 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _c"> </span>a<span class="_ _5"></span>t<span class="_"> </span>layer<span class="_"> </span><span class="ff6">l</span></div><div class="t m0 xc5 h39 y5e fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ent<span class="_ _c"> </span>D<span class="_ _5"></span>escent<span class="_"> </span>Step</div><div class="t m0 xc9 h4 y1417 ffc fs14 fc1 sc0 ls0 ws0">19<span class="_ _32"> </span><span class="fs2">for<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"></span><span class="ff4">0</span></span>,<span class="_ _0"> </span><span class="ff4">1</span>,<span class="_ _0"> </span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _3"> </span></span>,<span class="_ _0"></span>h<span class="_ _a"> </span></span>do</span></div><div class="t m0 xc9 h31 y4bd ffc fs14 fc1 sc0 ls0 ws0">20<span class="_ _57"> </span><span class="ff12 fs2">∇</span></div><div class="t m0 x44 h2a y4be ffc fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x5f h26 y1418 ff6 fsd fc1 sc0 ls0 ws0">l</div><div class="t m0 xc2 h8 y4bd ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">z</span></div><div class="t m0 xa2 h6 y1419 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xfa h8 y4bd ff5 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 x90 h18 y141a ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x35 h30 y4bd ff11 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 xc7 h5 y141b ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x36 h18 y141a ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xe0 h19 y141c ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 xe9 h39 y4bd fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>weigh<span class="_ _5"></span>t<span class="_ _c"> </span>g<span class="_ _5"></span>radie<span class="_ _5"></span>nt<span class="_ _c"> </span>mat<span class="_ _5"></span>rix<span class="_"> </span>at<span class="_"> </span>layer<span class="_"> </span><span class="ff6">l</span></div><div class="t m0 xc9 h31 y141d ffc fs14 fc1 sc0 ls0 ws0">21<span class="_ _57"> </span><span class="ff12 fs2">∇</span></div><div class="t m0 x6c h2a y12d ffc fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 xeb h26 y4c2 ff6 fsd fc1 sc0 ls0 ws0">l</div><div class="t m0 x8f h8 y141d ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff11">δ</span></div><div class="t m0 x114 h5 y1f2 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x90 h39 y141d fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>bias<span class="_"> </span>gradien<span class="_ _5"></span>t<span class="_ _c"> </span>v<span class="_ _5"></span>ector<span class="_"> </span>at<span class="_"> </span>layer<span class="_"> </span><span class="ff6">l</span></div><div class="t m0 xc9 h4 y141e ffc fs14 fc1 sc0 ls0 ws0">22<span class="_ _32"> </span><span class="fs2">for<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"></span><span class="ff4">0</span></span>,<span class="_ _0"> </span><span class="ff4">1</span>,<span class="_ _0"> </span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _3"> </span></span>,<span class="_ _0"></span>h<span class="_ _a"> </span></span>do</span></div><div class="t m0 xc9 h1a y141f ffc fs14 fc1 sc0 ls0 ws0">23<span class="_ _57"> </span><span class="fs2">W</span></div><div class="t m0 xeb h6 y1420 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x5f h8 y141f ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">W</span></div><div class="t m0 x26 h6 y1420 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xfa h8 y141f ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff12">∇</span></div><div class="t m0 x37 h2a y1420 ffc fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 xe9 h26 y1421 ff6 fsd fc1 sc0 ls0 ws0">l</div><div class="t m0 xea h1a y141f fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>updat<span class="_ _5"></span>e<span class="_ _c"> </span><span class="ffc">W</span></div><div class="t m0 x3e h6 y1420 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xc9 h1a y1422 ffc fs14 fc1 sc0 ls0 ws0">24<span class="_ _57"> </span><span class="fs2">b</span></div><div class="t m0 x6f h6 y1423 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xeb h8 y1422 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ffc">b</span></div><div class="t m0 x31 h6 y1423 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x32 h8 y1422 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff12">∇</span></div><div class="t m0 xad h2a y1423 ffc fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 x36 h26 y13c1 ff6 fsd fc1 sc0 ls0 ws0">l</div><div class="t m0 x37 h1a y1422 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>update<span class="_"> </span><span class="ffc">b</span></div><div class="t m0 xee h6 y1423 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x7a h4 y4c8 ffc fs14 fc1 sc0 ls0 ws0">25<span class="_ _31"> </span><span class="ff6 fs2">t<span class="_ _7"> </span><span class="ff5">←<span class="_ _4"></span></span>t<span class="_ _a"> </span><span class="ff5">+<span class="_ _b"></span><span class="ff4">1</span></span></span></div><div class="t m0 x7a h8 y431 ffc fs14 fc1 sc0 ls0 ws0">26<span class="_ _c"> </span><span class="fs2">until<span class="_ _a"> </span><span class="ff6">t<span class="_ _7"> </span><span class="ff5">≥<span class="_ _4"> </span><span class="fff">m<span class="_ _5"></span>axiter</span></span></span></span></div><div class="t m0 x11 h4 y17a ff4 fs2 fc1 sc0 ls0 ws0">to<span class="_ _3"> </span>updat<span class="_ _5"></span>e<span class="_ _a"> </span>the<span class="_ _3"> </span>gra<span class="_ _5"></span>dients<span class="_ _3"> </span>by<span class="_ _a"> </span>considering<span class="_ _a"> </span>a<span class="_ _3"> </span>ﬁxe<span class="_"> </span>d<span class="_ _a"> </span>sized<span class="_ _a"> </span>subset<span class="_ _3"> </span>of<span class="_ _a"> </span>the<span class="_ _a"> </span>training<span class="_ _a"> </span>points<span class="_ _a"> </span>called</div><div class="t m0 x11 h4 y17b ff4 fs2 fc1 sc0 ls0 ws0">a<span class="_ _9"> </span><span class="ff3">minibatch<span class="_ _9"> </span></span>instead<span class="_ _9"> </span>of<span class="_ _9"> </span>using<span class="_ _8"> </span>single<span class="_ _9"> </span>points.<span class="_ _9"> </span>That<span class="_ _9"> </span>is,<span class="_ _9"> </span>t<span class="_ _5"></span>he<span class="_ _9"> </span>training<span class="_ _9"> </span>data<span class="_ _9"> </span>is<span class="_ _8"> </span>divided<span class="_ _9"> </span>into</div><div class="t m0 x11 h4 y17c ff4 fs2 fc1 sc0 ls0 ws0">minibatches<span class="_ _6"> </span>using<span class="_ _9"> </span>an<span class="_ _9"> </span>additional<span class="_ _6"> </span>parameter<span class="_ _9"> </span>called<span class="_ _6"> </span><span class="ff3">batch<span class="_ _9"> </span>size</span>,<span class="_ _6"> </span>and<span class="_ _9"> </span>a<span class="_ _6"> </span>g<span class="_ _5"></span>radient<span class="_ _6"> </span>desce<span class="_"> </span>nt</div><div class="t m0 x11 h4 y1f ff4 fs2 fc1 sc0 ls0 ws0">step<span class="_ _7"> </span>is<span class="_ _7"> </span>performed<span class="_ _a"> </span>a<span class="_ _5"></span>fter<span class="_ _7"> </span>computing<span class="_ _7"> </span>the<span class="_ _7"> </span>bias<span class="_ _7"> </span>and<span class="_ _a"> </span>we<span class="_ _5"></span>ight<span class="_ _7"> </span>gradient<span class="_ _7"> </span>from<span class="_ _a"> </span>e<span class="_ _5"></span>ach<span class="_ _7"> </span>minibatch.</div><div class="t m0 x11 h4 y20 ff4 fs2 fc1 sc0 ls0 ws0">This<span class="_ _a"> </span>helps<span class="_ _7"> </span>bette<span class="_"> </span>r<span class="_ _7"> </span>estimate<span class="_ _a"> </span>the<span class="_ _7"> </span>gradients,<span class="_ _a"> </span>and<span class="_ _7"> </span>also<span class="_ _7"> </span>allows<span class="_ _a"> </span>vectorized<span class="_ _7"> </span>matrix<span class="_ _a"> </span>operations</div><div class="t m0 x11 h4 y21 ff4 fs2 fc1 sc0 ls0 ws0">over<span class="_ _9"> </span>the<span class="_ _9"> </span>minibatch<span class="_ _8"> </span>of<span class="_ _9"> </span>points,<span class="_ _8"> </span>which<span class="_ _8"> </span>can<span class="_ _9"> </span>lead<span class="_ _8"> </span>to<span class="_ _9"> </span>fa<span class="_ _5"></span>ster<span class="_ _9"> </span>convergence<span class="_ _9"> </span>and<span class="_ _9"> </span>substantia<span class="_ _5"></span>l</div><div class="t m0 x11 h4 y22 ff4 fs2 fc1 sc0 ls0 ws0">speedups<span class="_ _a"> </span>in<span class="_ _3"> </span>t<span class="_ _5"></span>he<span class="_ _3"> </span>le<span class="_ _5"></span>arning.</div><div class="c x14 y24 w2 hb"><div class="t m1 x15 hc y25 ff9 fs6 fc1 sc0 ls0 ws0"><span class="fc4 sc0">For Online Reading </span><span class="fc4 sc0">Only</span></div></div><div class="c x16 y26 w3 hd"><div class="t m0 x17 he y27 ff9 fs7 fc3 sc0 ls0 ws0">This version is for online reading only. Unauthorized distribution is not allowed. </div><div class="t m0 x0 he y28 ff9 fs7 fc3 sc0 ls0 ws0">Please cite the book if you find it useful, and leave a review on online platforms.<span class="fc4 sc0"> </span></div><div class="t m0 x18 he y29 ff9 fs7 fc3 sc0 ls0 ws0">Please report all errata to contact@dataminingbook.info</div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
