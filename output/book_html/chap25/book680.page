<div id="pf2a8" class="pf w0 h0" data-page-no="2a8"><div class="pc pc2a8 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg2a8.png"/><div class="t m0 x11 hb y24 ff2 fs0 fc1 sc0 ls0 ws0">668<span class="_ _e"> </span><span class="ff8">Neural<span class="_ _3"> </span>Networks</span></div><div class="t m0 xc6 h4 y6da ff7 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _a"> </span>25.2:<span class="_ _a"> </span><span class="ff4">Deep<span class="_ _a"> </span>MLP<span class="_ _a"> </span>Training:<span class="_ _a"> </span>Stochastic<span class="_ _3"> </span>Gradient<span class="_ _a"> </span>Descent</span></div><div class="t m0 x3d h16 y1af9 ffa fs2 fc1 sc0 ls0 ws0">D<span class="fs5">E<span class="_ _1b"></span>E<span class="_ _1b"></span>P<span class="_ _5"></span></span>-MLP-T<span class="fs5">R<span class="_ _1b"></span>A<span class="_ _1b"></span>I<span class="_ _1b"></span>N<span class="_ _1b"></span>I<span class="_ _1b"></span>N<span class="_ _1b"></span>G<span class="_ _7"> </span></span>(D<span class="ff6">,<span class="_ _f"></span>h,<span class="_ _0"> </span>η<span class="_"> </span>,<span class="_ _0"> </span><span class="ffd">ma<span class="_ _5"></span>xiter<span class="_ _5"></span></span>,<span class="_ _f"></span>n</span></div><div class="t m0 xd0 h5 y1afa ff4 fs3 fc1 sc0 ls0 ws0">1</div><div class="t m0 xad h7 y1af9 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span>n</div><div class="t m0 xa1 h5 y1afa ff4 fs3 fc1 sc0 ls0 ws0">2</div><div class="t m0 x3a h8 y1af9 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span>n</div><div class="t m0 x86 h6 y1afa ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xf8 h7 y1af9 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span>f</div><div class="t m0 x49 h5 y1afb ff4 fs3 fc1 sc0 ls0 ws0">1</div><div class="t m0 xdb h7 y1af9 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span>f</div><div class="t m0 x6e h5 y1afb ff4 fs3 fc1 sc0 ls0 ws0">2</div><div class="t m0 x83 h8 y1af9 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span>f</div><div class="t m0 x73 h5 y1afb ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xf2 h16 y1af9 ffa fs2 fc1 sc0 ls0 ws0">):</div><div class="t m0 x101 h7 y1afc ffa fs12 fc1 sc0 ls0 ws0">1<span class="_ _c"> </span><span class="ff6 fs2">n</span></div><div class="t m0 x27 h5 y1afd ff4 fs3 fc1 sc0 ls0 ws0">0</div><div class="t m0 x6a h8 y1afc ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ff6">d<span class="_ _6"> </span><span class="ffd">//<span class="_"> </span>input<span class="_"> </span>layer<span class="_"> </span>size</span></span></div><div class="t m0 x101 h7 y1afe ffa fs12 fc1 sc0 ls0 ws0">2<span class="_ _c"> </span><span class="ff6 fs2">n</span></div><div class="t m0 x27 h5 y1aff ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x96 h8 y1afe ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff6">p<span class="_ _7"> </span><span class="ffd">//<span class="_"> </span>output<span class="_"> </span>layer<span class="_"> </span>size</span></span></div><div class="t m0 x3d h34 y1b00 ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_ _c"> </span>we<span class="_ _5"></span>ight<span class="_"> </span>matrice<span class="_ _5"></span>s<span class="_ _c"> </span>a<span class="_ _5"></span>nd<span class="_"> </span>bias<span class="_"> </span>vectors</div><div class="t m0 x101 h4 y1b01 ffa fs12 fc1 sc0 ls0 ws0">3<span class="_ _c"> </span><span class="fs2">f<span class="_"> </span>or<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"> </span><span class="ff4">0<span class="_ _5"></span></span></span>,<span class="_ _f"></span><span class="ff4">1<span class="_ _5"></span></span>,<span class="_ _f"></span><span class="ff4">2<span class="_"> </span></span>,<span class="_ _0"> </span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span>h<span class="_ _a"> </span></span>do</span></div><div class="t m0 x4b h16 y1b02 ffa fs12 fc1 sc0 ls0 ws0">4<span class="_ _34"> </span><span class="fs2">b</span></div><div class="t m0 x96 h6 y1b03 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x5 h4 y1b02 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff4">random<span class="_ _a"> </span><span class="ff6">n</span></span></div><div class="t m0 x9e h5 y1b03 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x30 h4 y1b02 ff4 fs2 fc1 sc0 ls0 ws0">vector<span class="_ _a"> </span>with<span class="_ _a"> </span>small<span class="_ _3"> </span>v<span class="_ _5"></span>alues</div><div class="t m0 x4b h16 y1b04 ffa fs12 fc1 sc0 ls0 ws0">5<span class="_ _34"> </span><span class="fs2">W</span></div><div class="t m0 xda h6 y1b05 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xd8 h4 y1b04 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff4">random<span class="_ _a"> </span><span class="ff6">n</span></span></div><div class="t m0 xf6 h6 y1b05 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x22 h8 y1b04 ff5 fs2 fc1 sc0 ls0 ws0">×<span class="_ _b"></span><span class="ff6">n</span></div><div class="t m0 x97 h5 y1b05 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x8d h4 y1b04 ff4 fs2 fc1 sc0 ls0 ws0">matrix<span class="_ _a"> </span>with<span class="_ _3"> </span>small<span class="_ _a"> </span>values</div><div class="t m0 x101 h4 y1b06 ffa fs12 fc1 sc0 ls0 ws0">6<span class="_ _c"> </span><span class="ff6 fs2">t<span class="_ _7"> </span><span class="ff5">←<span class="_ _3"> </span><span class="ff4">0<span class="_ _a"> </span><span class="ffd">//<span class="_"> </span>iterati<span class="_ _5"></span>on<span class="_ _c"> </span>co<span class="_ _5"></span>unter</span></span></span></span></div><div class="t m0 x101 h16 y1b07 ffa fs12 fc1 sc0 ls0 ws0">7<span class="_ _c"> </span><span class="fs2">repe<span class="_ _5"></span>at</span></div><div class="t m0 x4b h16 y1b08 ffa fs12 fc1 sc0 ls0 ws0">8<span class="_ _34"> </span><span class="fs2">foreach<span class="_ _a"> </span><span class="ff6">(</span>x</span></div><div class="t m0 xcf h6 y1b09 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x8 h16 y1b08 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ffa">y</span></div><div class="t m0 x9d h6 y1b09 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x2c h8 y1b08 ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff5">∈<span class="_ _4"> </span><span class="ffa">D<span class="_ _a"> </span><span class="ff3">in<span class="_ _a"> </span>random<span class="_ _a"> </span>order<span class="_ _a"> </span></span>do</span></span></div><div class="t m0 xc2 h34 y1b0a ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Feed-<span class="_ _5"></span>Forwar<span class="_ _5"></span>d<span class="_ _c"> </span>Phase</div><div class="t m0 x4b h16 y1b0b ffa fs12 fc1 sc0 ls0 ws0">9<span class="_ _35"> </span><span class="fs2">z</span></div><div class="t m0 xdf h5 y1b0c ff4 fs3 fc1 sc0 ls0 ws0">0</div><div class="t m0 xb2 h8 y1b0b ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">x</span></div><div class="t m0 xcf h6 y1b0d ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xc6 h4 y1b0e ffa fs12 fc1 sc0 ls0 ws0">10<span class="_ _35"> </span><span class="fs2">for<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"></span><span class="ff4">0</span></span>,<span class="_ _0"> </span><span class="ff4">1</span>,<span class="_ _0"> </span><span class="ff4">2</span>,<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>,<span class="_ _0"> </span>h<span class="_ _a"> </span></span>do</span></div><div class="t m0 xc6 h16 y1b0f ffa fs12 fc1 sc0 ls0 ws0">11<span class="_ _5a"> </span><span class="fs2">z</span></div><div class="t m0 x5a h5 y1b10 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x74 h8 y1b0f ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff6">f</span></div><div class="t m0 x21 h5 y1b10 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x40 h14 y1b11 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xc4 h16 y1b12 ffa fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 x7f h6 y1b13 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x9f h8 y1b12 ff5 fs2 fc1 sc0 ls0 ws0">+<span class="_ _b"></span><span class="ffa">W</span></div><div class="t m0 xe6 h15 y1b14 ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 xe6 h6 y1b15 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x18 h8 y1b12 ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ffa">z</span></div><div class="t m0 x19 h6 y1b14 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xee h14 y1b16 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xc6 h16 y1b17 ffa fs12 fc1 sc0 ls0 ws0">12<span class="_ _35"> </span><span class="fs2">o</span></div><div class="t m0 x29 h6 y1b18 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xb2 h8 y1b17 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">z</span></div><div class="t m0 xcf h5 y1b19 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xc2 h34 y1b1a ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Backp<span class="_ _5"></span>ropaga<span class="_ _5"></span>tion<span class="_ _c"> </span>Phase</div><div class="t m0 xc6 h13 y1b1b ffa fs12 fc1 sc0 ls0 ws0">13<span class="_ _35"> </span><span class="fs2">if<span class="_ _a"> </span><span class="ff3">independent<span class="_ _a"> </span>outputs<span class="_ _3"> </span></span>the<span class="_ _5"></span>n</span></div><div class="t m0 xc6 h2b y1b1c ffa fs12 fc1 sc0 ls0 ws0">14<span class="_ _5a"> </span><span class="fff fs2">δ</span></div><div class="t m0 x5a h5 y1b1d ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xbe h8 y1b1c ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ff6">∂<span class="_ _f"></span><span class="ffa">f</span></span></div><div class="t m0 xb4 h5 y1b1e ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x7f h8 y1b1c ff5 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _6"> </span><span class="ff6">∂<span class="_ _f"></span><span class="ff11">E</span></span></div><div class="t m0 xe6 h25 y1b1f ffa fs3 fc1 sc0 ls0 ws0">x</div><div class="t m0 x50 h22 y1b20 ff6 fsb fc1 sc0 ls0 ws0">i</div><div class="t m0 x18 h34 y1b1c ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gra<span class="_ _5"></span>dients<span class="_ _c"> </span>a<span class="_ _5"></span>t<span class="_"> </span>output</div><div class="t m0 xc6 h16 y1b21 ffa fs12 fc1 sc0 ls0 ws0">15<span class="_ _35"> </span><span class="fs2">else</span></div><div class="t m0 xc6 h2b y1b22 ffa fs12 fc1 sc0 ls0 ws0">16<span class="_ _5a"> </span><span class="fff fs2">δ</span></div><div class="t m0 x5a h5 y1b23 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xbe h8 y1b22 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ff6">∂<span class="_ _f"></span><span class="ffa">F</span></span></div><div class="t m0 x22 h5 y1b24 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x7f h8 y1b22 ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff6">∂<span class="_ _f"></span><span class="ff11">E</span></span></div><div class="t m0 x4f h25 y1b25 ffa fs3 fc1 sc0 ls0 ws0">x</div><div class="t m0 x34 h22 y1b26 ff6 fsb fc1 sc0 ls0 ws0">i</div><div class="t m0 xe6 h34 y1b22 ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _c"> </span>a<span class="_ _5"></span>t<span class="_"> </span>output</div><div class="t m0 xc6 h4 y1b27 ffa fs12 fc1 sc0 ls0 ws0">17<span class="_ _35"> </span><span class="fs2">for<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"></span></span>h,<span class="_ _f"></span>h<span class="_ _b"> </span><span class="ff5">−<span class="_ _4"></span><span class="ff4">1</span></span>,<span class="_ _f"></span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span><span class="ff4">1<span class="_ _a"> </span></span></span>do</span></div><div class="t m0 xc6 h2b y1b28 ffa fs12 fc1 sc0 ls0 ws0">18<span class="_ _5a"> </span><span class="fff fs2">δ</span></div><div class="t m0 x5a h6 y1b29 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xe7 h8 y1b28 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ff6">∂<span class="_ _f"></span><span class="ffa">f</span></span></div><div class="t m0 x2d h6 y1b2a ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xfa h8 y1b28 ff5 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 x30 h14 y1b2b ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xc4 h16 y1b28 ffa fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 x9f h6 y1b2c ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xdc h8 y1b28 ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="fff">δ</span></div><div class="t m0 x85 h5 y1b29 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x18 h14 y1b2b ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x14 h34 y1b28 ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _c"> </span>a<span class="_ _5"></span>t<span class="_"> </span>layer<span class="_"> </span><span class="ff6">l</span></div><div class="t m0 xc2 h34 y1b2d ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ent<span class="_ _c"> </span>D<span class="_ _5"></span>escent<span class="_"> </span>Step</div><div class="t m0 xc6 h4 y1b2e ffa fs12 fc1 sc0 ls0 ws0">19<span class="_ _35"> </span><span class="fs2">for<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"></span><span class="ff4">0</span></span>,<span class="_ _0"> </span><span class="ff4">1</span>,<span class="_ _0"> </span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _3"> </span></span>,<span class="_ _0"></span>h<span class="_ _a"> </span></span>do</span></div><div class="t m0 xc6 h2c y1b2f ffa fs12 fc1 sc0 ls0 ws0">20<span class="_ _5a"> </span><span class="ff10 fs2">∇</span></div><div class="t m0 x3f h25 y1b30 ffa fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x5b h22 y1b31 ff6 fsb fc1 sc0 ls0 ws0">l</div><div class="t m0 xbe h8 y1b2f ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">z</span></div><div class="t m0 x9e h6 y1b32 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xf6 h8 y1b2f ff5 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 x8c h14 y1b33 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x30 h2b y1b2f fff fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 xc4 h5 y1b34 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x31 h14 y1b33 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xdc h15 y1b35 ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 xe5 h34 y1b36 ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>weigh<span class="_ _5"></span>t<span class="_ _c"> </span>g<span class="_ _5"></span>radie<span class="_ _5"></span>nt<span class="_ _c"> </span>mat<span class="_ _5"></span>rix<span class="_"> </span>at<span class="_"> </span>layer<span class="_"> </span><span class="ff6">l</span></div><div class="t m0 xc6 h2c y1b37 ffa fs12 fc1 sc0 ls0 ws0">21<span class="_ _5a"> </span><span class="ff10 fs2">∇</span></div><div class="t m0 x68 h25 y1b38 ffa fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 xe7 h22 y1b39 ff6 fsb fc1 sc0 ls0 ws0">l</div><div class="t m0 xbf h8 y1b37 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="fff">δ</span></div><div class="t m0 x10f h5 y1b3a ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x8c h34 y1b37 ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>bias<span class="_"> </span>gradien<span class="_ _5"></span>t<span class="_ _c"> </span>v<span class="_ _5"></span>ector<span class="_"> </span>at<span class="_"> </span>layer<span class="_"> </span><span class="ff6">l</span></div><div class="t m0 xc6 h4 y1b3b ffa fs12 fc1 sc0 ls0 ws0">22<span class="_ _35"> </span><span class="fs2">for<span class="_ _a"> </span><span class="ff6">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"></span><span class="ff4">0</span></span>,<span class="_ _0"> </span><span class="ff4">1</span>,<span class="_ _0"> </span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _3"> </span></span>,<span class="_ _0"></span>h<span class="_ _a"> </span></span>do</span></div><div class="t m0 xc6 h16 y1b3c ffa fs12 fc1 sc0 ls0 ws0">23<span class="_ _5a"> </span><span class="fs2">W</span></div><div class="t m0 xe7 h6 y1b3d ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x5b h8 y1b3c ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffa">W</span></div><div class="t m0 x21 h6 y1b3d ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xf6 h8 y1b3c ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff10">∇</span></div><div class="t m0 x32 h25 y1b3d ffa fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 xe5 h22 y1b3e ff6 fsb fc1 sc0 ls0 ws0">l</div><div class="t m0 xe6 h16 y1b3c ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>updat<span class="_ _5"></span>e<span class="_ _c"> </span><span class="ffa">W</span></div><div class="t m0 x39 h6 y1b3d ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xc6 h16 y1b3f ffa fs12 fc1 sc0 ls0 ws0">24<span class="_ _5a"> </span><span class="fs2">b</span></div><div class="t m0 x6b h6 y1b40 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xe7 h8 y1b3f ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ffa">b</span></div><div class="t m0 x2c h6 y1b40 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x2d h8 y1b3f ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff10">∇</span></div><div class="t m0 xa9 h25 y1b40 ffa fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 x31 h22 y1b41 ff6 fsb fc1 sc0 ls0 ws0">l</div><div class="t m0 x32 h16 y1b3f ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>update<span class="_"> </span><span class="ffa">b</span></div><div class="t m0 xea h6 y1b40 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x76 h4 y1b42 ffa fs12 fc1 sc0 ls0 ws0">25<span class="_ _34"> </span><span class="ff6 fs2">t<span class="_ _7"> </span><span class="ff5">←<span class="_ _4"></span></span>t<span class="_ _a"> </span><span class="ff5">+<span class="_ _b"></span><span class="ff4">1</span></span></span></div><div class="t m0 x76 h8 y1b43 ffa fs12 fc1 sc0 ls0 ws0">26<span class="_ _c"> </span><span class="fs2">until<span class="_ _a"> </span><span class="ff6">t<span class="_ _7"> </span><span class="ff5">≥<span class="_ _4"> </span><span class="ffd">m<span class="_ _5"></span>axiter</span></span></span></span></div><div class="t m0 x11 h4 y723 ff4 fs2 fc1 sc0 ls0 ws0">to<span class="_ _3"> </span>updat<span class="_ _5"></span>e<span class="_ _a"> </span>the<span class="_ _3"> </span>gra<span class="_ _5"></span>dients<span class="_ _3"> </span>by<span class="_ _a"> </span>considering<span class="_ _a"> </span>a<span class="_ _3"> </span>ﬁxe<span class="_"> </span>d<span class="_ _a"> </span>sized<span class="_ _a"> </span>subset<span class="_ _3"> </span>of<span class="_ _a"> </span>t<span class="_"> </span>he<span class="_ _a"> </span>training<span class="_ _a"> </span>points<span class="_ _a"> </span>called</div><div class="t m0 x11 h4 y724 ff4 fs2 fc1 sc0 ls0 ws0">a<span class="_ _9"> </span><span class="ff3">minibatch<span class="_ _9"> </span></span>instead<span class="_ _9"> </span>of<span class="_ _9"> </span>using<span class="_ _8"> </span>single<span class="_ _9"> </span>points.<span class="_ _9"> </span>That<span class="_ _9"> </span>is,<span class="_ _9"> </span>t<span class="_ _5"></span>he<span class="_ _9"> </span>training<span class="_ _9"> </span>data<span class="_ _9"> </span>is<span class="_ _8"> </span>divided<span class="_ _9"> </span>into</div><div class="t m0 x11 h4 y725 ff4 fs2 fc1 sc0 ls0 ws0">minibatches<span class="_ _6"> </span>using<span class="_ _9"> </span>an<span class="_ _9"> </span>additional<span class="_ _6"> </span>parameter<span class="_ _9"> </span>called<span class="_ _6"> </span><span class="ff3">batch<span class="_ _9"> </span>size</span>,<span class="_ _6"> </span>and<span class="_ _9"> </span>a<span class="_ _6"> </span>g<span class="_ _5"></span>radient<span class="_ _6"> </span>desce<span class="_ _5"></span>nt</div><div class="t m0 x11 h4 y726 ff4 fs2 fc1 sc0 ls0 ws0">step<span class="_ _7"> </span>is<span class="_ _7"> </span>performed<span class="_ _a"> </span>a<span class="_ _5"></span>fter<span class="_ _7"> </span>computing<span class="_ _7"> </span>the<span class="_ _7"> </span>bias<span class="_ _7"> </span>and<span class="_ _a"> </span>we<span class="_ _5"></span>ight<span class="_ _7"> </span>gradient<span class="_ _7"> </span>from<span class="_ _7"> </span>each<span class="_ _a"> </span>minibatch.</div><div class="t m0 x11 h4 y727 ff4 fs2 fc1 sc0 ls0 ws0">This<span class="_ _a"> </span>helps<span class="_ _7"> </span>bette<span class="_"> </span>r<span class="_ _7"> </span>estimate<span class="_ _a"> </span>the<span class="_ _7"> </span>gradients,<span class="_ _a"> </span>and<span class="_ _7"> </span>also<span class="_ _7"> </span>allows<span class="_ _a"> </span>vectorized<span class="_ _7"> </span>matrix<span class="_ _a"> </span>operations</div><div class="t m0 x11 h4 y3ec ff4 fs2 fc1 sc0 ls0 ws0">over<span class="_ _9"> </span>the<span class="_ _9"> </span>minibatch<span class="_ _8"> </span>of<span class="_ _9"> </span>points,<span class="_ _8"> </span>which<span class="_ _8"> </span>can<span class="_ _9"> </span>lead<span class="_ _8"> </span>to<span class="_ _9"> </span>fa<span class="_ _5"></span>ster<span class="_ _9"> </span>convergence<span class="_ _9"> </span>and<span class="_ _9"> </span>substantia<span class="_ _5"></span>l</div><div class="t m0 x11 h4 y3ef ff4 fs2 fc1 sc0 ls0 ws0">speedups<span class="_ _a"> </span>in<span class="_ _3"> </span>t<span class="_ _5"></span>he<span class="_ _3"> </span>le<span class="_ _5"></span>arning.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
