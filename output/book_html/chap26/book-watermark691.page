<div id="pf2b3" class="pf w0 h0" data-page-no="2b3"><div class="pc pc2b3 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg2b3.png"/><div class="t m0 x2f h10 y32 ffd fs0 fc1 sc0 ls0 ws0">Recurrent<span class="_ _4"> </span>Neural<span class="_ _6"> </span>Networks<span class="_ _11"> </span><span class="ff2">679</span></div><div class="t m0 xc6 h4 y24d ffb fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _2"> </span>26.1:<span class="_ _4"> </span><span class="ff3">RNN<span class="_ _4"> </span>Training:<span class="_ _6"> </span>St<span class="_"> </span>ocha<span class="_ _5"></span>stic<span class="_ _4"> </span>Gradient<span class="_ _4"> </span>Descent</span></div><div class="t m0 x19 h9 y24e ff6 fs2 fc1 sc0 ls0 ws0">RNN-T<span class="_ _5"></span><span class="fs5">R<span class="_ _f"></span>A<span class="_ _5"></span>I<span class="_ _5"></span>N<span class="_ _f"></span>I<span class="_ _5"></span>N<span class="_ _f"></span>G<span class="_ _4"> </span></span>(D<span class="ff7">,<span class="_ _f"></span>η<span class="_ _5"></span>,<span class="_ _0"></span><span class="ff13">maxit<span class="_ _5"></span>er</span>,<span class="_ _f"></span>m,<span class="_ _0"> </span>f</span></div><div class="t m0 xe9 h6 y204 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xe5 h14 y24e ff7 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span>f</div><div class="t m0 xa5 h6 y204 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x86 h9 y24e ff6 fs2 fc1 sc0 ls0 ws0">):</div><div class="t m0 x19 h48 y24f ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_"> </span>bias<span class="_"> </span>vectors</div><div class="t m0 x59 h9 y250 ff6 fs26 fc1 sc0 ls0 ws0">1<span class="_ _d"> </span><span class="fs2">b</span></div><div class="t m0 x67 h6 y251 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xda h4 y250 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">m</span>-dimensional<span class="_ _4"> </span>vector<span class="_ _4"> </span>with<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></div><div class="t m0 x59 h9 y252 ff6 fs26 fc1 sc0 ls0 ws0">2<span class="_ _d"> </span><span class="fs2">b</span></div><div class="t m0 x67 h6 y253 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xda h4 y252 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">p</span>-dime<span class="_"> </span>nsional<span class="_ _2"> </span>vector<span class="_ _4"> </span>with<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></div><div class="t m0 x19 h48 y254 ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_"> </span>weight<span class="_"> </span>matrix</div><div class="t m0 x59 h9 y255 ff6 fs26 fc1 sc0 ls0 ws0">3<span class="_ _d"> </span><span class="fs2">W</span></div><div class="t m0 x5a h6 y256 ff7 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 xd3 h4 y255 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">d<span class="_ _6"> </span></span></span>×<span class="_ _10"></span><span class="ff7">m<span class="_ _4"> </span><span class="ff3">ma<span class="_ _5"></span>trix<span class="_ _6"> </span>wit<span class="_ _5"></span>h<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></span></div><div class="t m0 x59 h9 y257 ff6 fs26 fc1 sc0 ls0 ws0">4<span class="_ _d"> </span><span class="fs2">W</span></div><div class="t m0 x5a h6 y258 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x1a h4 y257 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">m<span class="_ _10"> </span></span></span>×<span class="_ _10"></span><span class="ff7">m<span class="_ _4"> </span><span class="ff3">matrix<span class="_ _4"> </span>with<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></span></div><div class="t m0 x59 h9 y259 ff6 fs26 fc1 sc0 ls0 ws0">5<span class="_ _d"> </span><span class="fs2">W</span></div><div class="t m0 x5a h6 y25a ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x1a h4 y259 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">m<span class="_ _10"> </span></span></span>×<span class="_ _10"></span><span class="ff7">p<span class="_ _2"> </span><span class="ff3">matrix<span class="_ _4"> </span>with<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></span></div><div class="t m0 x59 h4 y25b ff6 fs26 fc1 sc0 ls0 ws0">6<span class="_ _d"> </span><span class="ff7 fs2">r<span class="_ _2"> </span><span class="ff8">←<span class="_ _6"> </span><span class="ff3">0<span class="_ _4"> </span><span class="ff13">//<span class="_"> </span>i<span class="_ _5"></span>terati<span class="_ _5"></span>on<span class="_ _d"> </span>cou<span class="_ _5"></span>nter</span></span></span></span></div><div class="t m0 x59 h9 y25c ff6 fs26 fc1 sc0 ls0 ws0">7<span class="_ _d"> </span><span class="fs2">repe<span class="_"> </span>a<span class="_ _5"></span>t</span></div><div class="t m0 x59 h7 y25d ff6 fs26 fc1 sc0 ls0 ws0">8<span class="_ _27"> </span><span class="fs2">foreach<span class="_ _4"> </span><span class="ff7">(<span class="ff9">X<span class="_ _10"> </span></span>,<span class="_ _f"></span><span class="ff9">Y<span class="_ _f"></span></span>)<span class="_ _4"> </span><span class="ff8">∈<span class="_ _8"></span></span></span>D<span class="_ _4"> </span><span class="ff4">in<span class="_ _4"> </span>random<span class="_ _4"> </span>order<span class="_ _4"> </span></span>do</span></div><div class="t m0 xad h7 y21d ff6 fs26 fc1 sc0 ls0 ws0">9<span class="_ _1f"> </span><span class="ff7 fs2">τ<span class="_ _3"> </span><span class="ff8">←<span class="_ _6"></span>|<span class="ff9">X<span class="_ _10"> </span></span>|<span class="_ _4"> </span><span class="ff13">//<span class="_"> </span>length<span class="_"> </span>of<span class="_"> </span>traini<span class="_ _5"></span>ng<span class="_ _d"> </span>seq<span class="_ _5"></span>uence</span></span></span></div><div class="t m0 x74 h48 y25e ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Feed-<span class="_ _5"></span>Forwar<span class="_ _5"></span>d<span class="_ _1"> </span>P<span class="_ _5"></span>hase</div><div class="t m0 xc6 h9 y25f ff6 fs26 fc1 sc0 ls0 ws0">10<span class="_ _1f"> </span><span class="fs2">h</span></div><div class="t m0 xaf h8 y260 ff3 fs4 fc1 sc0 ls0 ws0">0</div><div class="t m0 xd1 ha y25f ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _6"> </span><span class="ff6">0<span class="_ _8"> </span></span>∈<span class="_ _4"> </span><span class="ffa">R</span></div><div class="t m0 x5d h6 y261 ff7 fs4 fc1 sc0 ls0 ws0">m</div><div class="t m0 xb h48 y25f ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>initi<span class="_ _5"></span>alize<span class="_ _d"> </span>hi<span class="_ _5"></span>dden<span class="_"> </span>state</div><div class="t m0 xc6 h4 y262 ff6 fs26 fc1 sc0 ls0 ws0">11<span class="_ _1f"> </span><span class="fs2">for<span class="_ _4"> </span><span class="ff7">t<span class="_ _2"> </span><span class="ff8">=<span class="_ _6"> </span><span class="ff3">1</span></span>,<span class="_ _0"> </span><span class="ff3">2</span>,<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>,<span class="_ _0"> </span>τ<span class="_ _a"> </span></span>do</span></div><div class="t m0 xc6 h9 y263 ff6 fs26 fc1 sc0 ls0 ws0">12<span class="_ _28"> </span><span class="fs2">h</span></div><div class="t m0 xb1 h6 y264 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x9 ha y263 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">f</span></div><div class="t m0 x5d h6 y265 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xd6 h9 y263 ff7 fs2 fc1 sc0 ls0 ws0">(<span class="ff6">W</span></div><div class="t m0 x80 h13 y265 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x80 h6 y266 ff7 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x35 h9 y263 ff6 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 xe1 h6 y264 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x36 ha y263 ff8 fs2 fc1 sc0 ls0 ws0">+<span class="_ _10"></span><span class="ff6">W</span></div><div class="t m0 xa2 h13 y265 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x84 h6 y266 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xa3 h9 y263 ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 xde h8 y264 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">−<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 x5e ha y263 ff8 fs2 fc1 sc0 ls0 ws0">+<span class="_ _10"></span><span class="ff6">b</span></div><div class="t m0 x64 h6 y264 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x7a h14 y263 ff7 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 xc6 h9 y267 ff6 fs26 fc1 sc0 ls0 ws0">13<span class="_ _28"> </span><span class="fs2">o</span></div><div class="t m0 xb1 h6 y268 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x9 ha y267 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">f</span></div><div class="t m0 x5d h6 y269 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xd6 h9 y267 ff7 fs2 fc1 sc0 ls0 ws0">(<span class="ff6">W</span></div><div class="t m0 x80 h13 y269 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x80 h6 y26a ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x35 h9 y267 ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 xe1 h6 y268 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x36 ha y267 ff8 fs2 fc1 sc0 ls0 ws0">+<span class="_ _10"></span><span class="ff6">b</span></div><div class="t m0 xd8 h6 y268 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xa2 h14 y267 ff7 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 x74 h48 y26b ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Backp<span class="_ _5"></span>ropaga<span class="_ _5"></span>tion<span class="_ _1"> </span>Ph<span class="_ _5"></span>ase</div><div class="t m0 xc6 h4 y26c ff6 fs26 fc1 sc0 ls0 ws0">14<span class="_ _1f"> </span><span class="fs2">for<span class="_ _4"> </span><span class="ff7">t<span class="_ _2"> </span><span class="ff8">=<span class="_ _6"> </span></span>τ<span class="_ _f"></span>,<span class="_ _f"></span>τ<span class="_ _2"> </span><span class="ff8">−<span class="_ _10"></span><span class="ff3">1</span></span>,<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>,<span class="_ _0"> </span><span class="ff3">1<span class="_ _4"> </span></span></span>do</span></div><div class="t m0 xc6 h25 y26d ff6 fs26 fc1 sc0 ls0 ws0">15<span class="_ _28"> </span><span class="ff10 fs2">δ</span></div><div class="t m0 xb7 h6 y26e ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xb7 h6 y26f ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x9 ha y26d ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">∂<span class="_ _0"></span><span class="ff6">f</span></span></div><div class="t m0 xb4 h6 y270 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xc5 h6 y26f ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xb ha y26d ff8 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _9"> </span><span class="ff7">∂<span class="_ _0"></span><span class="ff11">E</span></span></div><div class="t m0 xb9 h21 y271 ff6 fs4 fc1 sc0 ls0 ws0">x</div><div class="t m0 xa1 h22 y272 ff7 fse fc1 sc0 ls0 ws0">t</div><div class="t m0 xba h48 y26d ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _d"> </span>at<span class="_"> </span>o<span class="_ _5"></span>utput</div><div class="t m0 xc6 h25 y273 ff6 fs26 fc1 sc0 ls0 ws0">16<span class="_ _1f"> </span><span class="ff10 fs2">δ</span></div><div class="t m0 xc4 h6 y274 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xc4 h6 y275 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 xd1 ha y273 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">∂<span class="_ _0"></span><span class="ff6">f</span></span></div><div class="t m0 xb3 h6 y276 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x31 h6 y275 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x7d ha y273 ff8 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 x4c h20 y277 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xdd h9 y273 ff6 fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xa8 h6 y278 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xd7 ha y273 ff8 fs2 fc1 sc0 ls0 ws0">·<span class="_ _10"></span><span class="ff10">δ</span></div><div class="t m0 x4e h6 y274 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x4e h6 y275 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x4f h20 y277 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x79 h9 y273 ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _d"> </span>at<span class="_"> </span><span class="ff6">h</span></div><div class="t m0 xdc h6 y278 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 xc6 h4 y279 ff6 fs26 fc1 sc0 ls0 ws0">17<span class="_ _1f"> </span><span class="fs2">for<span class="_ _4"> </span><span class="ff7">t<span class="_ _2"> </span><span class="ff8">=<span class="_ _6"> </span></span>τ<span class="_ _4"> </span><span class="ff8">−<span class="_ _8"></span><span class="ff3">1</span></span>,<span class="_ _0"></span>τ<span class="_ _4"> </span><span class="ff8">−<span class="_ _8"></span><span class="ff3">2</span></span>,<span class="_ _0"></span><span class="ff8">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _6"> </span></span>,<span class="_ _0"> </span><span class="ff3">1<span class="_ _4"> </span></span></span>do</span></div><div class="t m0 xc6 h25 y27a ff6 fs26 fc1 sc0 ls0 ws0">18<span class="_ _28"> </span><span class="ff10 fs2">δ</span></div><div class="t m0 xb7 h6 y27b ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xb7 h6 y27c ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x9 ha y27a ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">∂<span class="_ _0"></span><span class="ff6">f</span></span></div><div class="t m0 xb4 h6 y27d ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xc5 h6 y27c ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xdd ha y27a ff8 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 x35 h20 y27e fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xe1 h20 y27f fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x36 h9 y27a ff6 fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 x78 h6 y280 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xd8 ha y27a ff8 fs2 fc1 sc0 ls0 ws0">·<span class="_ _10"></span><span class="ff10">δ</span></div><div class="t m0 xa3 h6 y27b ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xa3 h6 y27c ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x60 h20 y27f fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xb5 ha y27a ff8 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 x5e h20 y27f fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x62 h9 y27a ff6 fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xe9 h6 y280 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x7a ha y27a ff8 fs2 fc1 sc0 ls0 ws0">·<span class="_ _10"></span><span class="ff10">δ</span></div><div class="t m0 xa5 h6 y27b ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xa5 h8 y27c ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">+<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 x39 h20 y27f fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xbb h20 y27e fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x16 h9 y27a ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _d"> </span>at<span class="_"> </span><span class="ff6">h</span></div><div class="t m0 xcf h6 y280 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x74 h48 y281 ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ents<span class="_"> </span>of<span class="_"> </span>weight<span class="_"> </span>matrices<span class="_ _d"> </span>a<span class="_ _5"></span>nd<span class="_"> </span>bias<span class="_"> </span>vectors</div><div class="t m0 xc6 h47 y282 ff6 fs26 fc1 sc0 ls0 ws0">19<span class="_ _1f"> </span><span class="ff12 fs2">∇</span></div><div class="t m0 x69 h21 y283 ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 xd1 h22 y5e ff7 fse fc1 sc0 ls0 ws0">o</div><div class="t m0 x3f ha y282 ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x5c h20 y284 fff fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 xca h6 y285 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 xca h8 y286 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">=<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 x4c h25 y282 ff10 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x9f h6 y287 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x9f h6 y288 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x80 ha y282 ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff12">∇</span></div><div class="t m0 x4f h21 y283 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 x79 h22 y5e ff7 fse fc1 sc0 ls0 ws0">o</div><div class="t m0 xa2 ha y282 ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x51 h20 y284 fff fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 x61 h6 y285 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 x61 h8 y286 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">=<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 xe9 h9 y282 ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 x52 h6 y283 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x53 ha y282 ff8 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 x37 h20 y289 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x86 h25 y282 ff10 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x38 h6 y287 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x38 h6 y288 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x39 h20 y289 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xbb h13 y240 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 xc6 h47 y28a ff6 fs26 fc1 sc0 ls0 ws0">20<span class="_ _1f"> </span><span class="ff12 fs2">∇</span></div><div class="t m0 x69 h21 y28b ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 xd1 h22 y28c ff7 fse fc1 sc0 ls0 ws0">h</div><div class="t m0 x3f ha y28a ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x5c h20 y28d fff fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 xca h6 y28e ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 xca h8 y28f ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">=<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 x4c h25 y28a ff10 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x9f h6 y290 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x9f h6 y291 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x80 ha y28a ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff12">∇</span></div><div class="t m0 x4f h21 y28b ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 x79 h22 y28c ff7 fse fc1 sc0 ls0 ws0">h</div><div class="t m0 xa2 ha y28a ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 xb5 h20 y28d fff fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 x5e h6 y28e ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 x5e h8 y28f ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">=<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 xe9 h9 y28a ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 x7a h8 y28b ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">−<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 x86 ha y28a ff8 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 x38 h20 y292 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x29 h25 y28a ff10 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x97 h6 y290 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x97 h6 y291 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x3a h20 y292 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xd9 h13 y293 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x98 ha y28a ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff12">∇</span></div><div class="t m0 x26 h21 y28b ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xc9 h22 y28c ff7 fse fc1 sc0 ls0 ws0">i</div><div class="t m0 xe6 ha y28a ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x1f h20 y28d fff fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 x20 h6 y28e ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 x20 h8 y28f ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">=<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 x5 h9 y28a ff6 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x9d h6 y28b ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x6b ha y28a ff8 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 xe h20 y292 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x56 h25 y28a ff10 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x23 h6 y290 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x23 h6 y291 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x54 h20 y292 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xf h13 y293 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x74 h48 y294 ff13 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ent<span class="_ _d"> </span>De<span class="_ _5"></span>scent<span class="_"> </span>Step</div><div class="t m0 xc6 h9 y295 ff6 fs26 fc1 sc0 ls0 ws0">21<span class="_ _1f"> </span><span class="fs2">b</span></div><div class="t m0 xaf h6 y296 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xd1 ha y295 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">b</span></div><div class="t m0 xa h6 y296 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x4b ha y295 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _10"></span><span class="ff7">η<span class="_ _10"> </span></span>·<span class="_ _10"></span><span class="ff12">∇</span></div><div class="t m0 x80 h21 y296 ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 x41 h22 y297 ff7 fse fc1 sc0 ls0 ws0">o</div><div class="t m0 xd7 ha y295 ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff6">W</span></div><div class="t m0 xd4 h6 y296 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xea ha y295 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">W</span></div><div class="t m0 x83 h6 y296 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x12 ha y295 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _10"></span><span class="ff7">η<span class="_ _10"> </span></span>·<span class="_ _10"></span><span class="ff12">∇</span></div><div class="t m0 x28 h21 y296 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xbb h22 y297 ff7 fse fc1 sc0 ls0 ws0">o</div><div class="t m0 xc6 h9 y298 ff6 fs26 fc1 sc0 ls0 ws0">22<span class="_ _1f"> </span><span class="fs2">b</span></div><div class="t m0 xaf h6 y299 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xd1 ha y298 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">b</span></div><div class="t m0 xa h6 y299 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x4b ha y298 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _10"></span><span class="ff7">η<span class="_ _10"> </span></span>·<span class="_ _10"></span><span class="ff12">∇</span></div><div class="t m0 x4d h21 y299 ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 x35 h22 y29a ff7 fse fc1 sc0 ls0 ws0">h</div><div class="t m0 xa0 ha y298 ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff6">W</span></div><div class="t m0 x84 h6 y299 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xa3 ha y298 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">W</span></div><div class="t m0 x62 h6 y299 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x63 ha y298 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _10"></span><span class="ff7">η<span class="_ _8"> </span></span>·<span class="_ _10"></span><span class="ff12">∇</span></div><div class="t m0 x39 h21 y299 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xbb h22 y29a ff7 fse fc1 sc0 ls0 ws0">h</div><div class="t m0 x3a ha y298 ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff6">W</span></div><div class="t m0 x4a h6 y299 ff7 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x9a ha y298 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">W</span></div><div class="t m0 xe4 h6 y299 ff7 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 xce ha y298 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _10"></span><span class="ff7">η<span class="_ _10"> </span></span>·<span class="_ _10"></span><span class="ff12">∇</span></div><div class="t m0 x9d h21 y299 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 x48 h22 y29a ff7 fse fc1 sc0 ls0 ws0">i</div><div class="t m0 xc6 h4 y29b ff6 fs26 fc1 sc0 ls0 ws0">23<span class="_ _27"> </span><span class="ff7 fs2">r<span class="_ _4"> </span><span class="ff8">←<span class="_ _6"> </span></span>r<span class="_ _4"> </span><span class="ff8">+<span class="_ _10"></span><span class="ff3">1</span></span></span></div><div class="t m0 x6 ha y29c ff6 fs26 fc1 sc0 ls0 ws0">24<span class="_ _d"> </span><span class="fs2">until<span class="_ _4"> </span><span class="ff7">r<span class="_ _2"> </span><span class="ff8">≥<span class="_ _6"> </span><span class="ff13">ma<span class="_ _5"></span>xiter</span></span></span></span></div><div class="t m0 x3e h4 y29d ff3 fs2 fc1 sc0 ls0 ws0">matrices,<span class="_ _4"> </span><span class="ff12">∇</span></div><div class="t m0 xda h21 y29e ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xc8 h22 y29f ff7 fse fc1 sc0 ls0 ws0">i</div><div class="t m0 xe7 h4 y29d ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _2"> </span><span class="ff12">∇</span></div><div class="t m0 xc4 h21 y29e ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 x69 h22 y29f ff7 fse fc1 sc0 ls0 ws0">h</div><div class="t m0 xb6 h4 y29d ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _4"> </span>and<span class="_ _2"> </span><span class="ff12">∇</span></div><div class="t m0 x5d h21 y29e ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xa7 h22 y2a0 ff7 fse fc1 sc0 ls0 ws0">o</div><div class="t m0 xb h4 y29d ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _2"> </span>and<span class="_ _4"> </span>bias<span class="_ _2"> </span>gradient<span class="_ _2"> </span>vectors,<span class="_ _4"> </span><span class="ff12">∇</span></div><div class="t m0 x24 h21 y29e ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 x91 h22 y29f ff7 fse fc1 sc0 ls0 ws0">h</div><div class="t m0 x4a h4 y29d ff3 fs2 fc1 sc0 ls0 ws0">and<span class="_ _4"> </span><span class="ff12">∇</span></div><div class="t m0 xe4 h21 y29e ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 x1e h22 y2a0 ff7 fse fc1 sc0 ls0 ws0">o</div><div class="t m0 x1f h4 y29d ff3 fs2 fc1 sc0 ls0 ws0">.<span class="_ _2"> </span>These<span class="_ _4"> </span>gradients</div><div class="t m0 x3e h4 y2a1 ff3 fs2 fc1 sc0 ls0 ws0">are<span class="_ _3"> </span>used<span class="_ _2"> </span>to<span class="_ _3"> </span>update<span class="_ _2"> </span>t<span class="_ _5"></span>he<span class="_ _2"> </span>we<span class="_ _5"></span>ights<span class="_ _2"> </span>and<span class="_ _3"> </span>biases<span class="_ _3"> </span>via<span class="_ _2"> </span>stochastic<span class="_ _3"> </span>gradient<span class="_ _3"> </span>descent.<span class="_ _3"> </span>After<span class="_ _2"> </span>ea<span class="_"> </span>c<span class="_ _5"></span>h</div><div class="t m0 x3e h4 y2a2 ff3 fs2 fc1 sc0 ls0 ws0">point<span class="_ _2"> </span>has<span class="_ _2"> </span>been<span class="_ _2"> </span>used<span class="_ _2"> </span>to<span class="_ _2"> </span>update<span class="_ _2"> </span>the<span class="_ _2"> </span>weights,<span class="_ _2"> </span>that<span class="_ _2"> </span>completes<span class="_ _2"> </span>one<span class="_ _2"> </span>epoch<span class="_ _2"> </span>of<span class="_ _2"> </span>training.<span class="_ _4"> </span>The</div><div class="t m0 x3e h4 y2a3 ff3 fs2 fc1 sc0 ls0 ws0">training<span class="_ _4"> </span>stops<span class="_ _4"> </span>when<span class="_ _4"> </span><span class="ff13">maxiter<span class="_ _4"> </span></span>epochs<span class="_ _4"> </span>have<span class="_ _6"> </span>bee<span class="_"> </span>n<span class="_ _4"> </span>reached.</div><div class="t m0 x43 h4 y2a4 ff3 fs2 fc1 sc0 ls0 ws0">Note<span class="_ _4"> </span>t<span class="_ _5"></span>hat,<span class="_ _4"> </span>whe<span class="_ _5"></span>reas<span class="_ _2"> </span>Algorithm<span class="_ _4"> </span>26.<span class="_"> </span>1<span class="_ _2"> </span>shows<span class="_ _2"> </span>the<span class="_ _2"> </span>pseudo-code<span class="_ _4"> </span>f<span class="_ _5"></span>or<span class="_ _4"> </span>stochastic<span class="_ _2"> </span>gradie<span class="_ _5"></span>nt</div><div class="t m0 x3e h4 y2a5 ff3 fs2 fc1 sc0 ls0 ws0">descent,<span class="_ _4"> </span>in<span class="_ _6"> </span>practice<span class="_ _5"></span>,<span class="_ _6"> </span>R<span class="_ _5"></span>NNs<span class="_ _4"> </span>are<span class="_ _6"> </span>traine<span class="_ _5"></span>d<span class="_ _4"> </span>usin<span class="_ _b"></span>g<span class="_ _4"> </span>subsets<span class="_ _6"> </span>or<span class="_ _4"> </span><span class="ff4">minibatches<span class="_ _4"> </span></span>of<span class="_ _4"> </span>input<span class="_ _6"> </span>se<span class="_"> </span>que<span class="_ _5"></span>nces</div><div class="t m0 x3e h4 y2a6 ff3 fs2 fc1 sc0 ls0 ws0">instead<span class="_ _2"> </span>of<span class="_ _2"> </span>single<span class="_ _2"> </span>sequences.<span class="_ _2"> </span>This<span class="_ _2"> </span>helps<span class="_ _2"> </span>to<span class="_ _3"> </span>speed<span class="_ _4"> </span>up<span class="_ _2"> </span>t<span class="_ _5"></span>he<span class="_ _2"> </span>computation<span class="_ _2"> </span>and<span class="_ _2"> </span>convergence</div><div class="t m0 x3e h4 y19b ff3 fs2 fc1 sc0 ls0 ws0">of<span class="_ _4"> </span>gradient<span class="_ _2"> </span>descent,<span class="_ _2"> </span>since<span class="_ _4"> </span>minibatches<span class="_ _2"> </span>provide<span class="_ _2"> </span>better<span class="_ _4"> </span>e<span class="_ _5"></span>stimates<span class="_ _4"> </span>of<span class="_ _4"> </span>t<span class="_"> </span>he<span class="_ _2"> </span>bias<span class="_ _2"> </span>and<span class="_ _2"> </span>weight</div><div class="t m0 x3e h4 y2a7 ff3 fs2 fc1 sc0 ls0 ws0">gradients<span class="_ _4"> </span>and<span class="_ _4"> </span>allow<span class="_ _4"> </span>the<span class="_ _4"> </span>use<span class="_ _4"> </span>of<span class="_ _6"> </span>ve<span class="_ _5"></span>ctorized<span class="_ _4"> </span>operations.</div><div class="c x2a y2c w2 hc"><div class="t m1 x2b hd y2d ffc fs6 fc1 sc0 ls0 ws0"><span class="fc4 sc0">For Online Reading </span><span class="fc4 sc0">Only</span></div></div><div class="c x2c y2e w3 he"><div class="t m0 x2d hf y2f ffc fs7 fc3 sc0 ls0 ws0">This version is for online reading only. Unauthorized distribution is not allowed. </div><div class="t m0 x0 hf y30 ffc fs7 fc3 sc0 ls0 ws0">Please cite the book if you find it useful, and leave a review on online platforms.<span class="fc4 sc0"> </span></div><div class="t m0 x2e hf y31 ffc fs7 fc3 sc0 ls0 ws0">Please report all errata to contact@dataminingbook.info</div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
