<div id="pf2ba" class="pf w0 h0" data-page-no="2ba"><div class="pc pc2ba w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg2ba.png"/><div class="t m0 x3 h10 y6a ff2 fs0 fc1 sc0 ls0 ws0">686<span class="_ _13"> </span><span class="ffd">Deep<span class="_ _4"> </span>Learning</span></div><div class="t m0 x3 h4 y201 ff3 fs2 fc1 sc0 ls0 ws0">Finally,<span class="_ _8"> </span>the<span class="_ _6"> </span>output<span class="_ _6"> </span>of<span class="_ _6"> </span>this<span class="_ _8"> </span>ele<span class="_ _5"></span>ment-wise<span class="_ _8"> </span>product<span class="_ _6"> </span>layer<span class="_ _6"> </span>is<span class="_ _6"> </span>used<span class="_ _8"> </span>a<span class="_ _5"></span>s<span class="_ _8"> </span>input<span class="_ _6"> </span>to<span class="_ _6"> </span>the<span class="_ _8"> </span>new<span class="_ _6"> </span>hidden</div><div class="t m0 x3 h4 y202 ff3 fs2 fc1 sc0 ls0 ws0">layer<span class="_ _6"> </span><span class="ff6">h</span></div><div class="t m0 xab h6 y3b3 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x6c h4 y202 ff3 fs2 fc1 sc0 ls0 ws0">that<span class="_ _6"> </span>also<span class="_ _4"> </span>takes<span class="_ _6"> </span>input<span class="_ _4"> </span>from<span class="_ _6"> </span>another<span class="_ _6"> </span>eleme<span class="_"> </span>nt<span class="_ _5"></span>-wise<span class="_ _6"> </span>gate<span class="_ _6"> </span>that<span class="_ _4"> </span>computes<span class="_ _6"> </span>the<span class="_ _6"> </span>output</div><div class="t m0 x3 h4 y206 ff3 fs2 fc1 sc0 ls0 ws0">from<span class="_ _2"> </span>the<span class="_ _2"> </span>candidat<span class="_ _5"></span>e<span class="_ _2"> </span>update<span class="_ _2"> </span>vector<span class="_ _2"> </span><span class="ff6">u</span></div><div class="t m0 xf4 h6 y207 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x50 h4 y206 ff3 fs2 fc1 sc0 ls0 ws0">and<span class="_ _2"> </span>the<span class="_ _2"> </span>complemented<span class="_ _3"> </span>forget<span class="_ _2"> </span>gate,<span class="_ _2"> </span><span class="ff6">1<span class="_ _8"> </span><span class="ff8">−<span class="_ _8"></span><span class="ff10">φ</span></span></span></div><div class="t m0 x54 h6 y426 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xc7 h4 y206 ff3 fs2 fc1 sc0 ls0 ws0">.<span class="_ _2"> </span>Thus,</div><div class="t m0 x3 h4 y208 ff3 fs2 fc1 sc0 ls0 ws0">unlike<span class="_ _4"> </span>regular<span class="_ _6"> </span>laye<span class="_ _5"></span>rs<span class="_ _6"> </span>that<span class="_ _4"> </span>are<span class="_ _6"> </span>f<span class="_ _5"></span>ully<span class="_ _4"> </span>connected<span class="_ _6"> </span>and<span class="_ _4"> </span>have<span class="_ _4"> </span>a<span class="_ _6"> </span>weight<span class="_ _4"> </span>matrix<span class="_ _4"> </span>and<span class="_ _6"> </span>bias<span class="_ _4"> </span>vector</div><div class="t m0 x3 h4 y20a ff3 fs2 fc1 sc0 ls0 ws0">between<span class="_ _1"> </span>the<span class="_ _7"> </span>layers,<span class="_ _1"> </span>the<span class="_ _7"> </span>connections<span class="_ _1"> </span>between<span class="_ _7"> </span><span class="ff10">φ</span></div><div class="t m0 x65 h6 y427 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x28 h4 y20a ff3 fs2 fc1 sc0 ls0 ws0">and<span class="_ _7"> </span><span class="ff6">h</span></div><div class="t m0 x6d h6 y428 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xaa h4 y20a ff3 fs2 fc1 sc0 ls0 ws0">via<span class="_ _7"> </span>the<span class="_ _1"> </span>element-wise<span class="_ _1"> </span>layer</div><div class="t m0 x3 h4 y429 ff3 fs2 fc1 sc0 ls0 ws0">are<span class="_ _3"> </span>all<span class="_ _3"> </span>one-t<span class="_ _5"></span>o-one,<span class="_ _3"> </span>and<span class="_ _3"> </span>the<span class="_ _3"> </span>weig<span class="_ _5"></span>hts<span class="_ _3"> </span>are<span class="_ _3"> </span>ﬁxed<span class="_ _9"> </span>at<span class="_ _3"> </span>the<span class="_ _3"> </span>v<span class="_ _5"></span>alue<span class="_ _3"> </span>1<span class="_ _3"> </span>with<span class="_ _9"> </span>bias<span class="_ _3"> </span>0.<span class="_ _3"> </span>Likewise<span class="_ _9"> </span>the</div><div class="t m0 x3 h4 y42a ff3 fs2 fc1 sc0 ls0 ws0">connections<span class="_ _3"> </span>betwee<span class="_ _5"></span>n<span class="_ _3"> </span><span class="ff6">u</span></div><div class="t m0 x6f h6 y42b ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xa9 h4 y42a ff3 fs2 fc1 sc0 ls0 ws0">and<span class="_ _3"> </span><span class="ff6">h</span></div><div class="t m0 xf9 h6 y42b ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xc2 h4 y42a ff3 fs2 fc1 sc0 ls0 ws0">via<span class="_ _3"> </span>the<span class="_ _9"> </span>other<span class="_ _9"> </span>element-<span class="_ _5"></span>wise<span class="_ _3"> </span>layer<span class="_ _3"> </span>are<span class="_ _9"> </span>also<span class="_ _3"> </span>one-to-<span class="_ _5"></span>one,</div><div class="t m0 x3 h4 y369 ff3 fs2 fc1 sc0 ls0 ws0">with<span class="_ _4"> </span>weights<span class="_ _4"> </span>ﬁxed<span class="_ _6"> </span>a<span class="_ _5"></span>t<span class="_ _4"> </span>1<span class="_ _4"> </span>and<span class="_ _4"> </span>bias<span class="_ _4"> </span>at<span class="_ _4"> </span>0.</div><div class="t m0 x1 h4 y42c ff6 fs2 fc1 sc0 ls0 ws0">Example<span class="_ _4"> </span>26.3.<span class="_ _19"> </span><span class="ff3">Let<span class="_ _1"> </span><span class="ff7">m<span class="_ _3"> </span><span class="ff8">=<span class="_ _3"> </span></span></span>5.<span class="_ _7"> </span>Assume<span class="_ _1"> </span>that<span class="_ _7"> </span>the<span class="_ _7"> </span>previous<span class="_ _1"> </span>hidden<span class="_ _7"> </span>state<span class="_ _7"> </span>v<span class="_ _5"></span>ector<span class="_ _7"> </span>and<span class="_ _7"> </span>t<span class="_ _5"></span>he</span></div><div class="t m0 x1 h4 y42d ff3 fs2 fc1 sc0 ls0 ws0">candidate<span class="_ _4"> </span>update<span class="_ _4"> </span>vector<span class="_ _4"> </span>are<span class="_ _4"> </span>given<span class="_ _4"> </span>as<span class="_ _6"> </span>follows:</div><div class="t m0 xc0 h9 y42e ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 x7d h8 y42f ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">−<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 xb ha y42e ff8 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 xa8 h20 y430 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xf9 h4 y431 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="ff3">0<span class="ff7">.</span>94<span class="_ _30"> </span>1<span class="ff7">.</span>05<span class="_ _30"> </span>0<span class="ff7">.</span>39<span class="_ _30"> </span>0<span class="ff7">.</span>97<span class="_ _30"> </span>0<span class="ff7">.</span>9</span></div><div class="t m0 xdc h20 y430 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x5f h13 y432 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x5d h9 y433 ff6 fs2 fc1 sc0 ls0 ws0">u</div><div class="t m0 xa7 h6 y434 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xb ha y433 ff8 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 xa8 h20 y435 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xf9 h4 y436 ff3 fs2 fc1 sc0 ls0 ws0">0<span class="ff7">.</span>5<span class="_ _30"> </span>2<span class="ff7">.</span>5<span class="_ _30"> </span><span class="ff8">−</span>1<span class="ff7">.</span>0<span class="_ _30"> </span><span class="ff8">−</span>0<span class="ff7">.</span>5<span class="_ _30"> </span>0<span class="ff7">.</span>8</div><div class="t m0 x92 h20 y435 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x4a h13 y437 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x1 h4 yd9 ff3 fs2 fc1 sc0 ls0 ws0">Let<span class="_ _4"> </span>the<span class="_ _4"> </span>forget<span class="_ _4"> </span>gate<span class="_ _4"> </span>and<span class="_ _4"> </span>its<span class="_ _6"> </span>complement<span class="_ _4"> </span>be<span class="_ _4"> </span>give<span class="_ _5"></span>n<span class="_ _6"> </span>as<span class="_ _4"> </span>follows:</div><div class="t m0 xf9 h25 y438 ff10 fs2 fc1 sc0 ls0 ws0">φ</div><div class="t m0 x36 h6 y439 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x4e ha y438 ff8 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 xf4 h20 y43a fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x84 h4 y43b ff3 fs2 fc1 sc0 ls0 ws0">0<span class="ff7">.</span>9<span class="_ _30"> </span>1<span class="_ _30"> </span>0<span class="_ _30"> </span>0<span class="ff7">.</span>1<span class="_ _30"> </span>0<span class="ff7">.</span>5</div><div class="t m0 x6d h20 y43a fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x25 h13 y43c ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 xb ha y33a ff6 fs2 fc1 sc0 ls0 ws0">1<span class="_ _10"> </span><span class="ff8">−<span class="_ _10"></span><span class="ff10">φ</span></span></div><div class="t m0 x36 h6 y43d ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x4e ha y33a ff8 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 xf4 h20 y43e fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x84 h4 y43f ff3 fs2 fc1 sc0 ls0 ws0">0<span class="ff7">.</span>1<span class="_ _30"> </span>0<span class="_ _30"> </span>1<span class="_ _30"> </span>0<span class="ff7">.</span>9<span class="_ _30"> </span>0<span class="ff7">.</span>5</div><div class="t m0 x6d h20 y43e fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x25 h13 y440 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x1 h4 y441 ff3 fs2 fc1 sc0 ls0 ws0">The<span class="_ _2"> </span>new<span class="_ _3"> </span>hidden<span class="_ _2"> </span>sta<span class="_ _5"></span>te<span class="_ _2"> </span>ve<span class="_"> </span>c<span class="_ _5"></span>tor<span class="_ _4"> </span>is<span class="_ _3"> </span>then<span class="_ _2"> </span>compute<span class="_ _5"></span>d<span class="_ _2"> </span>as<span class="_ _3"> </span>the<span class="_ _2"> </span>weig<span class="_"> </span>ht<span class="_ _5"></span>ed<span class="_ _2"> </span>sum<span class="_ _2"> </span>of<span class="_ _3"> </span>the<span class="_ _2"> </span>previous</div><div class="t m0 x1 h4 y442 ff3 fs2 fc1 sc0 ls0 ws0">hidden<span class="_ _4"> </span>state<span class="_ _4"> </span>vector<span class="_ _4"> </span>and<span class="_ _4"> </span>the<span class="_ _4"> </span>candidate<span class="_ _6"> </span>update<span class="_ _4"> </span>ve<span class="_ _5"></span>ctor:</div><div class="t m0 x1c h9 y443 ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 x1d h6 y444 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xf6 ha y443 ff8 fs2 fc1 sc0 ls0 ws0">=<span class="_ _6"></span><span class="ff10">φ</span></div><div class="t m0 xb0 h6 y445 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x73 ha y443 ff8 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _10"></span><span class="ff6">h</span></div><div class="t m0 xd1 h8 y444 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _f"></span><span class="ff8">−<span class="_ _1c"></span><span class="ff3">1</span></span></div><div class="t m0 xb2 ha y443 ff8 fs2 fc1 sc0 ls0 ws0">+<span class="_ _10"></span><span class="ff7">(<span class="ff6">1<span class="_ _10"> </span></span></span>−<span class="_ _10"></span><span class="ff10">φ</span></div><div class="t m0 xc h6 y445 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x80 ha y443 ff7 fs2 fc1 sc0 ls0 ws0">)<span class="_ _10"> </span><span class="ff8">⊙<span class="_ _10"></span><span class="ff6">u</span></span></div><div class="t m0 xa1 h6 y444 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xf6 ha y446 ff8 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 xed h20 y447 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xe7 h4 y448 ff3 fs2 fc1 sc0 ls0 ws0">0<span class="ff7">.</span>9<span class="_ _30"> </span>1<span class="_ _30"> </span>0<span class="_ _30"> </span>0<span class="ff7">.</span>1<span class="_ _30"> </span>0<span class="ff7">.</span>5</div><div class="t m0 x36 h20 y447 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x4e h13 y449 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 xba ha y446 ff8 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 xa2 h20 y447 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xea h4 y448 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="ff3">0<span class="ff7">.</span>94<span class="_ _30"> </span>1<span class="ff7">.</span>05<span class="_ _30"> </span>0<span class="ff7">.</span>39<span class="_ _30"> </span>0<span class="ff7">.</span>97<span class="_ _30"> </span>0<span class="ff7">.</span>9</span></div><div class="t m0 x7e h20 y447 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x7f h13 y449 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 xbf ha y446 ff8 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 xed h20 y44a fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x72 h4 y44b ff3 fs2 fc1 sc0 ls0 ws0">0<span class="ff7">.</span>1<span class="_ _30"> </span>0<span class="_ _30"> </span>1<span class="_ _30"> </span>0<span class="ff7">.</span>9<span class="_ _30"> </span>0<span class="ff7">.</span>5</div><div class="t m0 x36 h20 y44a fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x4e h13 y44c ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x78 ha y44d ff8 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 xa2 h20 y44a fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xe0 h4 y44b ff3 fs2 fc1 sc0 ls0 ws0">0<span class="ff7">.</span>5<span class="_ _30"> </span>2<span class="ff7">.</span>5<span class="_ _30"> </span><span class="ff8">−</span>1<span class="ff7">.</span>0<span class="_ _30"> </span><span class="ff8">−</span>0<span class="ff7">.</span>5<span class="_ _30"> </span>0<span class="ff7">.</span>8</div><div class="t m0 xe4 h20 y44a fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x1e h13 y44c ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 xf6 ha y9e ff8 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 xed h20 y44e fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xe7 h4 y44f ff8 fs2 fc1 sc0 ls0 ws0">−<span class="ff3">0<span class="ff7">.</span>846<span class="_ _30"> </span>1<span class="ff7">.</span>05<span class="_ _30"> </span>0<span class="_ _30"> </span>0<span class="ff7">.</span>097<span class="_ _30"> </span>0<span class="ff7">.</span>45</span></div><div class="t m0 x83 h20 y44e fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x3c h13 y450 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 xe9 ha y9e ff8 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 x53 h20 y44e fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x37 h4 y44f ff3 fs2 fc1 sc0 ls0 ws0">0<span class="ff7">.</span>05<span class="_ _30"> </span>0<span class="_ _30"> </span><span class="ff8">−</span>1<span class="ff7">.</span>0<span class="_ _30"> </span><span class="ff8">−</span>0<span class="ff7">.</span>45<span class="_ _30"> </span>0<span class="ff7">.</span>40</div><div class="t m0 x23 h20 y44e fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x54 h13 y450 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 xf6 ha y451 ff8 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 xed h20 ya0 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xe7 h4 y452 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="ff3">0<span class="ff7">.</span>796<span class="_ _30"> </span>1<span class="ff7">.</span>05<span class="_ _30"> </span></span>−<span class="ff3">1<span class="ff7">.</span>0<span class="_ _30"> </span></span>−<span class="ff3">0<span class="ff7">.</span>353<span class="_ _30"> </span>0<span class="ff7">.</span>85</span></div><div class="t m0 x37 h20 ya0 fff fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x65 h13 y453 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x3 h46 y13 ffb fs2 fc1 sc0 ls0 ws0">Computing<span class="_ _4"> </span>Ne<span class="_ _5"></span>t<span class="_ _4"> </span>Gradients</div><div class="t m0 x3 h4 y14 ff3 fs2 fc1 sc0 ls0 ws0">It<span class="_ _3"> </span>is<span class="_ _9"> </span>instructive<span class="_ _9"> </span>to<span class="_ _3"> </span>compute<span class="_ _9"> </span>the<span class="_ _9"> </span>net<span class="_ _9"> </span>gradients<span class="_ _3"> </span>for<span class="_ _9"> </span>an<span class="_ _9"> </span>RNN<span class="_ _9"> </span>with<span class="_ _3"> </span>a<span class="_ _9"> </span>forget<span class="_ _9"> </span>gat<span class="_"> </span>e<span class="_ _5"></span>,<span class="_ _3"> </span>since<span class="_ _3"> </span>a</div><div class="t m0 x3 h4 y15 ff3 fs2 fc1 sc0 ls0 ws0">similar<span class="_ _8"> </span>approach<span class="_ _6"> </span>is<span class="_ _8"> </span>used<span class="_ _6"> </span>to<span class="_ _6"> </span>compute<span class="_ _6"> </span>the<span class="_ _8"> </span>net<span class="_ _6"> </span>gradients<span class="_ _6"> </span>when<span class="_ _8"> </span>training<span class="_ _6"> </span>an<span class="_ _8"> </span>LSTM<span class="_ _6"> </span>network.</div><div class="t m0 x3 h4 y16 ff3 fs2 fc1 sc0 ls0 ws0">An<span class="_ _9"> </span>R<span class="_"> </span>N<span class="_ _5"></span>N<span class="_ _9"> </span>wit<span class="_ _5"></span>h<span class="_ _a"> </span>a<span class="_ _9"> </span>forge<span class="_ _5"></span>t<span class="_ _9"> </span>g<span class="_ _5"></span>ate<span class="_ _9"> </span>ha<span class="_"> </span>s<span class="_ _a"> </span>t<span class="_"> </span>he<span class="_ _a"> </span>following<span class="_ _a"> </span>parame<span class="_ _5"></span>ters<span class="_ _9"> </span>it<span class="_ _a"> </span>needs<span class="_ _a"> </span>to<span class="_ _a"> </span>lea<span class="_ _5"></span>rn,<span class="_ _9"> </span>namely</div><div class="t m0 x3 h4 y18 ff3 fs2 fc1 sc0 ls0 ws0">the<span class="_ _a"> </span>weight<span class="_ _9"> </span>matrice<span class="_ _5"></span>s<span class="_ _9"> </span><span class="ff6">W</span></div><div class="t m0 xc0 h6 y69 ff7 fs4 fc1 sc0 ls0 ws0">u</div><div class="t m0 x7d h4 y18 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _a"> </span><span class="ff6">W</span></div><div class="t m0 xdd h6 y69 ff7 fs4 fc1 sc0 ls0 ws0">hu</div><div class="t m0 xa8 h4 y18 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _9"> </span><span class="ff6">W</span></div><div class="t m0 xb9 h6 y69 ff7 fs4 fc1 sc0 ls0 ws0">φ</div><div class="t m0 x4f h4 y18 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _a"> </span><span class="ff6">W</span></div><div class="t m0 xe0 h6 y69 ff7 fs4 fc1 sc0 ls0 ws0">hφ</div><div class="t m0 x51 h4 y18 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _9"> </span>a<span class="_ _5"></span>nd<span class="_ _9"> </span><span class="ff6">W</span></div><div class="t m0 x15 h6 y69 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xa5 h4 y18 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _9"> </span>a<span class="_ _5"></span>nd<span class="_ _9"> </span>t<span class="_ _5"></span>he<span class="_ _9"> </span>bias<span class="_ _a"> </span>v<span class="_"> </span>e<span class="_ _5"></span>ctors<span class="_ _9"> </span><span class="ff6">b</span></div><div class="t m0 x88 h6 y69 ff7 fs4 fc1 sc0 ls0 ws0">u</div><div class="t m0 xf2 h4 y18 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _a"> </span><span class="ff6">b</span></div><div class="t m0 x22 h6 y69 ff7 fs4 fc1 sc0 ls0 ws0">φ</div><div class="t m0 x54 h4 y18 ff3 fs2 fc1 sc0 ls0 ws0">and<span class="_ _a"> </span><span class="ff6">b</span></div><div class="t m0 x8e h6 y69 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x11 h4 y18 ff3 fs2 fc1 sc0 ls0 ws0">.</div><div class="t m0 x3 h4 y19 ff3 fs2 fc1 sc0 ls0 ws0">The<span class="_ _1"> </span>computation<span class="_ _1"> </span>of<span class="_ _1"> </span>the<span class="_ _1"> </span>hidden<span class="_ _1"> </span>state<span class="_ _1"> </span>vector<span class="_ _1"> </span><span class="ff6">h</span></div><div class="t m0 x37 h6 y1a ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x38 h4 y19 ff3 fs2 fc1 sc0 ls0 ws0">adds<span class="_ _1"> </span>together<span class="_ _1"> </span>the<span class="_ _1"> </span>inputs<span class="_ _1"> </span>from<span class="_ _1"> </span>the</div><div class="t m0 x3 h4 y1c ff3 fs2 fc1 sc0 ls0 ws0">new<span class="_ _9"> </span>element<span class="_ _5"></span>-wise<span class="_ _9"> </span>laye<span class="_ _5"></span>r<span class="_ _9"> </span>that<span class="_ _9"> </span>multiplies<span class="_ _a"> </span>its<span class="_ _9"> </span>incoming<span class="_ _a"> </span>edg<span class="_ _5"></span>es<span class="_ _9"> </span>to<span class="_ _a"> </span>compute<span class="_ _9"> </span>the<span class="_ _a"> </span>net<span class="_ _a"> </span>input</div><div class="t m0 x3 h4 y1e ff3 fs2 fc1 sc0 ls0 ws0">as<span class="_ _7"> </span>opposed<span class="_ _7"> </span>to<span class="_ _7"> </span>computing<span class="_ _7"> </span>a<span class="_ _7"> </span>weig<span class="_ _5"></span>hted<span class="_ _a"> </span>sum.<span class="_ _7"> </span>We<span class="_ _7"> </span>will<span class="_ _7"> </span>look<span class="_ _7"> </span>a<span class="_ _5"></span>t<span class="_ _7"> </span>how<span class="_ _7"> </span>to<span class="_ _7"> </span>account<span class="_ _7"> </span>for<span class="_ _7"> </span>the</div><div class="t m0 x3 h4 y20 ff3 fs2 fc1 sc0 ls0 ws0">element-wise<span class="_ _4"> </span>layers<span class="_ _4"> </span>duri<span class="_ _b"></span>ng<span class="_ _4"> </span>backpropagation.</div><div class="t m0 x6 h4 y23 ff3 fs2 fc1 sc0 ls0 ws0">Figure<span class="_ _2"> </span>26<span class="_"> </span>.<span class="_ _5"></span>7<span class="_ _4"> </span>shows<span class="_ _2"> </span>a<span class="_ _3"> </span>forget<span class="_ _2"> </span>gat<span class="_"> </span>e<span class="_ _2"> </span>RNN<span class="_ _2"> </span>unfolded<span class="_ _3"> </span>in<span class="_ _2"> </span>time<span class="_ _2"> </span>for<span class="_ _2"> </span>t<span class="_ _5"></span>wo<span class="_ _2"> </span>time<span class="_ _2"> </span>steps.<span class="_ _3"> </span>Let<span class="_ _4"> </span><span class="ff10">δ</span></div><div class="t m0 x8e h6 y454 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x8e h6 y455 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x11 h4 y23 ff3 fs2 fc1 sc0 ls0 ws0">,</div><div class="t m0 x3 h25 y25 ff10 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x75 h6 y249 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x75 h6 y24a ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x6e h4 y25 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _3"> </span><span class="ff10">δ</span></div><div class="t m0 xc6 h6 y249 ff7 fs4 fc1 sc0 ls0 ws0">φ</div><div class="t m0 xc6 h6 y24a ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xfa h4 y25 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _3"> </span>and<span class="_ _3"> </span><span class="ff10">δ</span></div><div class="t m0 xb0 h6 y249 ff7 fs4 fc1 sc0 ls0 ws0">u</div><div class="t m0 xb0 h6 y24a ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x74 h4 y25 ff3 fs2 fc1 sc0 ls0 ws0">denote<span class="_ _3"> </span>the<span class="_ _3"> </span>ne<span class="_ _5"></span>t<span class="_ _3"> </span>gradient<span class="_ _3"> </span>vect<span class="_"> </span>ors<span class="_ _3"> </span>a<span class="_ _5"></span>t<span class="_ _3"> </span>the<span class="_ _3"> </span>output,<span class="_ _3"> </span>hidden,<span class="_ _9"> </span>forget<span class="_ _3"> </span>gat<span class="_ _5"></span>e,<span class="_ _2"> </span>a<span class="_ _5"></span>nd</div><div class="t m0 x3 h4 y28 ff3 fs2 fc1 sc0 ls0 ws0">candidate<span class="_ _3"> </span>update<span class="_ _9"> </span>lay<span class="_ _5"></span>ers,<span class="_ _3"> </span>respective<span class="_ _5"></span>ly.<span class="_ _3"> </span>During<span class="_ _3"> </span>backpropag<span class="_"> </span>a<span class="_ _5"></span>tion,<span class="_ _3"> </span>we<span class="_ _9"> </span>need<span class="_ _9"> </span>to<span class="_ _3"> </span>c<span class="_"> </span>ompute</div><div class="t m0 x3 h4 y2a ff3 fs2 fc1 sc0 ls0 ws0">the<span class="_ _7"> </span>net<span class="_ _7"> </span>g<span class="_ _5"></span>radients<span class="_ _7"> </span>at<span class="_ _7"> </span>e<span class="_ _5"></span>ach<span class="_ _7"> </span>layer.<span class="_ _7"> </span>The<span class="_ _7"> </span>ne<span class="_ _5"></span>t<span class="_ _7"> </span>gradient<span class="_"> </span>s<span class="_ _7"> </span>at<span class="_ _1"> </span>the<span class="_ _a"> </span>outputs<span class="_ _1"> </span>are<span class="_ _a"> </span>compute<span class="_"> </span>d<span class="_ _1"> </span>by</div><div class="c x2a y2c w2 hc"><div class="t m1 x2b hd y2d ffc fs6 fc1 sc0 ls0 ws0"><span class="fc4 sc0">For Online Reading </span><span class="fc4 sc0">Only</span></div></div><div class="c x2c y2e w3 he"><div class="t m0 x2d hf y2f ffc fs7 fc3 sc0 ls0 ws0">This version is for online reading only. Unauthorized distribution is not allowed. </div><div class="t m0 x0 hf y30 ffc fs7 fc3 sc0 ls0 ws0">Please cite the book if you find it useful, and leave a review on online platforms.<span class="fc4 sc0"> </span></div><div class="t m0 x2e hf y31 ffc fs7 fc3 sc0 ls0 ws0">Please report all errata to contact@dataminingbook.info</div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
