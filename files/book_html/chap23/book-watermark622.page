<div id="pf26e" class="pf w0 h0" data-page-no="26e"><div class="pc pc26e w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg26e.png"/><div class="t m0 x3e h13 y31 ff2 fs0 fc1 sc0 ls0 ws0">610<span class="_ _10"> </span><span class="ffe">Linear<span class="_ _5"> </span>Regression</span></div><div class="t m0 xd2 h4 y56f ffc fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _c"> </span>23.3:<span class="_ _c"> </span><span class="ff3">Ridge<span class="_ _c"> </span>Regression:<span class="_ _5"> </span>Stocha<span class="_ _4"></span>stic<span class="_ _5"> </span>Gradient<span class="_ _c"> </span>Descent</span></div><div class="t m0 xe6 h6 y570 ff7 fs2 fc1 sc0 ls0 ws0">R<span class="_ _4"></span><span class="fs5">I<span class="_ _4"></span>D<span class="_ _11"></span>G<span class="_ _4"></span>E<span class="_ _3"> </span></span>R<span class="_ _4"></span><span class="fs5">E<span class="_ _11"></span>G<span class="_ _4"></span>R<span class="_ _11"></span>E<span class="_ _4"></span>S<span class="_ _11"></span>S<span class="_ _11"></span>I<span class="_ _4"></span>O<span class="_ _11"></span>N</span>:<span class="_ _c"> </span>SGD<span class="_ _3"> </span>(D<span class="ff5">,<span class="_ _0"></span><span class="ff4">Y</span>,<span class="_ _0"></span>η,<span class="_ _0"></span>ǫ<span class="_ _11"></span></span>):</div><div class="t m0 x8a h34 y44c ff7 fs18 fc1 sc0 ls0 ws0">1</div><div class="t m0 x3b h7 y571 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xe6 h7 y44c ff7 fs2 fc1 sc0 ls0 ws0">D<span class="_ _7"> </span><span class="ff6">←</span></div><div class="t m0 xfd hc y3a1 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x107 hd y44c ff7 fs2 fc1 sc0 ls0 ws0">1<span class="_ _32"> </span>D</div><div class="t m0 xef hc y3a1 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x9c h3a y44c fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>augme<span class="_ _4"></span>nt<span class="_ _24"> </span>data</div><div class="t m0 x8a h4 y572 ff7 fs18 fc1 sc0 ls0 ws0">2<span class="_ _24"> </span><span class="ff5 fs2">t<span class="_ _3"> </span><span class="ff6">←<span class="_ _5"> </span><span class="ff3">0<span class="_ _5"> </span><span class="fff">//<span class="_"> </span>ste<span class="_ _4"></span>p/iter<span class="_ _4"></span>ation<span class="_ _f"> </span>co<span class="_ _4"></span>unter</span></span></span></span></div><div class="t m0 x8a h34 y573 ff7 fs18 fc1 sc0 ls0 ws0">3</div><div class="t m0 x5b h7 y574 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xe6 hd y573 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 xc7 h8 y575 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x8b h4 y573 ff6 fs2 fc1 sc0 ls0 ws0">←<span class="_ _5"> </span><span class="ff3">random<span class="_ _c"> </span>vect<span class="_ _4"></span>or<span class="_ _5"> </span>in<span class="_ _c"> </span><span class="ffb">R</span></span></div><div class="t m0 x7e h5 y575 ff5 fs3 fc1 sc0 ls0 ws0">d<span class="_ _4"></span><span class="ff6">+<span class="ff3">1</span></span></div><div class="t m0 x53 h3a y573 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>initi<span class="_ _4"></span>al<span class="_"> </span>weight<span class="_"> </span>vector</div><div class="t m0 x8a hd y576 ff7 fs18 fc1 sc0 ls0 ws0">4<span class="_ _24"> </span><span class="fs2">repeat</span></div><div class="t m0 x8a h4 y577 ff7 fs18 fc1 sc0 ls0 ws0">5<span class="_ _46"> </span><span class="fs2">foreach<span class="_ _c"> </span><span class="ff5">k<span class="_ _5"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">1</span></span>,<span class="_ _0"></span><span class="ff3">2</span>,<span class="_ _0"></span><span class="ff6">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _5"> </span></span>,<span class="_ _0"></span>n<span class="_ _5"> </span><span class="ff4">(in<span class="_ _c"> </span>random<span class="_ _5"> </span>order)<span class="_ _c"> </span></span></span>do</span></div><div class="t m0 x8a h7 y578 ff7 fs18 fc1 sc0 ls0 ws0">6<span class="_ _54"> </span><span class="ff6 fs2">∇</span></div><div class="t m0 x2 h15 y579 ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x2 h2a y539 ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x13 h9 y578 ff5 fs2 fc1 sc0 ls0 ws0">(</div><div class="t m0 xbd h7 y57a ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xbd hd y578 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x1e h8 y579 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xaa h7 y578 ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _7"> </span><span class="ff6">←<span class="_ _7"> </span>−</span>(y</div><div class="t m0 x5e h8 y579 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x9e h7 y578 ff6 fs2 fc1 sc0 ls0 ws0">−</div><div class="t m0 x5f h7 y57a ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x5f hd y578 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x7e ha y57b ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x7e h8 y35a ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xe h7 y57a ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x83 hd y578 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x7f h8 y57c ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x53 h7 y578 ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _9"> </span><span class="ff6">·</span></div><div class="t m0 x74 h7 y57a ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x104 hd y578 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x6 h8 y579 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xf h7 y578 ff6 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 x64 h8 y661 ff5 fs3 fc1 sc0 ls0 ws0">α</div><div class="t m0 xa5 h8 y662 ff5 fs3 fc1 sc0 ls0 ws0">n</div><div class="t m0 x54 h7 y578 ff6 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 xa0 h7 y57a ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x84 hd y578 ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _5"> </span><span class="fff">/<span class="_ _4"></span>/<span class="_"> </span>compute<span class="_"> </span>gradient<span class="_"> </span>at</span></div><div class="t m0 x106 h7 y57a ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x106 hd y578 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x33 h8 y579 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x8a h34 y57d ff7 fs18 fc1 sc0 ls0 ws0">7</div><div class="t m0 xa7 h7 y57e ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xc2 hd y57d ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x2 h5 y57f ff5 fs3 fc1 sc0 ls0 ws0">t<span class="_ _11"></span><span class="ff6">+<span class="ff3">1</span></span></div><div class="t m0 x1e h7 y57d ff6 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x8c h7 y57e ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x1f hd y57d ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x9d h8 y57f ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xe0 h7 y57d ff6 fs2 fc1 sc0 ls0 ws0">−<span class="_ _9"></span><span class="ff5">η<span class="_ _7"> </span></span>·<span class="_ _9"></span>∇</div><div class="t m0 x60 h15 y507 ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x5f h2a y506 ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x50 h9 y57d ff5 fs2 fc1 sc0 ls0 ws0">(</div><div class="t m0 x51 h7 y57e ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x83 hd y57d ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x91 h8 y507 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x4 h3a y57d ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="fff">/<span class="_ _4"></span>/<span class="_"> </span>update<span class="_"> </span>estimate<span class="_"> </span>for</span></div><div class="t m0 x2c h7 y57e ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x6d hd y57d ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x8a h4 y580 ff7 fs18 fc1 sc0 ls0 ws0">8<span class="_ _46"> </span><span class="ff5 fs2">t<span class="_ _3"> </span><span class="ff6">←<span class="_ _5"> </span></span>t<span class="_ _5"> </span><span class="ff6">+<span class="_ _9"></span><span class="ff3">1</span></span></span></div><div class="t m0 x8a h7 y203 ff7 fs18 fc1 sc0 ls0 ws0">9<span class="_ _24"> </span><span class="fs2">until<span class="_ _5"> </span><span class="ff6">k</span>w</span></div><div class="t m0 x6e h8 y204 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xff h7 y203 ff6 fs2 fc1 sc0 ls0 ws0">−<span class="_ _9"></span><span class="ff7">w</span></div><div class="t m0 xbc h5 y204 ff5 fs3 fc1 sc0 ls0 ws0">t<span class="_ _11"></span><span class="ff6">−<span class="ff3">1</span></span></div><div class="t m0 xd6 h7 y203 ff6 fs2 fc1 sc0 ls0 ws0">k<span class="_ _7"></span>≤<span class="_ _7"> </span><span class="ff5">ǫ</span></div><div class="t m0 x3e h4 y403 ff3 fs2 fc1 sc0 ls0 ws0">Using<span class="_ _5"> </span>(batc<span class="_ _4"></span>h)<span class="_ _5"> </span>gradient<span class="_ _c"> </span>descent,<span class="_ _c"> </span>we<span class="_ _5"> </span>can<span class="_ _c"> </span>iterativ<span class="_ _4"></span>ely<span class="_ _5"> </span>compute</div><div class="t m0 xd8 h7 y663 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x2b h4 y403 ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _5"> </span><span class="ff3">as<span class="_ _c"> </span>follows</span></div><div class="t m0 x6e h7 y664 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xa7 hd y665 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x13 h5 y366 ff5 fs3 fc1 sc0 ls0 ws0">t<span class="_ _11"></span><span class="ff6">+<span class="ff3">1</span></span></div><div class="t m0 xaa h7 y665 ff6 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 x8c h7 y664 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x1f hd y665 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x4f h8 y366 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xe0 h7 y665 ff6 fs2 fc1 sc0 ls0 ws0">−<span class="_ _9"></span><span class="ff5">η<span class="_ _9"> </span></span>·<span class="_ _9"></span>∇</div><div class="t m0 x5f h15 y464 ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x5f h2a y666 ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x50 h4 y665 ff6 fs2 fc1 sc0 ls0 ws0">=<span class="_ _7"></span><span class="ff5">(<span class="ff3">1<span class="_ _9"> </span></span></span>−<span class="_ _7"></span><span class="ff5">η<span class="_ _9"> </span></span>·<span class="_ _9"></span><span class="ff5">α<span class="_ _4"></span>)</span></div><div class="t m0 x54 h7 y664 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x10c hd y665 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x66 h8 y366 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x98 h7 y665 ff6 fs2 fc1 sc0 ls0 ws0">+<span class="_ _9"></span><span class="ff5">η<span class="_ _7"> </span></span>·</div><div class="t m0 x89 h7 y667 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x88 hd y665 ff7 fs2 fc1 sc0 ls0 ws0">D</div><div class="t m0 xee ha y366 ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x85 h7 y665 ff5 fs2 fc1 sc0 ls0 ws0">(<span class="ff4">Y<span class="_ _9"> </span><span class="ff6">−</span></span></div><div class="t m0 x45 h7 y667 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x43 h7 y665 ff7 fs2 fc1 sc0 ls0 ws0">D<span class="_ _9"> </span><span class="ff6">·</span></div><div class="t m0 xeb h7 y664 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x6c hd y665 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 xe3 h8 y366 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x96 h9 y665 ff5 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 x3f h4 y5fd ff3 fs2 fc1 sc0 ls0 ws0">In<span class="_ _c"> </span>stochastic<span class="_ _5"> </span>gra<span class="_ _4"></span>dient<span class="_ _c"> </span>descent<span class="_ _5"> </span>(SGD),<span class="_ _c"> </span>we<span class="_ _c"> </span>updat<span class="_ _4"></span>e<span class="_ _5"> </span>the<span class="_ _c"> </span>we<span class="_ _4"></span>ight<span class="_ _5"> </span>ve<span class="_ _4"></span>ctor<span class="_ _5"> </span>by<span class="_ _c"> </span>considering</div><div class="t m0 x3e h4 y210 ff3 fs2 fc1 sc0 ls0 ws0">only<span class="_ _c"> </span>one<span class="_ _3"> </span>(random)<span class="_ _3"> </span>point<span class="_ _3"> </span>at<span class="_ _3"> </span>each<span class="_ _c"> </span>t<span class="_ _4"></span>ime.<span class="_ _c"> </span>Restrict<span class="_ _4"></span>ing<span class="_ _c"> </span>Eq.<span class="_ _3"> </span>(23.35<span class="_ _4"></span>)<span class="_ _c"> </span>to<span class="_ _3"> </span>a<span class="_ _3"> </span>single<span class="_ _c"> </span>point</div><div class="t m0 x41 h7 y407 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x41 hd y210 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x37 h8 y668 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x4e h4 y210 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _c"> </span>t<span class="_ _4"></span>he</div><div class="t m0 x3e h4 y669 ff3 fs2 fc1 sc0 ls0 ws0">gradient<span class="_ _5"> </span>at<span class="_ _c"> </span>the<span class="_ _c"> </span>point</div><div class="t m0 xb3 h7 y408 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x1e hd y669 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x9c h8 y66a ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x1f h4 y669 ff3 fs2 fc1 sc0 ls0 ws0">is<span class="_ _5"> </span>giv<span class="_ _4"></span>en<span class="_ _5"> </span>as</div><div class="t m0 xa7 h7 y66b ff6 fs2 fc1 sc0 ls0 ws0">∇</div><div class="t m0 x5c h15 y66c ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xff h2a y66d ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x8f h9 y66b ff5 fs2 fc1 sc0 ls0 ws0">(</div><div class="t m0 xa9 h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xa9 hd y66b ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 xb3 h8 y66c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x9c h7 y66b ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _7"> </span><span class="ff6">=<span class="_ _7"></span>−</span></div><div class="t m0 x6f h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x20 hd y66b ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x5d h8 y66c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x17 h9 y66b ff5 fs2 fc1 sc0 ls0 ws0">y</div><div class="t m0 x82 h8 y66c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xcd h7 y66b ff6 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 x7e h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x9f hd y66b ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x83 h8 y66c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x97 h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x97 hd y66b ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x7f ha y66e ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x7f h8 y66f ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xc4 h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x5 h7 y66b ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _9"> </span><span class="ff6">+</span></div><div class="t m0 xa6 h9 y670 ff5 fs2 fc1 sc0 ls0 ws0">α</div><div class="t m0 xa6 h9 y671 ff5 fs2 fc1 sc0 ls0 ws0">n</div><div class="t m0 x64 h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xad h7 y66b ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _7"> </span><span class="ff6">=<span class="_ _5"> </span>−<span class="ff5">(y</span></span></div><div class="t m0 x75 h8 y66c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x29 h7 y66b ff6 fs2 fc1 sc0 ls0 ws0">−</div><div class="t m0 xee h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xee hd y66b ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x85 ha y66e ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x85 h8 y66f ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x2b h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xb6 hd y66b ff7 fs2 fc1 sc0 ls0 ws0">w<span class="ff5">)</span></div><div class="t m0 xb4 h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xb4 hd y66b ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x43 h8 y66c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x44 h7 y66b ff6 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 x6c h9 y670 ff5 fs2 fc1 sc0 ls0 ws0">α</div><div class="t m0 xeb h9 y671 ff5 fs2 fc1 sc0 ls0 ws0">n</div><div class="t m0 xe3 h7 yf7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xa8 h4 y66b ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _60"> </span><span class="ff3">(23.36)</span></div><div class="t m0 x3e h4 y372 ff3 fs2 fc1 sc0 ls0 ws0">Here,<span class="_ _3"> </span>we<span class="_ _3"> </span>scale<span class="_ _3"> </span>the<span class="_ _3"> </span>regularization<span class="_ _3"> </span>constant<span class="_ _3"> </span><span class="ff5">α<span class="_ _8"> </span></span>by<span class="_ _8"> </span>dividing<span class="_ _c"> </span>it<span class="_ _8"> </span>by<span class="_ _c"> </span><span class="ff5">n</span>,<span class="_ _3"> </span>t<span class="_ _4"></span>he<span class="_ _3"> </span>number<span class="_ _3"> </span>of<span class="_ _3"> </span>points</div><div class="t m0 x3e h4 y672 ff3 fs2 fc1 sc0 ls0 ws0">in<span class="_ _c"> </span>the<span class="_ _3"> </span>tra<span class="_"> </span>ining<span class="_ _3"> </span>data,<span class="_ _3"> </span>since<span class="_ _c"> </span>t<span class="_ _4"></span>he<span class="_ _3"> </span>original<span class="_ _c"> </span>ridge<span class="_ _3"> </span>va<span class="_ _4"></span>lue<span class="_ _c"> </span><span class="ff5">α<span class="_ _8"> </span></span>is<span class="_ _3"> </span>for<span class="_ _3"> </span>all<span class="_ _3"> </span>the<span class="_ _c"> </span><span class="ff5">n<span class="_ _3"> </span></span>points,<span class="_ _3"> </span>wherea<span class="_"> </span>s<span class="_ _3"> </span>we</div><div class="t m0 x3e h4 y673 ff3 fs2 fc1 sc0 ls0 ws0">are<span class="_ _7"> </span>now<span class="_ _5"> </span>considering<span class="_ _7"> </span>only<span class="_ _5"> </span>one<span class="_ _5"> </span>point<span class="_ _7"> </span>a<span class="_ _4"></span>t<span class="_ _7"> </span>a<span class="_ _5"> </span>time.<span class="_ _7"> </span>Theref<span class="_"> </span>ore,<span class="_ _5"> </span>the<span class="_ _5"> </span>stochastic<span class="_ _7"> </span>gradie<span class="_"> </span>nt<span class="_ _5"> </span>update</div><div class="t m0 x3e h4 y5c9 ff3 fs2 fc1 sc0 ls0 ws0">rule<span class="_ _5"> </span>is<span class="_ _c"> </span>give<span class="_ _4"></span>n<span class="_ _5"> </span>as</div><div class="t m0 xfd h7 y674 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x11 hd y675 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 xc2 h5 y676 ff5 fs3 fc1 sc0 ls0 ws0">t<span class="_ _11"></span><span class="ff6">+<span class="ff3">1</span></span></div><div class="t m0 x10d h7 y675 ff6 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 xbe h7 y674 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xb3 hd y675 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x81 h8 y676 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x8c h7 y675 ff6 fs2 fc1 sc0 ls0 ws0">−<span class="_ _9"></span><span class="ff5">η<span class="_ _9"> </span></span>·<span class="_ _9"></span>∇</div><div class="t m0 x9e h15 y677 ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x82 h2a y3ca ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x7d h9 y675 ff5 fs2 fc1 sc0 ls0 ws0">(</div><div class="t m0 x90 h7 y674 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x90 hd y675 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x60 h8 y677 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x50 h7 y675 ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _7"> </span><span class="ff6">=</span></div><div class="t m0 x5 hc y678 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x86 h4 y675 ff3 fs2 fc1 sc0 ls0 ws0">1<span class="_ _9"> </span><span class="ff6">−</span></div><div class="t m0 x10 h7 y608 ff5 fs2 fc1 sc0 ls0 ws0">η<span class="_ _7"> </span><span class="ff6">·<span class="_ _9"></span></span>α</div><div class="t m0 x64 h9 y679 ff5 fs2 fc1 sc0 ls0 ws0">n</div><div class="t m0 x55 hc y678 ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x10b h7 y674 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x98 hd y675 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x92 h8 y676 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xdb h7 y675 ff6 fs2 fc1 sc0 ls0 ws0">+<span class="_ _9"></span><span class="ff5">η<span class="_ _9"> </span></span>·<span class="_ _9"></span><span class="ff5">(y</span></div><div class="t m0 x2b h8 y677 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xd9 h7 y675 ff6 fs2 fc1 sc0 ls0 ws0">−</div><div class="t m0 x69 h7 y674 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x69 hd y675 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x6a ha y676 ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x6a h8 y67a ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xd0 h7 y674 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xe1 hd y675 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x6d h8 y676 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xa8 h7 y675 ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _9"> </span><span class="ff6">·</span></div><div class="t m0 xda h7 y674 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xda hd y675 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 xb8 h8 y677 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x3f h4 y67b ff3 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _55"> </span>23.3<span class="_ _55"> </span>shows<span class="_ _55"> </span>the<span class="_ _55"> </span>pseudo-code<span class="_ _55"> </span>for<span class="_ _55"> </span>the<span class="_ _55"> </span>stochastic<span class="_ _55"> </span>gra<span class="_ _4"></span>dient<span class="_ _55"> </span>descent</div><div class="t m0 x3e h4 y67c ff3 fs2 fc1 sc0 ls0 ws0">algorithm<span class="_ _3"> </span>f<span class="_ _4"></span>or<span class="_ _3"> </span>ridge<span class="_ _8"> </span>reg<span class="_ _4"></span>ression.<span class="_ _3"> </span>Aft<span class="_ _4"></span>er<span class="_ _3"> </span>aug<span class="_ _4"></span>menting<span class="_ _3"> </span>the<span class="_ _8"> </span>dat<span class="_ _4"></span>a<span class="_ _3"> </span>matrix,<span class="_ _8"> </span>in<span class="_ _8"> </span>each<span class="_ _3"> </span>it<span class="_ _4"></span>eration<span class="_ _8"> </span>it</div><div class="t m0 x3e h4 y67d ff3 fs2 fc1 sc0 ls0 ws0">updates<span class="_ _3"> </span>the<span class="_ _3"> </span>weight<span class="_ _3"> </span>v<span class="_"> </span>e<span class="_ _4"></span>ctor<span class="_ _c"> </span>by<span class="_ _3"> </span>considering<span class="_ _8"> </span>the<span class="_ _3"> </span>gradient<span class="_ _3"> </span>at<span class="_ _3"> </span>each<span class="_ _8"> </span>point<span class="_ _c"> </span>in<span class="_ _8"> </span>random<span class="_ _3"> </span>order.</div><div class="t m0 x3e h4 y67e ff3 fs2 fc1 sc0 ls0 ws0">The<span class="_ _7"> </span>method<span class="_ _7"> </span>stops<span class="_ _7"> </span>when<span class="_ _7"> </span>the<span class="_ _9"> </span>we<span class="_ _4"></span>ight<span class="_ _7"> </span>vector<span class="_ _7"> </span>converges<span class="_ _7"> </span>based<span class="_ _7"> </span>on<span class="_ _7"> </span>the<span class="_ _9"> </span>t<span class="_ _4"></span>olerance<span class="_ _7"> </span><span class="ff5">ǫ<span class="_ _11"></span></span>.<span class="_ _9"> </span>The<span class="_ _7"> </span>code</div><div class="t m0 x3e h4 y52a ff3 fs2 fc1 sc0 ls0 ws0">is<span class="_ _5"> </span>for<span class="_ _5"> </span>the<span class="_ _7"> </span>pe<span class="_ _4"></span>nalized<span class="_ _5"> </span>bias<span class="_ _5"> </span>case.<span class="_ _5"> </span>It<span class="_ _5"> </span>is<span class="_ _5"> </span>easy<span class="_ _7"> </span>t<span class="_ _4"></span>o<span class="_ _5"> </span>adapt<span class="_ _5"> </span>it<span class="_ _5"> </span>for<span class="_ _5"> </span>unpenalized<span class="_ _5"> </span>bias<span class="_ _7"> </span>by<span class="_ _c"> </span>centering<span class="_ _5"> </span>the</div><div class="t m0 x3e h4 y67f ff3 fs2 fc1 sc0 ls0 ws0">unaugmented<span class="_ _5"> </span>data<span class="_ _c"> </span>matrix<span class="_ _c"> </span>and<span class="_ _5"> </span>the<span class="_ _c"> </span>response<span class="_ _c"> </span>variable.</div><div class="t m0 xac h4 y680 ff7 fs2 fc1 sc0 ls0 ws0">Example<span class="_ _5"> </span>2<span class="_ _4"></span>3.8<span class="_ _5"> </span>(Ridge<span class="_ _c"> </span>Reg<span class="_ _4"></span>ression:<span class="_ _5"> </span>SGD).<span class="_ _a"> </span><span class="ff3">We<span class="_ _2d"> </span>a<span class="_ _4"></span>pply<span class="_ _2d"> </span>ridge<span class="_ _55"> </span>regression<span class="_ _55"> </span>on<span class="_ _55"> </span>the<span class="_ _2d"> </span>Iris</span></div><div class="t m0 xac h4 y681 ff3 fs2 fc1 sc0 ls0 ws0">dataset<span class="_ _3"> </span>(<span class="ff5">n<span class="_ _5"> </span><span class="ff6">=<span class="_ _5"> </span></span></span>150),<span class="_ _3"> </span>using<span class="_ _3"> </span><span class="fff">pe<span class="_ _4"></span>tal<span class="_"> </span>length<span class="_ _c"> </span></span>(<span class="ff4">X<span class="_"> </span></span>)<span class="_ _8"> </span>as<span class="_ _3"> </span>the<span class="_ _3"> </span>independent<span class="_ _3"> </span>attribute,<span class="_ _3"> </span>and<span class="_ _3"> </span><span class="fff">p<span class="_ _4"></span>etal</span></div><div class="t m0 xac h4 y682 fff fs2 fc1 sc0 ls0 ws0">width<span class="_ _3"> </span><span class="ff3">(<span class="ff4">Y</span>)<span class="_ _8"> </span>as<span class="_ _3"> </span>the<span class="_ _3"> </span>response<span class="_ _8"> </span>variable.<span class="_ _3"> </span>Using<span class="_ _8"> </span>SGD<span class="_ _3"> </span>(with<span class="_ _3"> </span><span class="ff5">η<span class="_ _c"> </span><span class="ff6">=<span class="_ _c"> </span></span></span>0<span class="ff5">.</span>001<span class="_ _3"> </span>a<span class="_ _4"></span>nd<span class="_ _3"> </span><span class="ff5">ǫ<span class="_ _3"> </span><span class="ff6">=<span class="_ _c"> </span></span></span>0<span class="ff5">.</span>000<span class="_ _4"></span>1)<span class="_ _c"> </span>we</span></div><div class="t m0 xac h4 y653 ff3 fs2 fc1 sc0 ls0 ws0">obtain<span class="_ _c"> </span>diff<span class="_ _4"></span>erent<span class="_ _3"> </span>lines<span class="_ _c"> </span>of<span class="_ _8"> </span>best<span class="_ _c"> </span>ﬁt<span class="_ _3"> </span>for<span class="_ _3"> </span>diff<span class="_ _4"></span>erent<span class="_ _c"> </span>va<span class="_ _4"></span>lues<span class="_ _c"> </span>of<span class="_ _3"> </span>the<span class="_ _3"> </span>reg<span class="_ _4"></span>ularization<span class="_ _c"> </span>constant<span class="_ _3"> </span><span class="ff5">α<span class="_ _4"></span></span>,</div><div class="t m0 xac h4 y38d ff3 fs2 fc1 sc0 ls0 ws0">which<span class="_ _5"> </span>e<span class="_ _4"></span>ssentially<span class="_ _5"> </span>mat<span class="_ _4"></span>ch<span class="_ _5"> </span>the<span class="_ _c"> </span>results<span class="_ _5"> </span>f<span class="_"> </span>rom<span class="_ _c"> </span>the<span class="_ _c"> </span>exac<span class="_"> </span>t<span class="_ _c"> </span>method<span class="_ _5"> </span>in<span class="_ _c"> </span>Example<span class="_ _c"> </span>23.6<span class="_"> </span>:</div><div class="t m0 xd5 h4 y683 ff5 fs2 fc1 sc0 ls0 ws0">α<span class="_ _5"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">0<span class="_ _7"> </span>:</span></span></div><div class="t m0 x81 hc y684 ff9 fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 xb5 h4 y683 ff4 fs2 fc1 sc0 ls0 ws0">Y<span class="_ _3"> </span><span class="ff6">=<span class="_ _7"> </span>−<span class="ff3">0<span class="_ _4"></span><span class="ff5">.</span>366<span class="_ _7"> </span></span>+<span class="_ _9"></span><span class="ff3">0<span class="ff5">.</span>413<span class="_ _9"> </span></span>·<span class="_ _9"></span></span>X<span class="_ _61"> </span>SSE<span class="_ _7"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">6<span class="ff5">.</span>37</span></span></div><div class="t m0 xc2 h4 y685 ff5 fs2 fc1 sc0 ls0 ws0">α<span class="_ _5"> </span><span class="ff6">=<span class="_ _7"> </span><span class="ff3">1<span class="_ _4"></span>0<span class="_ _7"> </span>:</span></span></div><div class="t m0 x81 hc y686 ff9 fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 xb5 h4 y685 ff4 fs2 fc1 sc0 ls0 ws0">Y<span class="_ _3"> </span><span class="ff6">=<span class="_ _7"> </span>−<span class="ff3">0<span class="_ _4"></span><span class="ff5">.</span>244<span class="_ _7"> </span></span>+<span class="_ _9"></span><span class="ff3">0<span class="ff5">.</span>387<span class="_ _9"> </span></span>·<span class="_ _9"></span></span>X<span class="_ _61"> </span>SSE<span class="_ _7"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">6<span class="ff5">.</span>76</span></span></div><div class="t m0 xfd h4 y687 ff5 fs2 fc1 sc0 ls0 ws0">α<span class="_ _5"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">100<span class="_ _7"> </span>:</span></span></div><div class="t m0 x81 hc y4f9 ff9 fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 xb5 h4 y687 ff4 fs2 fc1 sc0 ls0 ws0">Y<span class="_ _3"> </span><span class="ff6">=<span class="_ _7"> </span>−<span class="ff3">0<span class="_ _4"></span><span class="ff5">.</span>022<span class="_ _7"> </span></span>+<span class="_ _9"></span><span class="ff3">0<span class="ff5">.</span>327<span class="_ _9"> </span></span>·<span class="_ _9"></span></span>X<span class="_ _61"> </span>SSE<span class="_ _7"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">10<span class="ff5">.</span>04</span></span></div><div class="c x39 y2b w2 hf"><div class="t m1 x3a h10 y2c ffd fs6 fc1 sc0 ls0 ws0"><span class="fc4 sc0">For Online Reading </span><span class="fc4 sc0">Only</span></div></div><div class="c x3b y2d w3 h11"><div class="t m0 x3c h12 y2e ffd fs7 fc3 sc0 ls0 ws0">This version is for online reading only. Unauthorized distribution is not allowed. </div><div class="t m0 x0 h12 y2f ffd fs7 fc3 sc0 ls0 ws0">Please cite the book if you find it useful, and leave a review on online platforms.<span class="fc4 sc0"> </span></div><div class="t m0 x3d h12 y30 ffd fs7 fc3 sc0 ls0 ws0">Please report all errata to contact@dataminingbook.info</div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
