<div id="pf2b3" class="pf w0 h0" data-page-no="2b3"><div class="pc pc2b3 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg2b3.png"/><div class="t m0 x2a hc y2c ffb fs0 fc1 sc0 ls0 ws0">Recurrent<span class="_ _4"> </span>Neural<span class="_ _6"> </span>Networks<span class="_ _10"> </span><span class="ff2">679</span></div><div class="t m0 xc3 h4 y320 ff5 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _2"> </span>26.1:<span class="_ _4"> </span><span class="ff3">RNN<span class="_ _4"> </span>Training:<span class="_ _6"> </span>St<span class="_ _5"></span>ochastic<span class="_ _4"> </span>Gradient<span class="_ _4"> </span>Descent</span></div><div class="t m0 x19 h9 y321 ff6 fs2 fc1 sc0 ls0 ws0">RNN-T<span class="_ _5"></span><span class="fs5">R<span class="_ _e"></span>A<span class="_ _5"></span>I<span class="_ _5"></span>N<span class="_ _e"></span>I<span class="_ _5"></span>N<span class="_ _e"></span>G<span class="_ _4"> </span></span>(D<span class="ff7">,<span class="_ _e"></span>η<span class="_ _5"></span>,<span class="_ _0"></span><span class="ff11">maxite<span class="_ _5"></span>r</span>,<span class="_ _e"></span>m,<span class="_ _0"> </span>f</span></div><div class="t m0 xe6 h6 y322 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xe3 h10 y321 ff7 fs2 fc1 sc0 ls0 ws0">,<span class="_ _e"></span>f</div><div class="t m0 xa1 h6 y322 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x82 h9 y321 ff6 fs2 fc1 sc0 ls0 ws0">):</div><div class="t m0 x19 h3b y323 ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_"> </span>bias<span class="_"> </span>vectors</div><div class="t m0 x54 h9 y324 ff6 fs20 fc1 sc0 ls0 ws0">1<span class="_ _c"> </span><span class="fs2">b</span></div><div class="t m0 x62 h6 y325 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xd8 h4 y324 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">m</span>-dimensional<span class="_ _4"> </span>vector<span class="_ _4"> </span>with<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></div><div class="t m0 x54 h9 y326 ff6 fs20 fc1 sc0 ls0 ws0">2<span class="_ _c"> </span><span class="fs2">b</span></div><div class="t m0 x62 h6 y327 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xd8 h4 y326 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">p</span>-dime<span class="_"> </span>nsional<span class="_ _2"> </span>vector<span class="_ _4"> </span>with<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></div><div class="t m0 x19 h3b y328 ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_"> </span>weight<span class="_"> </span>matrix</div><div class="t m0 x54 h9 y329 ff6 fs20 fc1 sc0 ls0 ws0">3<span class="_ _c"> </span><span class="fs2">W</span></div><div class="t m0 x55 h6 y32a ff7 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 xd0 h4 y329 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">d<span class="_ _6"> </span></span></span>×<span class="_ _f"></span><span class="ff7">m<span class="_ _2"> </span><span class="ff3">matrix<span class="_ _6"> </span>wit<span class="_ _5"></span>h<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></span></div><div class="t m0 x54 h9 y32b ff6 fs20 fc1 sc0 ls0 ws0">4<span class="_ _c"> </span><span class="fs2">W</span></div><div class="t m0 x55 h6 y32c ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x1a h4 y32b ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">m<span class="_ _f"> </span></span></span>×<span class="_ _f"></span><span class="ff7">m<span class="_ _4"> </span><span class="ff3">matrix<span class="_ _4"> </span>with<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></span></div><div class="t m0 x54 h9 y32d ff6 fs20 fc1 sc0 ls0 ws0">5<span class="_ _c"> </span><span class="fs2">W</span></div><div class="t m0 x55 h6 y32e ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x1a h4 y32d ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff3">random<span class="_ _4"> </span><span class="ff7">m<span class="_ _f"> </span></span></span>×<span class="_ _f"></span><span class="ff7">p<span class="_ _2"> </span><span class="ff3">matrix<span class="_ _4"> </span>with<span class="_ _4"> </span>small<span class="_ _4"> </span>values</span></span></div><div class="t m0 x54 h4 y32f ff6 fs20 fc1 sc0 ls0 ws0">6<span class="_ _c"> </span><span class="ff7 fs2">r<span class="_ _2"> </span><span class="ff8">←<span class="_ _6"> </span><span class="ff3">0<span class="_ _4"> </span><span class="ff11">//<span class="_"> </span>i<span class="_ _5"></span>terati<span class="_ _5"></span>on<span class="_ _c"> </span>cou<span class="_ _5"></span>nter</span></span></span></span></div><div class="t m0 x54 h9 y330 ff6 fs20 fc1 sc0 ls0 ws0">7<span class="_ _c"> </span><span class="fs2">repe<span class="_"> </span>a<span class="_ _5"></span>t</span></div><div class="t m0 x54 h7 y331 ff6 fs20 fc1 sc0 ls0 ws0">8<span class="_ _26"> </span><span class="fs2">foreach<span class="_ _4"> </span><span class="ff7">(<span class="ff9">X<span class="_ _f"> </span></span>,<span class="_ _e"></span><span class="ff9">Y<span class="_ _e"></span></span>)<span class="_ _4"> </span><span class="ff8">∈<span class="_ _8"></span></span></span>D<span class="_ _4"> </span><span class="ff4">in<span class="_ _4"> </span>random<span class="_ _4"> </span>order<span class="_ _4"> </span></span>do</span></div><div class="t m0 xa9 h7 y332 ff6 fs20 fc1 sc0 ls0 ws0">9<span class="_ _1f"> </span><span class="ff7 fs2">τ<span class="_ _3"> </span><span class="ff8">←<span class="_ _8"></span>|<span class="ff9">X<span class="_ _f"> </span></span>|<span class="_ _4"> </span><span class="ff11">//<span class="_"> </span>le<span class="_ _5"></span>ngth<span class="_"> </span>of<span class="_"> </span>training<span class="_"> </span>sequence</span></span></span></div><div class="t m0 x70 h3b y333 ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Feed-<span class="_ _5"></span>Forwar<span class="_ _5"></span>d<span class="_ _1"> </span>P<span class="_ _5"></span>hase</div><div class="t m0 xc3 h9 y334 ff6 fs20 fc1 sc0 ls0 ws0">10<span class="_ _1f"> </span><span class="fs2">h</span></div><div class="t m0 xab h8 y335 ff3 fs4 fc1 sc0 ls0 ws0">0</div><div class="t m0 xce ha y334 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _6"> </span><span class="ff6">0<span class="_ _8"> </span></span>∈<span class="_ _4"> </span><span class="ffa">R</span></div><div class="t m0 x58 h6 y336 ff7 fs4 fc1 sc0 ls0 ws0">m</div><div class="t m0 xb h3b y334 ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>initi<span class="_ _5"></span>alize<span class="_ _c"> </span>hi<span class="_ _5"></span>dden<span class="_"> </span>state</div><div class="t m0 xc3 h4 y337 ff6 fs20 fc1 sc0 ls0 ws0">11<span class="_ _1f"> </span><span class="fs2">for<span class="_ _4"> </span><span class="ff7">t<span class="_ _2"> </span><span class="ff8">=<span class="_ _6"> </span><span class="ff3">1</span></span>,<span class="_ _0"></span><span class="ff3">2</span>,<span class="_ _0"></span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>,<span class="_ _0"></span>τ<span class="_ _a"> </span></span>do</span></div><div class="t m0 xc3 h9 y338 ff6 fs20 fc1 sc0 ls0 ws0">12<span class="_ _27"> </span><span class="fs2">h</span></div><div class="t m0 xad h6 y339 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x9 ha y338 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">f</span></div><div class="t m0 x58 h6 y33a ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xd4 h9 y338 ff7 fs2 fc1 sc0 ls0 ws0">(<span class="ff6">W</span></div><div class="t m0 x7c hf y33a ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x7c h6 y33b ff7 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x30 h9 y33c ff6 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 xdf h6 y33d ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x31 ha y33c ff8 fs2 fc1 sc0 ls0 ws0">+<span class="_ _f"></span><span class="ff6">W</span></div><div class="t m0 x9e hf y33e ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x80 h6 y33f ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x9f h9 y340 ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 xdc h8 y341 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _5"></span><span class="ff8">−<span class="ff3">1</span></span></div><div class="t m0 x59 ha y340 ff8 fs2 fc1 sc0 ls0 ws0">+<span class="_ _f"></span><span class="ff6">b</span></div><div class="t m0 x5f h6 y341 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x76 h10 y340 ff7 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 xc3 h9 y342 ff6 fs20 fc1 sc0 ls0 ws0">13<span class="_ _27"> </span><span class="fs2">o</span></div><div class="t m0 xad h6 y343 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x9 ha y342 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">f</span></div><div class="t m0 x58 h6 y344 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xd4 h9 y342 ff7 fs2 fc1 sc0 ls0 ws0">(<span class="ff6">W</span></div><div class="t m0 x7c hf y344 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x7c h6 y345 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x30 h9 y342 ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 xdf h6 y343 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x31 ha y342 ff8 fs2 fc1 sc0 ls0 ws0">+<span class="_ _f"></span><span class="ff6">b</span></div><div class="t m0 xd6 h6 y343 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x9e h10 y342 ff7 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 x70 h3b y346 ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Backp<span class="_ _5"></span>ropaga<span class="_ _5"></span>tion<span class="_ _1"> </span>Pha<span class="_ _5"></span>se</div><div class="t m0 xc3 h4 y347 ff6 fs20 fc1 sc0 ls0 ws0">14<span class="_ _1f"> </span><span class="fs2">for<span class="_ _4"> </span><span class="ff7">t<span class="_ _2"> </span><span class="ff8">=<span class="_ _6"> </span></span>τ<span class="_ _e"></span>,<span class="_ _e"></span>τ<span class="_ _2"> </span><span class="ff8">−<span class="_ _f"></span><span class="ff3">1</span></span>,<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>.<span class="_ _0"> </span>,<span class="_ _0"> </span><span class="ff3">1<span class="_ _4"> </span></span></span>do</span></div><div class="t m0 xc3 h21 y348 ff6 fs20 fc1 sc0 ls0 ws0">15<span class="_ _27"> </span><span class="ffe fs2">δ</span></div><div class="t m0 xb4 h6 y349 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xb4 h6 y34a ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x9 ha y34b ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">∂<span class="_ _0"></span><span class="ff6">f</span></span></div><div class="t m0 xb0 h6 y34c ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xc2 h6 y34a ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xb ha y34b ff8 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _9"> </span><span class="ff7">∂<span class="_ _0"></span><span class="fff">E</span></span></div><div class="t m0 xb6 h1d y34d ff6 fs4 fc1 sc0 ls0 ws0">x</div><div class="t m0 x9d h1e y34e ff7 fsc fc1 sc0 ls0 ws0">t</div><div class="t m0 xb7 h3b y34f ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _c"> </span>at<span class="_"> </span>o<span class="_ _5"></span>utput</div><div class="t m0 xc3 h21 y350 ff6 fs20 fc1 sc0 ls0 ws0">16<span class="_ _1f"> </span><span class="ffe fs2">δ</span></div><div class="t m0 xc1 h6 y351 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xc1 h6 y352 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 xce ha y350 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">∂<span class="_ _0"></span><span class="ff6">f</span></span></div><div class="t m0 xaf h6 y353 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x2c h6 y352 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x79 ha y350 ff8 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 x47 h1c y354 ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xb2 h9 y350 ff6 fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xa4 h6 y355 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xd5 ha y350 ff8 fs2 fc1 sc0 ls0 ws0">·<span class="_ _f"></span><span class="ffe">δ</span></div><div class="t m0 x49 h6 y351 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x49 h6 y352 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x4a h1c y356 ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x75 h9 y357 ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _c"> </span>at<span class="_"> </span><span class="ff6">h</span></div><div class="t m0 xdb h6 y358 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 xc3 h4 y359 ff6 fs20 fc1 sc0 ls0 ws0">17<span class="_ _1f"> </span><span class="fs2">for<span class="_ _4"> </span><span class="ff7">t<span class="_ _2"> </span><span class="ff8">=<span class="_ _6"> </span></span>τ<span class="_ _4"> </span><span class="ff8">−<span class="_ _f"></span><span class="ff3">1<span class="_"> </span></span></span>,<span class="_ _0"> </span>τ<span class="_ _2"> </span><span class="ff8">−<span class="_ _f"></span><span class="ff3">2</span></span>,<span class="_ _0"> </span><span class="ff8">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _4"> </span></span>,<span class="_ _e"></span><span class="ff3">1<span class="_ _4"> </span></span></span>do</span></div><div class="t m0 xc3 h21 y35a ff6 fs20 fc1 sc0 ls0 ws0">18<span class="_ _27"> </span><span class="ffe fs2">δ</span></div><div class="t m0 xb4 h6 y35b ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xb4 h6 y35c ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x9 ha y35d ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff7">∂<span class="_ _0"></span><span class="ff6">f</span></span></div><div class="t m0 xb0 h6 y35e ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xc2 h6 y35c ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 xb2 ha y35d ff8 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 x30 h1c y35f ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xdf h1c y360 ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x31 h9 y361 ff6 fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 x74 h6 y362 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xd6 ha y361 ff8 fs2 fc1 sc0 ls0 ws0">·<span class="_ _f"></span><span class="ffe">δ</span></div><div class="t m0 x9f h6 y363 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x9f h6 y364 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x5b h1c y365 ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xb1 ha y366 ff8 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 x59 h1c y365 ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x5d h9 y366 ff6 fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xe6 h6 y367 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x76 ha y366 ff8 fs2 fc1 sc0 ls0 ws0">·<span class="_ _f"></span><span class="ffe">δ</span></div><div class="t m0 xa1 h6 y368 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xa1 h8 y369 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _5"></span><span class="ff8">+<span class="ff3">1</span></span></div><div class="t m0 x34 h1c y36a ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xb8 h1c y36b ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x16 h9 y36c ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts<span class="_ _c"> </span>at<span class="_"> </span><span class="ff6">h</span></div><div class="t m0 xcc h6 y36d ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x70 h3b y36e ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ents<span class="_ _c"> </span>o<span class="_ _5"></span>f<span class="_"> </span>weight<span class="_"> </span>matrice<span class="_ _5"></span>s<span class="_ _c"> </span>and<span class="_"> </span>bias<span class="_"> </span>vect<span class="_ _5"></span>ors</div><div class="t m0 xc3 h3a y36f ff6 fs20 fc1 sc0 ls0 ws0">19<span class="_ _1f"> </span><span class="ff10 fs2">∇</span></div><div class="t m0 x64 h1d y370 ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 xce h1e y371 ff7 fsc fc1 sc0 ls0 ws0">o</div><div class="t m0 x3a ha y372 ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x57 h1c y373 ffd fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 xc7 h6 y374 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 xc7 h8 y375 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _5"></span><span class="ff8">=<span class="ff3">1</span></span></div><div class="t m0 x47 h21 y372 ffe fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x9b h6 y376 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x9b h6 y377 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x7c ha y372 ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff10">∇</span></div><div class="t m0 x4a h1d y378 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 x75 h1e y379 ff7 fsc fc1 sc0 ls0 ws0">o</div><div class="t m0 x9e ha y37a ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x4c h1c y37b ffd fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 x5c h6 y37c ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 x5c h8 y37d ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _5"></span><span class="ff8">=<span class="ff3">1</span></span></div><div class="t m0 xe6 h9 y37a ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 x4d h6 y37e ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x4e ha y37a ff8 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 x32 h1c y37f ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x82 h21 y37a ffe fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x33 h6 y380 ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x33 h6 y381 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x34 h1c y37f ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xb8 hf y382 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 xc3 h3a y383 ff6 fs20 fc1 sc0 ls0 ws0">20<span class="_ _1f"> </span><span class="ff10 fs2">∇</span></div><div class="t m0 x64 h1d y384 ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 xce h1e y385 ff7 fsc fc1 sc0 ls0 ws0">h</div><div class="t m0 x3a ha y383 ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x57 h1c y386 ffd fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 xc7 h6 y387 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 xc7 h8 y388 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _5"></span><span class="ff8">=<span class="ff3">1</span></span></div><div class="t m0 x47 h21 y383 ffe fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x9b h6 y389 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x9b h6 y38a ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x7c ha y383 ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff10">∇</span></div><div class="t m0 x4a h1d y384 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 x75 h1e y385 ff7 fsc fc1 sc0 ls0 ws0">h</div><div class="t m0 x9e ha y383 ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 xb1 h1c y386 ffd fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 x59 h6 y387 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 x59 h8 y388 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _5"></span><span class="ff8">=<span class="ff3">1</span></span></div><div class="t m0 xe6 h9 y383 ff6 fs2 fc1 sc0 ls0 ws0">h</div><div class="t m0 x76 h8 y384 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _5"></span><span class="ff8">−<span class="ff3">1</span></span></div><div class="t m0 x82 ha y383 ff8 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 x33 h1c y38b ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x29 h21 y383 ffe fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x93 h6 y389 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x93 h6 y38a ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x35 h1c y38c ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xd7 hf y38d ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x94 ha y38e ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff10">∇</span></div><div class="t m0 x26 h1d y38f ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xc6 h1e y390 ff7 fsc fc1 sc0 ls0 ws0">i</div><div class="t m0 xd2 ha y38e ff8 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x1f h1c y391 ffd fs2 fc1 sc0 ls0 ws0">P</div><div class="t m0 x20 h6 y392 ff7 fs4 fc1 sc0 ls0 ws0">τ</div><div class="t m0 x20 h8 y393 ff7 fs4 fc1 sc0 ls0 ws0">t<span class="_ _5"></span><span class="ff8">=<span class="ff3">1</span></span></div><div class="t m0 x5 h9 y38e ff6 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x99 h6 y38f ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x66 ha y38e ff8 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 xe h1c y38c ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x51 h21 y38e ffe fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x23 h6 y394 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x23 h6 y395 ff7 fs4 fc1 sc0 ls0 ws0">t</div><div class="t m0 x4f h1c y396 ffd fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xf hf y397 ff4 fs4 fc1 sc0 ls0 ws0">T</div><div class="t m0 x70 h3b y398 ff11 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ent<span class="_ _c"> </span>De<span class="_ _5"></span>scent<span class="_"> </span>Step</div><div class="t m0 xc3 h9 y399 ff6 fs20 fc1 sc0 ls0 ws0">21<span class="_ _1f"> </span><span class="fs2">b</span></div><div class="t m0 xab h6 y39a ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xce ha y399 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">b</span></div><div class="t m0 xa h6 y39a ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x46 ha y399 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _f"></span><span class="ff7">η<span class="_ _f"> </span></span>·<span class="_ _f"></span><span class="ff10">∇</span></div><div class="t m0 x7c h1d y39a ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 x3c h1e y39b ff7 fsc fc1 sc0 ls0 ws0">o</div><div class="t m0 xd5 ha y39c ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff6">W</span></div><div class="t m0 xd1 h6 y39d ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 xe7 ha y39c ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">W</span></div><div class="t m0 x7f h6 y39d ff7 fs4 fc1 sc0 ls0 ws0">o</div><div class="t m0 x12 ha y39c ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _f"></span><span class="ff7">η<span class="_ _f"> </span></span>·<span class="_ _f"></span><span class="ff10">∇</span></div><div class="t m0 x28 h1d y39d ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xb8 h1e y39e ff7 fsc fc1 sc0 ls0 ws0">o</div><div class="t m0 xc3 h9 y39f ff6 fs20 fc1 sc0 ls0 ws0">22<span class="_ _1f"> </span><span class="fs2">b</span></div><div class="t m0 xab h6 y3a0 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 xce ha y39f ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">b</span></div><div class="t m0 xa h6 y3a0 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x46 ha y39f ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _f"></span><span class="ff7">η<span class="_ _f"> </span></span>·<span class="_ _f"></span><span class="ff10">∇</span></div><div class="t m0 x48 h1d y3a0 ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 x30 h1e y3a1 ff7 fsc fc1 sc0 ls0 ws0">h</div><div class="t m0 x9c ha y39f ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff6">W</span></div><div class="t m0 x80 h6 y3a0 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x9f ha y39f ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">W</span></div><div class="t m0 x5d h6 y3a0 ff7 fs4 fc1 sc0 ls0 ws0">h</div><div class="t m0 x5e ha y39f ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _f"></span><span class="ff7">η<span class="_ _8"> </span></span>·<span class="_ _f"></span><span class="ff10">∇</span></div><div class="t m0 x34 h1d y3a0 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xb8 h1e y3a1 ff7 fsc fc1 sc0 ls0 ws0">h</div><div class="t m0 x35 ha y39f ff8 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ff6">W</span></div><div class="t m0 x45 h6 y3a0 ff7 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x96 ha y39f ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _8"></span><span class="ff6">W</span></div><div class="t m0 xe2 h6 y3a0 ff7 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 xcb ha y39f ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _f"></span><span class="ff7">η<span class="_ _f"> </span></span>·<span class="_ _f"></span><span class="ff10">∇</span></div><div class="t m0 x99 h1d y3a0 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 x43 h1e y3a1 ff7 fsc fc1 sc0 ls0 ws0">i</div><div class="t m0 xc3 h4 y3a2 ff6 fs20 fc1 sc0 ls0 ws0">23<span class="_ _26"> </span><span class="ff7 fs2">r<span class="_ _4"> </span><span class="ff8">←<span class="_ _6"> </span></span>r<span class="_ _4"> </span><span class="ff8">+<span class="_ _f"></span><span class="ff3">1</span></span></span></div><div class="t m0 x6 ha y3a3 ff6 fs20 fc1 sc0 ls0 ws0">24<span class="_ _c"> </span><span class="fs2">until<span class="_ _4"> </span><span class="ff7">r<span class="_ _2"> </span><span class="ff8">≥<span class="_ _6"> </span><span class="ff11">ma<span class="_ _5"></span>xiter</span></span></span></span></div><div class="t m0 x39 h4 y3a4 ff3 fs2 fc1 sc0 ls0 ws0">matrices,<span class="_ _4"> </span><span class="ff10">∇</span></div><div class="t m0 xd8 h1d y3a5 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xc5 h1e y3a6 ff7 fsc fc1 sc0 ls0 ws0">i</div><div class="t m0 xe4 h4 y3a4 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _2"> </span><span class="ff10">∇</span></div><div class="t m0 xc1 h1d y3a5 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 x64 h1e y3a6 ff7 fsc fc1 sc0 ls0 ws0">h</div><div class="t m0 xb3 h4 y3a4 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _4"> </span>and<span class="_ _2"> </span><span class="ff10">∇</span></div><div class="t m0 x58 h1d y3a5 ff6 fs4 fc1 sc0 ls0 ws0">W</div><div class="t m0 xa3 h1e y3a7 ff7 fsc fc1 sc0 ls0 ws0">o</div><div class="t m0 xb h4 y3a8 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _2"> </span>and<span class="_ _4"> </span>bias<span class="_ _2"> </span>gradient<span class="_ _2"> </span>vectors,<span class="_ _4"> </span><span class="ff10">∇</span></div><div class="t m0 x24 h1d y3a9 ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 x8d h1e y3aa ff7 fsc fc1 sc0 ls0 ws0">h</div><div class="t m0 x45 h4 y3a8 ff3 fs2 fc1 sc0 ls0 ws0">and<span class="_ _4"> </span><span class="ff10">∇</span></div><div class="t m0 xe2 h1d y3a9 ff6 fs4 fc1 sc0 ls0 ws0">b</div><div class="t m0 x1e h1e y3ab ff7 fsc fc1 sc0 ls0 ws0">o</div><div class="t m0 x1f h4 y3ac ff3 fs2 fc1 sc0 ls0 ws0">.<span class="_ _2"> </span>These<span class="_ _4"> </span>gradients</div><div class="t m0 x39 h4 y3ad ff3 fs2 fc1 sc0 ls0 ws0">are<span class="_ _3"> </span>used<span class="_ _2"> </span>to<span class="_ _3"> </span>update<span class="_ _2"> </span>t<span class="_ _5"></span>he<span class="_ _2"> </span>weig<span class="_ _5"></span>hts<span class="_ _2"> </span>and<span class="_ _3"> </span>biases<span class="_ _3"> </span>via<span class="_ _2"> </span>stochastic<span class="_ _3"> </span>gradient<span class="_ _3"> </span>descent.<span class="_ _2"> </span>A<span class="_ _5"></span>fter<span class="_ _2"> </span>ea<span class="_"> </span>c<span class="_ _5"></span>h</div><div class="t m0 x39 h4 y3ae ff3 fs2 fc1 sc0 ls0 ws0">point<span class="_ _2"> </span>has<span class="_ _2"> </span>been<span class="_ _2"> </span>used<span class="_ _2"> </span>to<span class="_ _2"> </span>update<span class="_ _2"> </span>the<span class="_ _2"> </span>weights,<span class="_ _2"> </span>that<span class="_ _2"> </span>completes<span class="_ _2"> </span>one<span class="_ _2"> </span>epoch<span class="_ _2"> </span>of<span class="_ _2"> </span>training.<span class="_ _4"> </span>The</div><div class="t m0 x39 h4 y3af ff3 fs2 fc1 sc0 ls0 ws0">training<span class="_ _4"> </span>stops<span class="_ _4"> </span>when<span class="_ _4"> </span><span class="ff11">maxiter<span class="_ _4"> </span></span>epochs<span class="_ _4"> </span>have<span class="_ _6"> </span>bee<span class="_ _5"></span>n<span class="_ _6"> </span>re<span class="_ _5"></span>ached.</div><div class="t m0 x3e h4 y3b0 ff3 fs2 fc1 sc0 ls0 ws0">Note<span class="_ _4"> </span>t<span class="_ _5"></span>hat,<span class="_ _4"> </span>whe<span class="_"> </span>re<span class="_ _5"></span>as<span class="_ _4"> </span>A<span class="_ _5"></span>lgorithm<span class="_ _4"> </span>26.1<span class="_ _2"> </span>shows<span class="_ _2"> </span>the<span class="_ _4"> </span>pseudo-code<span class="_ _2"> </span>for<span class="_ _2"> </span>stochastic<span class="_ _2"> </span>gradient</div><div class="t m0 x39 h4 y3b1 ff3 fs2 fc1 sc0 ls0 ws0">descent,<span class="_ _4"> </span>in<span class="_ _6"> </span>practice<span class="_ _5"></span>,<span class="_ _6"> </span>R<span class="_"> </span>N<span class="_ _5"></span>Ns<span class="_ _4"> </span>are<span class="_ _6"> </span>trained<span class="_ _4"> </span>using<span class="_ _4"> </span>subsets<span class="_ _6"> </span>or<span class="_ _4"> </span><span class="ff4">minibatches<span class="_ _4"> </span></span>of<span class="_ _4"> </span>input<span class="_ _6"> </span>se<span class="_ _5"></span>quences</div><div class="t m0 x39 h4 y3b2 ff3 fs2 fc1 sc0 ls0 ws0">instead<span class="_ _2"> </span>of<span class="_ _2"> </span>single<span class="_ _2"> </span>sequences.<span class="_ _2"> </span>This<span class="_ _2"> </span>helps<span class="_ _2"> </span>to<span class="_ _3"> </span>speed<span class="_ _4"> </span>up<span class="_ _2"> </span>t<span class="_ _5"></span>he<span class="_ _4"> </span>c<span class="_"> </span>omputa<span class="_ _5"></span>tion<span class="_ _2"> </span>and<span class="_ _2"> </span>convergence</div><div class="t m0 x39 h4 y3b3 ff3 fs2 fc1 sc0 ls0 ws0">of<span class="_ _4"> </span>gradient<span class="_ _2"> </span>descent,<span class="_ _2"> </span>since<span class="_ _4"> </span>minibatches<span class="_ _2"> </span>provide<span class="_ _2"> </span>better<span class="_ _4"> </span>e<span class="_ _5"></span>stimates<span class="_ _4"> </span>of<span class="_ _4"> </span>the<span class="_ _2"> </span>bias<span class="_ _2"> </span>and<span class="_ _2"> </span>weight</div><div class="t m0 x39 h4 y3b4 ff3 fs2 fc1 sc0 ls0 ws0">gradients<span class="_ _4"> </span>and<span class="_ _4"> </span>allow<span class="_ _4"> </span>the<span class="_ _4"> </span>use<span class="_ _4"> </span>of<span class="_ _6"> </span>ve<span class="_ _5"></span>ctorized<span class="_ _4"> </span>operations.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
