<div id="pf26e" class="pf w0 h0" data-page-no="26e"><div class="pc pc26e w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg26e.png"/><div class="t m0 x39 hf y2d ff2 fs0 fc1 sc0 ls0 ws0">610<span class="_ _10"> </span><span class="ffc">Linear<span class="_ _5"> </span>Regression</span></div><div class="t m0 xce h4 y798 ff8 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _c"> </span>23.3:<span class="_ _c"> </span><span class="ff3">Ridge<span class="_ _c"> </span>Regression:<span class="_ _5"> </span>St<span class="_ _4"></span>ochastic<span class="_ _5"> </span>Gradient<span class="_ _c"> </span>Desce<span class="_"> </span>nt</span></div><div class="t m0 xe2 h6 y799 ff7 fs2 fc1 sc0 ls0 ws0">R<span class="_ _4"></span><span class="fs5">I<span class="_ _4"></span>D<span class="_ _11"></span>G<span class="_ _4"></span>E<span class="_ _3"> </span></span>R<span class="_ _4"></span><span class="fs5">E<span class="_ _11"></span>G<span class="_ _4"></span>R<span class="_ _11"></span>E<span class="_ _4"></span>S<span class="_ _11"></span>S<span class="_ _11"></span>I<span class="_ _4"></span>O<span class="_ _11"></span>N</span>:<span class="_ _c"> </span>SGD<span class="_ _c"> </span>(D<span class="ff5">,<span class="_ _0"> </span><span class="ff4">Y</span>,<span class="_ _0"></span>η,<span class="_ _0"> </span>ǫ<span class="_ _11"></span></span>):</div><div class="t m0 x85 h30 y79a ff7 fs16 fc1 sc0 ls0 ws0">1</div><div class="t m0 xc8 h7 y79b ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xe2 h7 y79a ff7 fs2 fc1 sc0 ls0 ws0">D<span class="_ _7"> </span><span class="ff6">←</span></div><div class="t m0 xf9 hc y79c ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x102 hd y79a ff7 fs2 fc1 sc0 ls0 ws0">1<span class="_ _31"> </span>D</div><div class="t m0 xeb hc y79c ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x97 h36 y79a ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>augme<span class="_ _4"></span>nt<span class="_ _5a"> </span>data</div><div class="t m0 x85 h4 y79d ff7 fs16 fc1 sc0 ls0 ws0">2<span class="_ _5a"> </span><span class="ff5 fs2">t<span class="_ _3"> </span><span class="ff6">←<span class="_ _5"> </span><span class="ff3">0<span class="_ _5"> </span><span class="ffd">//<span class="_"> </span>ste<span class="_ _4"></span>p/iter<span class="_ _4"></span>ation<span class="_ _f"> </span>co<span class="_ _4"></span>unter</span></span></span></span></div><div class="t m0 x85 h30 y79e ff7 fs16 fc1 sc0 ls0 ws0">3</div><div class="t m0 x56 h7 y79f ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xe2 hd y79e ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 xc2 h8 y7a0 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x86 h4 y79e ff6 fs2 fc1 sc0 ls0 ws0">←<span class="_ _5"> </span><span class="ff3">random<span class="_ _c"> </span>vect<span class="_ _4"></span>or<span class="_ _5"> </span>in<span class="_ _c"> </span><span class="ffb">R</span></span></div><div class="t m0 x79 h5 y7a0 ff5 fs3 fc1 sc0 ls0 ws0">d<span class="_ _4"></span><span class="ff6">+<span class="ff3">1</span></span></div><div class="t m0 x4e h36 y79e ffd fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>initi<span class="_ _4"></span>al<span class="_"> </span>weight<span class="_"> </span>vector</div><div class="t m0 x85 hd y7a1 ff7 fs16 fc1 sc0 ls0 ws0">4<span class="_ _5a"> </span><span class="fs2">repeat</span></div><div class="t m0 x85 h4 y7a2 ff7 fs16 fc1 sc0 ls0 ws0">5<span class="_ _46"> </span><span class="fs2">foreach<span class="_ _c"> </span><span class="ff5">k<span class="_ _5"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">1</span></span>,<span class="_ _0"></span><span class="ff3">2</span>,<span class="_ _0"></span><span class="ff6">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _5"> </span></span>,<span class="_ _0"></span>n<span class="_ _5"> </span><span class="ff4">(in<span class="_ _c"> </span>random<span class="_ _5"> </span>order)<span class="_ _c"> </span></span></span>do</span></div><div class="t m0 x85 h7 y7a3 ff7 fs16 fc1 sc0 ls0 ws0">6<span class="_ _53"> </span><span class="ff6 fs2">∇</span></div><div class="t m0 x2 h11 y7a4 ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x2 h26 y7a5 ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x13 h9 y7a6 ff5 fs2 fc1 sc0 ls0 ws0">(</div><div class="t m0 xb8 h7 y7a7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xb8 hd y7a6 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x1e h8 y7a8 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xa5 h7 y7a6 ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _7"> </span><span class="ff6">←<span class="_ _7"> </span>−</span>(y</div><div class="t m0 x59 h8 y7a8 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x99 h7 y7a6 ff6 fs2 fc1 sc0 ls0 ws0">−</div><div class="t m0 x5a h7 y7a7 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x5a hd y7a6 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x79 ha y7a9 ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x79 h8 y7aa ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xe h7 y7ab ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x7e hd y7ac ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x7a h8 y7ad ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x4e h7 y7ac ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _9"> </span><span class="ff6">·</span></div><div class="t m0 x6f h7 y7ab ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x100 hd y7ac ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x6 h8 y7ae ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xf h7 y7ac ff6 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 x5f h8 y8f8 ff5 fs3 fc1 sc0 ls0 ws0">α</div><div class="t m0 xa0 h8 y8f9 ff5 fs3 fc1 sc0 ls0 ws0">n</div><div class="t m0 x4f h7 y8fa ff6 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 x9b h7 y8fb ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x7f hd y8fa ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _5"> </span><span class="ffd">/<span class="_ _4"></span>/<span class="_"> </span>compute<span class="_"> </span>gradien<span class="_ _4"></span>t<span class="_ _f"> </span>at</span></div><div class="t m0 x101 h7 y8fb ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x101 hd y8fa ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x33 h8 y8fc ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x85 h30 y8fd ff7 fs16 fc1 sc0 ls0 ws0">7</div><div class="t m0 xa2 h7 y8fe ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xbd hd y8fd ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x2 h5 y8ff ff5 fs3 fc1 sc0 ls0 ws0">t<span class="_ _11"></span><span class="ff6">+<span class="ff3">1</span></span></div><div class="t m0 x1e h7 y8fd ff6 fs2 fc1 sc0 ls0 ws0">←</div><div class="t m0 x87 h7 y8fe ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x1f hd y8fd ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x98 h8 y8ff ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xdc h7 y8fd ff6 fs2 fc1 sc0 ls0 ws0">−<span class="_ _9"></span><span class="ff5">η<span class="_ _7"> </span></span>·<span class="_ _9"></span>∇</div><div class="t m0 x5b h11 y900 ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x5a h26 y901 ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x4b h9 y902 ff5 fs2 fc1 sc0 ls0 ws0">(</div><div class="t m0 x4c h7 y903 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x7e hd y902 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x8c h8 y904 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x4 h36 y902 ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _5"> </span><span class="ffd">/<span class="_ _4"></span>/<span class="_"> </span>update<span class="_"> </span>estimate<span class="_"> </span>for</span></div><div class="t m0 x2c h7 y903 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x68 hd y902 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x85 h4 y7b7 ff7 fs16 fc1 sc0 ls0 ws0">8<span class="_ _46"> </span><span class="ff5 fs2">t<span class="_ _3"> </span><span class="ff6">←<span class="_ _5"> </span></span>t<span class="_ _5"> </span><span class="ff6">+<span class="_ _9"></span><span class="ff3">1</span></span></span></div><div class="t m0 x85 h7 y7b8 ff7 fs16 fc1 sc0 ls0 ws0">9<span class="_ _5a"> </span><span class="fs2">until<span class="_ _c"> </span><span class="ff6">k</span>w</span></div><div class="t m0 x69 h8 y7b9 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xfb h7 y7b8 ff6 fs2 fc1 sc0 ls0 ws0">−<span class="_ _9"></span><span class="ff7">w</span></div><div class="t m0 xb7 h5 y7b9 ff5 fs3 fc1 sc0 ls0 ws0">t<span class="_ _11"></span><span class="ff6">−<span class="ff3">1</span></span></div><div class="t m0 xd2 h7 y7b8 ff6 fs2 fc1 sc0 ls0 ws0">k<span class="_ _7"></span>≤<span class="_ _7"> </span><span class="ff5">ǫ</span></div><div class="t m0 x39 h4 y905 ff3 fs2 fc1 sc0 ls0 ws0">Using<span class="_ _5"> </span>(batc<span class="_ _4"></span>h)<span class="_ _5"> </span>gradient<span class="_ _c"> </span>descent,<span class="_ _c"> </span>we<span class="_ _5"> </span>ca<span class="_"> </span>n<span class="_ _c"> </span>iterativ<span class="_ _4"></span>ely<span class="_ _5"> </span>compute</div><div class="t m0 xd4 h7 y906 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x2b h4 y905 ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _5"> </span><span class="ff3">as<span class="_ _c"> </span>follows</span></div><div class="t m0 x69 h7 y907 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xa2 hd y908 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x13 h5 y909 ff5 fs3 fc1 sc0 ls0 ws0">t<span class="_ _11"></span><span class="ff6">+<span class="ff3">1</span></span></div><div class="t m0 xa5 h7 y908 ff6 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 x87 h7 y907 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x1f hd y908 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x4a h8 y909 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xdc h7 y908 ff6 fs2 fc1 sc0 ls0 ws0">−<span class="_ _9"></span><span class="ff5">η<span class="_ _9"> </span></span>·<span class="_ _9"></span>∇</div><div class="t m0 x5a h11 y90a ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x5a h26 y90b ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x4b h4 y90c ff6 fs2 fc1 sc0 ls0 ws0">=<span class="_ _7"></span><span class="ff5">(<span class="ff3">1<span class="_ _9"> </span></span></span>−<span class="_ _7"></span><span class="ff5">η<span class="_ _9"> </span></span>·<span class="_ _9"></span><span class="ff5">α<span class="_ _4"></span>)</span></div><div class="t m0 x4f h7 y90d ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x107 hd y90c ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x61 h8 y90e ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x93 h7 y90c ff6 fs2 fc1 sc0 ls0 ws0">+<span class="_ _9"></span><span class="ff5">η<span class="_ _7"> </span></span>·</div><div class="t m0 x84 h7 y90f ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x83 hd y90c ff7 fs2 fc1 sc0 ls0 ws0">D</div><div class="t m0 xea ha y90e ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x80 h7 y90c ff5 fs2 fc1 sc0 ls0 ws0">(<span class="ff4">Y<span class="_ _9"> </span><span class="ff6">−</span></span></div><div class="t m0 x40 h7 y90f ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x3e h7 y90c ff7 fs2 fc1 sc0 ls0 ws0">D<span class="_ _9"> </span><span class="ff6">·</span></div><div class="t m0 xe7 h7 y90d ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x67 hd y90c ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 xdf h8 y90e ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x91 h9 y90c ff5 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 x3a h4 y910 ff3 fs2 fc1 sc0 ls0 ws0">In<span class="_ _c"> </span>stochastic<span class="_ _5"> </span>g<span class="_"> </span>ra<span class="_ _4"></span>dient<span class="_ _c"> </span>descent<span class="_ _5"> </span>(SGD),<span class="_ _c"> </span>we<span class="_ _3"> </span>update<span class="_ _5"> </span>the<span class="_ _c"> </span>we<span class="_ _4"></span>ight<span class="_ _5"> </span>v<span class="_ _4"></span>ector<span class="_ _5"> </span>by<span class="_ _c"> </span>considering</div><div class="t m0 x39 h4 y911 ff3 fs2 fc1 sc0 ls0 ws0">only<span class="_ _c"> </span>one<span class="_ _3"> </span>(random)<span class="_ _3"> </span>point<span class="_ _3"> </span>at<span class="_ _3"> </span>each<span class="_ _c"> </span>t<span class="_ _4"></span>ime.<span class="_ _c"> </span>Re<span class="_ _4"></span>stricting<span class="_ _c"> </span>Eq.<span class="_ _3"> </span>(23.3<span class="_"> </span>5<span class="_ _4"></span>)<span class="_ _c"> </span>to<span class="_ _3"> </span>a<span class="_ _3"> </span>single<span class="_ _3"> </span>point</div><div class="t m0 x3c h7 y912 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x3c hd y911 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x37 h8 y913 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x49 h4 y911 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _c"> </span>t<span class="_ _4"></span>he</div><div class="t m0 x39 h4 y914 ff3 fs2 fc1 sc0 ls0 ws0">gradient<span class="_ _5"> </span>at<span class="_ _c"> </span>the<span class="_ _c"> </span>point</div><div class="t m0 xae h7 y915 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x1e hd y914 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x97 h8 y916 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x1f h4 y914 ff3 fs2 fc1 sc0 ls0 ws0">is<span class="_ _5"> </span>giv<span class="_ _4"></span>en<span class="_ _5"> </span>as</div><div class="t m0 xa2 h7 y917 ff6 fs2 fc1 sc0 ls0 ws0">∇</div><div class="t m0 x57 h11 y918 ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xfb h26 y919 ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x8a h9 y91a ff5 fs2 fc1 sc0 ls0 ws0">(</div><div class="t m0 xa4 h7 y91b ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xa4 hd y91a ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 xae h8 y91c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x97 h7 y91a ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _7"> </span><span class="ff6">=<span class="_ _7"></span>−</span></div><div class="t m0 x6a h7 y91b ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x20 hd y91a ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x58 h8 y91c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x17 h9 y91a ff5 fs2 fc1 sc0 ls0 ws0">y</div><div class="t m0 x7d h8 y91c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xc9 h7 y91a ff6 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 x79 h7 y91b ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x9a hd y91a ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x7e h8 y91c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x92 h7 y91d ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x92 hd y91e ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x7a ha y91f ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x7a h8 y920 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xbf h7 y921 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x5 h7 y922 ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _9"> </span><span class="ff6">+</span></div><div class="t m0 xa1 h9 y923 ff5 fs2 fc1 sc0 ls0 ws0">α</div><div class="t m0 xa1 h9 y924 ff5 fs2 fc1 sc0 ls0 ws0">n</div><div class="t m0 x5f h7 y925 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xa8 h7 y926 ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _7"> </span><span class="ff6">=<span class="_ _5"> </span>−<span class="ff5">(y</span></span></div><div class="t m0 x70 h8 y927 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x29 h7 y926 ff6 fs2 fc1 sc0 ls0 ws0">−</div><div class="t m0 xea h7 y925 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xea hd y926 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x80 ha y928 ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x80 h8 y929 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x2b h7 y92a ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xb1 hd y92b ff7 fs2 fc1 sc0 ls0 ws0">w<span class="ff5">)</span></div><div class="t m0 xaf h7 y92a ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xaf hd y92b ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x3e h8 y92c ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x3f h7 y92b ff6 fs2 fc1 sc0 ls0 ws0">+</div><div class="t m0 x67 h9 y92d ff5 fs2 fc1 sc0 ls0 ws0">α</div><div class="t m0 xe7 h9 y924 ff5 fs2 fc1 sc0 ls0 ws0">n</div><div class="t m0 xdf h7 y925 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xa3 h4 y926 ff7 fs2 fc1 sc0 ls0 ws0">w<span class="_ _61"> </span><span class="ff3">(23.36)</span></div><div class="t m0 x39 h4 y92e ff3 fs2 fc1 sc0 ls0 ws0">Here,<span class="_ _3"> </span>we<span class="_ _3"> </span>scale<span class="_ _3"> </span>the<span class="_ _3"> </span>regularization<span class="_ _3"> </span>constant<span class="_ _3"> </span><span class="ff5">α<span class="_ _d"> </span></span>by<span class="_ _c"> </span>dividing<span class="_ _3"> </span>it<span class="_ _8"> </span>by<span class="_ _c"> </span><span class="ff5">n</span>,<span class="_ _3"> </span>t<span class="_"> </span>he<span class="_ _3"> </span>number<span class="_ _8"> </span>of<span class="_ _c"> </span>points</div><div class="t m0 x39 h4 y92f ff3 fs2 fc1 sc0 ls0 ws0">in<span class="_ _c"> </span>the<span class="_ _3"> </span>tra<span class="_"> </span>ining<span class="_ _3"> </span>data,<span class="_ _3"> </span>since<span class="_ _3"> </span>the<span class="_ _3"> </span>original<span class="_ _c"> </span>ridge<span class="_ _3"> </span>v<span class="_ _4"></span>alue<span class="_ _c"> </span><span class="ff5">α<span class="_ _8"> </span></span>is<span class="_ _3"> </span>for<span class="_ _3"> </span>all<span class="_ _3"> </span>the<span class="_ _c"> </span><span class="ff5">n<span class="_ _8"> </span></span>points,<span class="_ _c"> </span>whereas<span class="_ _3"> </span>we</div><div class="t m0 x39 h4 y930 ff3 fs2 fc1 sc0 ls0 ws0">are<span class="_ _7"> </span>now<span class="_ _5"> </span>considering<span class="_ _7"> </span>only<span class="_ _5"> </span>one<span class="_ _5"> </span>point<span class="_ _7"> </span>a<span class="_ _4"></span>t<span class="_ _7"> </span>a<span class="_ _5"> </span>time.<span class="_ _7"> </span>Therefore,<span class="_ _5"> </span>the<span class="_ _5"> </span>stochastic<span class="_ _7"> </span>gradie<span class="_"> </span>nt<span class="_ _5"> </span>update</div><div class="t m0 x39 h4 y931 ff3 fs2 fc1 sc0 ls0 ws0">rule<span class="_ _5"> </span>is<span class="_ _c"> </span>giv<span class="_"> </span>e<span class="_ _4"></span>n<span class="_ _5"> </span>as</div><div class="t m0 xf9 h7 y932 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x11 hd y933 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 xbd h5 y934 ff5 fs3 fc1 sc0 ls0 ws0">t<span class="_ _11"></span><span class="ff6">+<span class="ff3">1</span></span></div><div class="t m0 x108 h7 y933 ff6 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 xb9 h7 y932 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xae hd y933 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x7c h8 y934 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 x87 h7 y933 ff6 fs2 fc1 sc0 ls0 ws0">−<span class="_ _9"></span><span class="ff5">η<span class="_ _9"> </span></span>·<span class="_ _9"></span>∇</div><div class="t m0 x99 h11 y935 ff6 fs3 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x7d h26 y936 ff7 fs3 fc1 sc0 ls0 ws0">w</div><div class="t m0 x78 h9 y937 ff5 fs2 fc1 sc0 ls0 ws0">(</div><div class="t m0 x8b h7 y938 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x8b hd y937 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x5b h8 y939 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x4b h7 y937 ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _7"> </span><span class="ff6">=</span></div><div class="t m0 x5 hc y93a ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x81 h4 y937 ff3 fs2 fc1 sc0 ls0 ws0">1<span class="_ _9"> </span><span class="ff6">−</span></div><div class="t m0 x10 h7 y93b ff5 fs2 fc1 sc0 ls0 ws0">η<span class="_ _7"> </span><span class="ff6">·<span class="_ _9"></span></span>α</div><div class="t m0 x5f h9 y93c ff5 fs2 fc1 sc0 ls0 ws0">n</div><div class="t m0 x50 hc y93d ff9 fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x106 h7 y93e ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x93 hd y93f ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x8d h8 y940 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xd7 h7 y93f ff6 fs2 fc1 sc0 ls0 ws0">+<span class="_ _9"></span><span class="ff5">η<span class="_ _9"> </span></span>·<span class="_ _9"></span><span class="ff5">(y</span></div><div class="t m0 x2b h8 y941 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xd5 h7 y93f ff6 fs2 fc1 sc0 ls0 ws0">−</div><div class="t m0 x64 h7 y93e ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 x64 hd y93f ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x65 ha y940 ff4 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x65 h8 y942 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 xcc h7 y943 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xdd hd y944 ff7 fs2 fc1 sc0 ls0 ws0">w</div><div class="t m0 x68 h8 y945 ff5 fs3 fc1 sc0 ls0 ws0">t</div><div class="t m0 xa3 h7 y944 ff5 fs2 fc1 sc0 ls0 ws0">)<span class="_ _9"> </span><span class="ff6">·</span></div><div class="t m0 xd6 h7 y943 ff6 fs2 fc1 sc0 ls0 ws0">˜</div><div class="t m0 xd6 hd y944 ff7 fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 xb3 h8 y946 ff5 fs3 fc1 sc0 ls0 ws0">k</div><div class="t m0 x3a h4 y947 ff3 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _54"> </span>23.3<span class="_ _54"> </span>shows<span class="_ _54"> </span>the<span class="_ _54"> </span>pseudo-code<span class="_ _54"> </span>for<span class="_ _54"> </span>the<span class="_ _54"> </span>stochastic<span class="_ _54"> </span>gra<span class="_"> </span>die<span class="_ _4"></span>nt<span class="_ _54"> </span>descent</div><div class="t m0 x39 h4 y948 ff3 fs2 fc1 sc0 ls0 ws0">algorithm<span class="_ _3"> </span>f<span class="_ _4"></span>or<span class="_ _3"> </span>ridge<span class="_ _8"> </span>reg<span class="_ _4"></span>ression.<span class="_ _3"> </span>Aft<span class="_ _4"></span>er<span class="_ _3"> </span>a<span class="_"> </span>ug<span class="_ _4"></span>menting<span class="_ _3"> </span>the<span class="_ _8"> </span>dat<span class="_ _4"></span>a<span class="_ _3"> </span>matrix,<span class="_ _8"> </span>in<span class="_ _8"> </span>each<span class="_ _8"> </span>iteration<span class="_ _3"> </span>it</div><div class="t m0 x39 h4 y949 ff3 fs2 fc1 sc0 ls0 ws0">updates<span class="_ _3"> </span>the<span class="_ _3"> </span>weight<span class="_ _3"> </span>v<span class="_"> </span>e<span class="_ _4"></span>ctor<span class="_ _c"> </span>by<span class="_ _3"> </span>considering<span class="_ _8"> </span>the<span class="_ _3"> </span>gradient<span class="_ _3"> </span>at<span class="_ _3"> </span>eac<span class="_"> </span>h<span class="_ _8"> </span>point<span class="_ _c"> </span>in<span class="_ _8"> </span>random<span class="_ _3"> </span>order.</div><div class="t m0 x39 h4 y94a ff3 fs2 fc1 sc0 ls0 ws0">The<span class="_ _7"> </span>method<span class="_ _7"> </span>stops<span class="_ _7"> </span>when<span class="_ _7"> </span>the<span class="_ _9"> </span>we<span class="_ _4"></span>ight<span class="_ _7"> </span>vector<span class="_ _7"> </span>converges<span class="_ _7"> </span>based<span class="_ _7"> </span>on<span class="_ _7"> </span>the<span class="_ _9"> </span>t<span class="_"> </span>ole<span class="_ _4"></span>rance<span class="_ _7"> </span><span class="ff5">ǫ<span class="_ _11"></span></span>.<span class="_ _9"> </span>The<span class="_ _7"> </span>code</div><div class="t m0 x39 h4 y94b ff3 fs2 fc1 sc0 ls0 ws0">is<span class="_ _5"> </span>for<span class="_ _5"> </span>the<span class="_ _7"> </span>pe<span class="_ _4"></span>nalized<span class="_ _5"> </span>bias<span class="_ _5"> </span>case.<span class="_ _5"> </span>It<span class="_ _5"> </span>is<span class="_ _5"> </span>easy<span class="_ _7"> </span>t<span class="_ _4"></span>o<span class="_ _5"> </span>adapt<span class="_ _5"> </span>it<span class="_ _5"> </span>for<span class="_ _5"> </span>unpenalized<span class="_ _5"> </span>bias<span class="_ _7"> </span>by<span class="_ _c"> </span>centering<span class="_ _5"> </span>the</div><div class="t m0 x39 h4 y94c ff3 fs2 fc1 sc0 ls0 ws0">unaugmented<span class="_ _5"> </span>data<span class="_ _c"> </span>matrix<span class="_ _c"> </span>and<span class="_ _5"> </span>t<span class="_"> </span>he<span class="_ _c"> </span>response<span class="_ _c"> </span>variable.</div><div class="t m0 xa7 h4 y94d ff7 fs2 fc1 sc0 ls0 ws0">Example<span class="_ _5"> </span>2<span class="_ _4"></span>3.8<span class="_ _5"> </span>(Ridge<span class="_ _c"> </span>Reg<span class="_ _4"></span>ression:<span class="_ _5"> </span>SGD).<span class="_ _a"> </span><span class="ff3">We<span class="_ _54"> </span>apply<span class="_ _2c"> </span>ridge<span class="_ _54"> </span>regression<span class="_ _54"> </span>on<span class="_ _54"> </span>the<span class="_ _2c"> </span>Iris</span></div><div class="t m0 xa7 h4 y94e ff3 fs2 fc1 sc0 ls0 ws0">dataset<span class="_ _3"> </span>(<span class="ff5">n<span class="_ _5"> </span><span class="ff6">=<span class="_ _5"> </span></span></span>150),<span class="_ _3"> </span>using<span class="_ _3"> </span><span class="ffd">pe<span class="_ _4"></span>tal<span class="_"> </span>length<span class="_ _3"> </span></span>(<span class="ff4">X</span>)<span class="_ _3"> </span>as<span class="_ _3"> </span>the<span class="_ _3"> </span>independent<span class="_ _3"> </span>att<span class="_"> </span>ribute<span class="_ _4"></span>,<span class="_ _c"> </span>a<span class="_ _4"></span>nd<span class="_ _3"> </span><span class="ffd">petal</span></div><div class="t m0 xa7 h4 y94f ffd fs2 fc1 sc0 ls0 ws0">width<span class="_ _3"> </span><span class="ff3">(<span class="ff4">Y</span>)<span class="_ _8"> </span>as<span class="_ _3"> </span>the<span class="_ _3"> </span>response<span class="_ _8"> </span>variable.<span class="_ _3"> </span>Using<span class="_ _8"> </span>SGD<span class="_ _3"> </span>(with<span class="_ _3"> </span><span class="ff5">η<span class="_ _c"> </span><span class="ff6">=<span class="_ _c"> </span></span></span>0<span class="ff5">.</span>00<span class="_"> </span>1<span class="_ _3"> </span>a<span class="_ _4"></span>nd<span class="_ _3"> </span><span class="ff5">ǫ<span class="_ _3"> </span><span class="ff6">=<span class="_ _c"> </span></span></span>0<span class="ff5">.</span>000<span class="_ _4"></span>1)<span class="_ _c"> </span>we</span></div><div class="t m0 xa7 h4 y950 ff3 fs2 fc1 sc0 ls0 ws0">obtain<span class="_ _c"> </span>dif<span class="_"> </span>f<span class="_ _4"></span>erent<span class="_ _3"> </span>lines<span class="_ _c"> </span>of<span class="_ _8"> </span>best<span class="_ _c"> </span>ﬁt<span class="_ _3"> </span>for<span class="_ _3"> </span>diff<span class="_ _4"></span>erent<span class="_ _c"> </span>v<span class="_ _4"></span>alues<span class="_ _c"> </span>of<span class="_ _3"> </span>t<span class="_"> </span>he<span class="_ _3"> </span>reg<span class="_ _4"></span>ularization<span class="_ _c"> </span>constant<span class="_ _3"> </span><span class="ff5">α<span class="_ _4"></span></span>,</div><div class="t m0 xa7 h4 y951 ff3 fs2 fc1 sc0 ls0 ws0">which<span class="_ _5"> </span>e<span class="_ _4"></span>ssentially<span class="_ _5"> </span>mat<span class="_ _4"></span>ch<span class="_ _5"> </span>the<span class="_ _c"> </span>results<span class="_ _5"> </span>f<span class="_ _4"></span>rom<span class="_ _5"> </span>the<span class="_ _c"> </span>exa<span class="_ _4"></span>ct<span class="_ _5"> </span>method<span class="_ _5"> </span>in<span class="_ _c"> </span>Example<span class="_ _c"> </span>23.6<span class="_ _4"></span>:</div><div class="t m0 xd1 h4 y952 ff5 fs2 fc1 sc0 ls0 ws0">α<span class="_ _5"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">0<span class="_ _7"> </span>:</span></span></div><div class="t m0 x7c hc y953 ff9 fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 xb0 h4 y952 ff4 fs2 fc1 sc0 ls0 ws0">Y<span class="_ _3"> </span><span class="ff6">=<span class="_ _7"> </span>−<span class="ff3">0<span class="_ _4"></span><span class="ff5">.</span>366<span class="_ _7"> </span></span>+<span class="_ _9"></span><span class="ff3">0<span class="ff5">.</span>413<span class="_ _9"> </span></span>·<span class="_ _7"></span></span>X<span class="_ _62"> </span>SSE<span class="_ _7"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">6<span class="ff5">.</span>37</span></span></div><div class="t m0 xbd h4 y954 ff5 fs2 fc1 sc0 ls0 ws0">α<span class="_ _5"> </span><span class="ff6">=<span class="_ _7"> </span><span class="ff3">1<span class="_ _4"></span>0<span class="_ _7"> </span>:</span></span></div><div class="t m0 x7c hc y955 ff9 fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 xb0 h4 y954 ff4 fs2 fc1 sc0 ls0 ws0">Y<span class="_ _3"> </span><span class="ff6">=<span class="_ _7"> </span>−<span class="ff3">0<span class="_ _4"></span><span class="ff5">.</span>244<span class="_ _7"> </span></span>+<span class="_ _9"></span><span class="ff3">0<span class="ff5">.</span>387<span class="_ _9"> </span></span>·<span class="_ _7"></span></span>X<span class="_ _62"> </span>SSE<span class="_ _7"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">6<span class="ff5">.</span>76</span></span></div><div class="t m0 xf9 h4 y956 ff5 fs2 fc1 sc0 ls0 ws0">α<span class="_ _5"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">100<span class="_ _7"> </span>:</span></span></div><div class="t m0 x7c hc y957 ff9 fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 xb0 h4 y956 ff4 fs2 fc1 sc0 ls0 ws0">Y<span class="_ _3"> </span><span class="ff6">=<span class="_ _7"> </span>−<span class="ff3">0<span class="_ _4"></span><span class="ff5">.</span>022<span class="_ _7"> </span></span>+<span class="_ _9"></span><span class="ff3">0<span class="ff5">.</span>327<span class="_ _9"> </span></span>·<span class="_ _7"></span></span>X<span class="_ _62"> </span>SSE<span class="_ _7"> </span><span class="ff6">=<span class="_ _5"> </span><span class="ff3">10<span class="ff5">.</span>04</span></span></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
