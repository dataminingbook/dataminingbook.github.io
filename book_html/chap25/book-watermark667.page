<div id="pf29b" class="pf w0 h0" data-page-no="29b"><div class="pc pc29b w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg29b.png"/><div class="t m0 x9d hf y2a ffa fs0 fc1 sc0 ls0 ws0">Multilayer<span class="_ _3"> </span>Perceptr<span class="_"> </span>on:<span class="_ _a"> </span>One<span class="_ _3"> </span>Hidden<span class="_ _3"> </span>Layer<span class="_ _23"> </span><span class="ff2">655</span></div><div class="t m0 xe1 h4 y54f ff8 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _7"> </span>25.1:<span class="_ _3"> </span><span class="ff4">MLP<span class="_ _a"> </span>Training:<span class="_ _a"> </span>Stochastic<span class="_ _3"> </span>Gradie<span class="_"> </span>nt<span class="_ _a"> </span>Descent</span></div><div class="t m0 x50 h1a y550 ffc fs2 fc1 sc0 ls0 ws0">MLP-T<span class="fs5">R<span class="_ _f"></span>AI<span class="_ _f"></span>N<span class="_ _5"></span>I<span class="_ _f"></span>N<span class="_ _5"></span>G<span class="_ _7"> </span></span>(D<span class="ff6">,<span class="_ _f"></span>m,<span class="_ _0"> </span>η<span class="_ _5"></span>,<span class="_ _0"> </span><span class="fff">maxit<span class="_ _5"></span>er</span></span>):</div><div class="t m0 x50 h39 y551 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_"> </span>bias<span class="_"> </span>vectors</div><div class="t m0 xf0 h1a y552 ffc fs14 fc1 sc0 ls0 ws0">1<span class="_ _c"> </span><span class="fs2">b</span></div><div class="t m0 xe2 h6 y553 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xdd h4 y552 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _a"> </span><span class="ff4">random<span class="_ _3"> </span><span class="ff6">m</span>-<span class="_ _5"></span>dimensional<span class="_ _a"> </span>vector<span class="_ _3"> </span>with<span class="_ _a"> </span>small<span class="_ _a"> </span>values</span></div><div class="t m0 xf0 h1a y554 ffc fs14 fc1 sc0 ls0 ws0">2<span class="_ _c"> </span><span class="fs2">b</span></div><div class="t m0 xe2 h6 y555 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xdd h4 y554 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _a"> </span><span class="ff4">random<span class="_ _3"> </span><span class="ff6">p<span class="_ _5"></span></span>-dimensional<span class="_ _a"> </span>v<span class="_ _5"></span>ector<span class="_ _a"> </span>with<span class="_ _3"> </span>small<span class="_ _a"> </span>values</span></div><div class="t m0 x50 h39 y1d2 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Initi<span class="_ _5"></span>alize<span class="_"> </span>weight<span class="_"> </span>matrices</div><div class="t m0 xf0 h1a y1d3 ffc fs14 fc1 sc0 ls0 ws0">3<span class="_ _c"> </span><span class="fs2">W</span></div><div class="t m0 xd0 h6 y556 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x9e h4 y1d3 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff4">random<span class="_ _a"> </span><span class="ff6">d<span class="_ _3"> </span></span></span>×<span class="_ _b"></span><span class="ff6">m<span class="_ _a"> </span><span class="ff4">matrix<span class="_ _a"> </span>with<span class="_ _a"> </span>small<span class="_ _3"> </span>va<span class="_ _5"></span>lues</span></span></div><div class="t m0 xf0 h1a y557 ffc fs14 fc1 sc0 ls0 ws0">4<span class="_ _c"> </span><span class="fs2">W</span></div><div class="t m0 xd0 h6 y36 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x9e h4 y557 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _1"> </span><span class="ff4">random<span class="_ _a"> </span><span class="ff6">m<span class="_ _b"> </span></span></span>×<span class="_ _b"></span><span class="ff6">p<span class="_ _7"> </span><span class="ff4">matrix<span class="_ _3"> </span>with<span class="_ _a"> </span>small<span class="_ _a"> </span>values</span></span></div><div class="t m0 xf0 h4 y558 ffc fs14 fc1 sc0 ls0 ws0">5<span class="_ _c"> </span><span class="ff6 fs2">t<span class="_ _7"> </span><span class="ff5">←<span class="_ _3"> </span><span class="ff4">0<span class="_ _a"> </span><span class="fff">//<span class="_"> </span>iterati<span class="_ _5"></span>on<span class="_ _c"> </span>co<span class="_ _5"></span>unter</span></span></span></span></div><div class="t m0 xf0 h1a y559 ffc fs14 fc1 sc0 ls0 ws0">6<span class="_ _c"> </span><span class="fs2">repe<span class="_ _5"></span>at</span></div><div class="t m0 xf0 h1a y55a ffc fs14 fc1 sc0 ls0 ws0">7<span class="_ _31"> </span><span class="fs2">foreach<span class="_ _a"> </span><span class="ff6">(</span>x</span></div><div class="t m0 x6f h6 y55b ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x44 h1a y55a ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ffc">y</span></div><div class="t m0 x78 h6 y55b ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xa0 h8 y55a ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _4"> </span><span class="ff5">∈<span class="_ _3"> </span><span class="ffc">D<span class="_ _a"> </span><span class="ff3">in<span class="_ _3"> </span>random<span class="_ _a"> </span>order<span class="_ _a"> </span></span>do</span></span></div><div class="t m0 x1c h39 y21e fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Feed-<span class="_ _5"></span>forwar<span class="_ _5"></span>d<span class="_ _c"> </span>phase</div><div class="t m0 xce h1a y55c ffc fs14 fc1 sc0 ls0 ws0">8<span class="_ _32"> </span><span class="fs2">z</span></div><div class="t m0 x43 h6 y55d ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x9f h8 y55c ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff6">f</span></div><div class="t m0 x44 h18 y55e ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x7 h1a y55c ffc fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 x78 h6 y55d ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xb7 h8 y55c ff5 fs2 fc1 sc0 ls0 ws0">+<span class="_ _b"></span><span class="ffc">W</span></div><div class="t m0 xb8 h19 y117 ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 xfa h6 y55f ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x90 h1a y55c ffc fs2 fc1 sc0 ls0 ws0">x</div><div class="t m0 x5d h6 y55d ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x96 h18 y55e ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xce h1a y560 ffc fs14 fc1 sc0 ls0 ws0">9<span class="_ _32"> </span><span class="fs2">o</span></div><div class="t m0 x43 h6 y561 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xe3 h8 y560 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff6">f</span></div><div class="t m0 x44 h18 y562 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xd2 h1a y560 ffc fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 xc2 h6 y561 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xb7 h8 y560 ff5 fs2 fc1 sc0 ls0 ws0">+<span class="_ _b"></span><span class="ffc">W</span></div><div class="t m0 xa8 h19 y19e ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 xb8 h6 y563 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x45 h1a y560 ffc fs2 fc1 sc0 ls0 ws0">z</div><div class="t m0 x5d h6 y561 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x96 h18 y562 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x1c h39 y564 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Backp<span class="_ _5"></span>ropaga<span class="_ _5"></span>tion<span class="_ _c"> </span>phase:<span class="_"> </span>net<span class="_"> </span>gradie<span class="_ _5"></span>nts</div><div class="t m0 xe1 h30 y565 ffc fs14 fc1 sc0 ls0 ws0">10<span class="_ _32"> </span><span class="ff11 fs2">δ</span></div><div class="t m0 x43 h6 ye2 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xe3 h8 y565 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">o</span></div><div class="t m0 x6c h6 ye2 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xd2 h8 y565 ff5 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _9"> </span><span class="ff6">(<span class="ffc">1<span class="_ _b"> </span></span></span>−<span class="_ _b"></span><span class="ffc">o</span></div><div class="t m0 x35 h6 ye2 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x5d h8 y565 ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _6"> </span><span class="ff5">⊙<span class="_ _9"> </span></span>(<span class="ffc">o</span></div><div class="t m0 x3a h6 ye2 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x38 h8 y565 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ffc">y</span></div><div class="t m0 x56 h6 ye2 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x3b h7 y565 ff6 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 xe1 h30 y3df ffc fs14 fc1 sc0 ls0 ws0">11<span class="_ _32"> </span><span class="ff11 fs2">δ</span></div><div class="t m0 x43 h6 y566 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xe3 h8 y3df ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">z</span></div><div class="t m0 x6f h6 y566 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x7 h8 y3df ff5 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _9"> </span><span class="ff6">(<span class="ffc">1<span class="_ _b"> </span></span></span>−<span class="_ _b"></span><span class="ffc">z</span></div><div class="t m0 x45 h6 y566 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x35 h8 y3df ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _6"> </span><span class="ff5">⊙<span class="_ _9"> </span></span>(<span class="ffc">W</span></div><div class="t m0 xea h6 y566 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x33 h8 y3df ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff11">δ</span></div><div class="t m0 x92 h6 y566 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xf2 h7 y3df ff6 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 x1c h39 y567 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ent<span class="_ _c"> </span>d<span class="_ _5"></span>escent<span class="_"> </span>for<span class="_"> </span>bias<span class="_"> </span>vectors</div><div class="t m0 xe1 h31 y568 ffc fs14 fc1 sc0 ls0 ws0">12<span class="_ _32"> </span><span class="ff12 fs2">∇</span></div><div class="t m0 xc5 h2a y569 ffc fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 xe3 h26 y56a ff6 fsd fc1 sc0 ls0 ws0">o</div><div class="t m0 x2f h8 y568 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ff11">δ</span></div><div class="t m0 x7 h6 y569 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x8f h8 y568 ff5 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ffc">b</span></div><div class="t m0 xa2 h6 y569 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xb8 h8 y568 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">b</span></div><div class="t m0 x9b h6 y569 ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x100 h8 y568 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff12">∇</span></div><div class="t m0 x19 h2a y569 ffc fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 x1e h26 y56a ff6 fsd fc1 sc0 ls0 ws0">o</div><div class="t m0 xe1 h31 y56b ffc fs14 fc1 sc0 ls0 ws0">13<span class="_ _32"> </span><span class="ff12 fs2">∇</span></div><div class="t m0 xc5 h2a y56c ffc fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 xe3 h26 y56d ff6 fsd fc1 sc0 ls0 ws0">h</div><div class="t m0 x2f h8 y56b ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ff11">δ</span></div><div class="t m0 x7 h6 y56c ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x8 h8 y56b ff5 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ffc">b</span></div><div class="t m0 xa2 h6 y56c ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xb8 h8 y56b ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">b</span></div><div class="t m0 xad h6 y56c ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xa9 h8 y56b ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _4"> </span></span>·<span class="_ _b"></span><span class="ff12">∇</span></div><div class="t m0 x92 h2a y56c ffc fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 x56 h26 y56d ff6 fsd fc1 sc0 ls0 ws0">h</div><div class="t m0 x1c h39 y3e6 fff fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Gradi<span class="_ _5"></span>ent<span class="_ _c"> </span>d<span class="_ _5"></span>escent<span class="_"> </span>for<span class="_"> </span>weight<span class="_"> </span>matrice<span class="_ _5"></span>s</div><div class="t m0 xe1 h31 y3ea ffc fs14 fc1 sc0 ls0 ws0">14<span class="_ _32"> </span><span class="ff12 fs2">∇</span></div><div class="t m0 xc5 h2a y56e ffc fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x109 h26 y56f ff6 fsd fc1 sc0 ls0 ws0">o</div><div class="t m0 x52 h8 y3ea ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">z</span></div><div class="t m0 x5f h6 y56e ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xc2 h8 y3ea ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff11">δ</span></div><div class="t m0 x31 h19 y1b1 ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x31 h6 y35f ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x32 h8 y3ea ff5 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ffc">W</span></div><div class="t m0 xac h6 y56e ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 xa3 h8 y3ea ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"> </span><span class="ffc">W</span></div><div class="t m0 x38 h6 y56e ff6 fs3 fc1 sc0 ls0 ws0">o</div><div class="t m0 x58 h8 y3ea ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff12">∇</span></div><div class="t m0 x3c h2a y56e ffc fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x5a h26 y56f ff6 fsd fc1 sc0 ls0 ws0">o</div><div class="t m0 xe1 h31 y570 ffc fs14 fc1 sc0 ls0 ws0">15<span class="_ _32"> </span><span class="ff12 fs2">∇</span></div><div class="t m0 xc5 h2a y571 ffc fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x109 h26 y572 ff6 fsd fc1 sc0 ls0 ws0">h</div><div class="t m0 xa7 h8 y570 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">x</span></div><div class="t m0 x8f h6 y571 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xc2 h8 y570 ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff11">δ</span></div><div class="t m0 x31 h19 y573 ff3 fs3 fc1 sc0 ls0 ws0">T</div><div class="t m0 x31 h6 y1af ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x7b h8 y570 ff5 fs2 fc1 sc0 ls0 ws0">;<span class="_"> </span><span class="ffc">W</span></div><div class="t m0 xac h6 y571 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xa3 h8 y570 ff5 fs2 fc1 sc0 ls0 ws0">←<span class="_ _4"></span><span class="ffc">W</span></div><div class="t m0 x54 h6 y571 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x34 h8 y570 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _4"> </span></span>·<span class="_ _b"></span><span class="ff12">∇</span></div><div class="t m0 x59 h2a y571 ffc fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 x48 h26 y572 ff6 fsd fc1 sc0 ls0 ws0">h</div><div class="t m0 xe1 h4 y574 ffc fs14 fc1 sc0 ls0 ws0">16<span class="_ _31"> </span><span class="ff6 fs2">t<span class="_ _7"> </span><span class="ff5">←<span class="_ _4"></span></span>t<span class="_ _a"> </span><span class="ff5">+<span class="_ _b"></span><span class="ff4">1</span></span></span></div><div class="t m0 x2a h8 y575 ffc fs14 fc1 sc0 ls0 ws0">17<span class="_ _c"> </span><span class="fs2">until<span class="_ _a"> </span><span class="ff6">t<span class="_ _7"> </span><span class="ff5">≥<span class="_ _3"> </span><span class="fff">maxi<span class="_ _5"></span>ter</span></span></span></span></div><div class="t m0 x6 h4 y576 ff4 fs2 fc1 sc0 ls0 ws0">Once<span class="_ _a"> </span>the<span class="_ _a"> </span>gradients<span class="_ _3"> </span>ha<span class="_"> </span>v<span class="_ _5"></span>e<span class="_ _3"> </span>bee<span class="_ _5"></span>n<span class="_ _a"> </span>computed,<span class="_ _3"> </span>we<span class="_ _a"> </span>can<span class="_ _a"> </span>update<span class="_ _a"> </span>all<span class="_ _a"> </span>the<span class="_ _3"> </span>we<span class="_ _5"></span>ights<span class="_ _3"> </span>a<span class="_ _5"></span>nd<span class="_ _a"> </span>biases</div><div class="t m0 x3 h4 y577 ff4 fs2 fc1 sc0 ls0 ws0">as<span class="_ _a"> </span>follows</div><div class="t m0 xc7 h1a y578 ffc fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xa3 h6 y579 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xe0 h8 y578 ff5 fs2 fc1 sc0 ls0 ws0">=<span class="_ _4"></span><span class="ffc">W</span></div><div class="t m0 x33 h6 y579 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x19 h8 y578 ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff12">∇</span></div><div class="t m0 x93 h2a y579 ffc fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 xee h26 y57a ff6 fsd fc1 sc0 ls0 ws0">h</div><div class="t m0 xac h1a y57b ffc fs2 fc1 sc0 ls0 ws0">b</div><div class="t m0 xa3 h6 y57c ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xe0 h8 y57b ff5 fs2 fc1 sc0 ls0 ws0">=<span class="_ _4"></span><span class="ffc">b</span></div><div class="t m0 x38 h6 y57c ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x58 h8 y57b ff5 fs2 fc1 sc0 ls0 ws0">−<span class="_ _b"></span><span class="ff6">η<span class="_ _b"> </span></span>·<span class="_ _b"></span><span class="ff12">∇</span></div><div class="t m0 xcd h2a y57c ffc fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 x59 h26 y57d ff6 fsd fc1 sc0 ls0 ws0">h</div><div class="t m0 xb0 h4 y57e ff4 fs2 fc1 sc0 ls0 ws0">(25.42)</div><div class="t m0 x3 h4 y23f ff4 fs2 fc1 sc0 ls0 ws0">where<span class="_ _a"> </span><span class="ff6">η<span class="_ _a"> </span></span>is<span class="_ _a"> </span>the<span class="_ _a"> </span>step<span class="_ _3"> </span>size<span class="_ _a"> </span>(or<span class="_ _a"> </span>learning<span class="_ _a"> </span>rate).</div><div class="t m0 x3 h28 y57f ff1 fs4 fc2 sc0 ls0 ws0">25.3.3<span class="_ _d"> </span><span class="ff8 fse fc1">MLP<span class="_ _7"> </span>T<span class="_ _17"></span>r<span class="_ _17"></span>a<span class="_ _5"></span>ining</span></div><div class="t m0 x3 h4 y179 ff4 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _7"> </span>25.1<span class="_ _7"> </span>shows<span class="_ _a"> </span>t<span class="_ _5"></span>he<span class="_ _7"> </span>pseudo-code<span class="_ _7"> </span>for<span class="_ _7"> </span>learning<span class="_ _a"> </span>t<span class="_ _5"></span>he<span class="_ _7"> </span>weights<span class="_ _7"> </span>considering<span class="_ _7"> </span>all<span class="_ _a"> </span>of<span class="_ _7"> </span>the</div><div class="t m0 x3 h4 y17a ff4 fs2 fc1 sc0 ls0 ws0">input<span class="_ _7"> </span>points<span class="_ _7"> </span>in<span class="_ _6"> </span><span class="ffc">D<span class="_ _7"> </span></span>via<span class="_ _7"> </span><span class="ff3">stochastic<span class="_ _7"> </span>gra<span class="_ _5"></span>dient<span class="_ _7"> </span>descent</span>.<span class="_ _7"> </span>The<span class="_ _6"> </span>code<span class="_ _7"> </span>is<span class="_ _7"> </span>shown<span class="_ _7"> </span>f<span class="_ _5"></span>or<span class="_ _7"> </span>an<span class="_ _7"> </span>MLP<span class="_ _6"> </span>with</div><div class="t m0 x3 h4 y17b ff4 fs2 fc1 sc0 ls0 ws0">a<span class="_ _6"> </span>single<span class="_ _6"> </span>hidden<span class="_ _6"> </span>lay<span class="_ _5"></span>er,<span class="_ _6"> </span>using<span class="_ _6"> </span>a<span class="_ _6"> </span>squared<span class="_ _6"> </span>error<span class="_ _6"> </span>funct<span class="_ _5"></span>ion,<span class="_ _6"> </span>and<span class="_ _6"> </span>sigmoid<span class="_ _6"> </span>activa<span class="_"> </span>t<span class="_ _5"></span>ions<span class="_ _7"> </span>for<span class="_ _9"> </span>all</div><div class="t m0 x3 h4 y17c ff4 fs2 fc1 sc0 ls0 ws0">hidden<span class="_ _4"> </span>and<span class="_ _4"> </span>output<span class="_ _3"> </span>neurons.<span class="_ _4"> </span>The<span class="_ _3"> </span>approach<span class="_ _4"> </span>is<span class="_ _4"> </span>ca<span class="_ _5"></span>lled<span class="_ _4"> </span>stochastic<span class="_ _4"> </span>gradient<span class="_ _4"> </span>de<span class="_"> </span>sce<span class="_ _5"></span>nt<span class="_ _4"> </span>since<span class="_ _4"> </span>we</div><div class="t m0 x3 h4 y1f ff4 fs2 fc1 sc0 ls0 ws0">compute<span class="_ _a"> </span>the<span class="_ _7"> </span>weight<span class="_ _a"> </span>and<span class="_ _a"> </span>bias<span class="_ _a"> </span>g<span class="_ _5"></span>radients<span class="_ _a"> </span>aft<span class="_"> </span>e<span class="_ _5"></span>r<span class="_ _a"> </span>observing<span class="_ _a"> </span>each<span class="_ _a"> </span>training<span class="_ _7"> </span>point<span class="_ _a"> </span>(in<span class="_ _a"> </span>random</div><div class="t m0 x3 h4 y20 ff4 fs2 fc1 sc0 ls0 ws0">order).</div><div class="t m0 x6 h4 y21 ff4 fs2 fc1 sc0 ls0 ws0">The<span class="_ _1"> </span>MLP<span class="_ _c"> </span>algorithm<span class="_ _1"> </span>t<span class="_"> </span>a<span class="_ _5"></span>kes<span class="_ _1"> </span>as<span class="_ _c"> </span>input<span class="_ _1"> </span>the<span class="_ _c"> </span>dataset<span class="_ _1"> </span><span class="ffc">D<span class="_ _1"> </span></span>(wit<span class="_"> </span>h<span class="_ _c"> </span>points<span class="_ _c"> </span><span class="ffc">x</span></div><div class="t m0 x7c h6 y17f ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x5b h4 y21 ff4 fs2 fc1 sc0 ls0 ws0">and<span class="_ _1"> </span>desired</div><div class="t m0 x3 h4 y22 ff4 fs2 fc1 sc0 ls0 ws0">responses<span class="_ _4"> </span><span class="ffc">y</span></div><div class="t m0 x16 h6 y142 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x2d h4 y22 ff4 fs2 fc1 sc0 ls0 ws0">for<span class="_ _4"> </span><span class="ff6">i<span class="_ _3"> </span><span class="ff5">=<span class="_ _b"></span></span></span>1<span class="ff6">,<span class="_ _0"> </span></span>2<span class="ff6">,<span class="_ _0"> </span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _3"> </span></span>,<span class="_ _0"> </span>n</span>),<span class="_ _3"> </span>the<span class="_ _4"> </span>number<span class="_ _4"> </span>of<span class="_ _3"> </span>hidden<span class="_ _4"> </span>layer<span class="_ _4"> </span>ne<span class="_"> </span>urons<span class="_ _4"> </span><span class="ff6">m</span>,<span class="_ _3"> </span>the<span class="_ _4"> </span>learning<span class="_ _4"> </span>rate</div><div class="c x14 y24 w2 hb"><div class="t m1 x15 hc y25 ff9 fs6 fc1 sc0 ls0 ws0"><span class="fc4 sc0">For Online Reading </span><span class="fc4 sc0">Only</span></div></div><div class="c x16 y26 w3 hd"><div class="t m0 x17 he y27 ff9 fs7 fc3 sc0 ls0 ws0">This version is for online reading only. Unauthorized distribution is not allowed. </div><div class="t m0 x0 he y28 ff9 fs7 fc3 sc0 ls0 ws0">Please cite the book if you find it useful, and leave a review on online platforms.<span class="fc4 sc0"> </span></div><div class="t m0 x18 he y29 ff9 fs7 fc3 sc0 ls0 ws0">Please report all errata to contact@dataminingbook.info</div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
