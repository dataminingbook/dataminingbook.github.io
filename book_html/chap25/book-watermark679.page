<div id="pf2a7" class="pf w0 h0" data-page-no="2a7"><div class="pc pc2a7 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg2a7.png"/><div class="t m0 x9d hf y2a ffa fs0 fc1 sc0 ls0 ws0">Deep<span class="_ _3"> </span>Multilayer<span class="_ _a"> </span>Perceptrons<span class="_ _52"> </span><span class="ff2">667</span></div><div class="t m0 x3 h4 ycb ff4 fs2 fc1 sc0 ls0 ws0">Section<span class="_ _a"> </span>25.1.1,<span class="_ _3"> </span>we<span class="_ _a"> </span>hav<span class="_ _5"></span>e</div><div class="t m0 xb7 h1a y13dc ff6 fs2 fc1 sc0 ls0 ws0">∂<span class="_ _f"></span><span class="ffc">f</span></div><div class="t m0 x114 h6 y13dd ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x26 h8 y13dc ff5 fs2 fc1 sc0 ls0 ws0">=</div><div class="t m0 x45 h18 y13de ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x45 h18 y13df ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x45 h18 y13e0 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x45 h18 y13e1 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x45 h18 y1d0 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x45 h18 y13e2 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x45 h18 y13e3 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x96 h4 y13e4 ffc fs2 fc1 sc0 ls0 ws0">1<span class="_ _56"> </span><span class="ff4">for<span class="_ _a"> </span>linear</span></div><div class="t m0 x96 h1a y1377 ffc fs2 fc1 sc0 ls0 ws0">z</div><div class="t m0 x9b h6 y12a8 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xa3 h8 y1377 ff6 fs2 fc1 sc0 ls0 ws0">(<span class="ffc">1<span class="_ _b"> </span><span class="ff5">−<span class="_ _b"></span></span>z</span></div><div class="t m0 x54 h6 y12a8 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x1d h4 y1377 ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _53"> </span><span class="ff4">f<span class="_ _5"></span>or<span class="_ _a"> </span>sigmoid</span></div><div class="t m0 x96 h8 y1379 ff6 fs2 fc1 sc0 ls0 ws0">(<span class="ffc">1<span class="_ _b"> </span><span class="ff5">−<span class="_ _b"></span></span>z</span></div><div class="t m0 x39 h6 y13e3 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xd5 h8 y1379 ff5 fs2 fc1 sc0 ls0 ws0">⊙<span class="_ _b"></span><span class="ffc">z</span></div><div class="t m0 x1e h6 y13e3 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x56 h4 y1379 ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _11"> </span><span class="ff4">for<span class="_ _6"> </span>ta<span class="_ _5"></span>nh</span></div><div class="t m0 x3 h4 y119e ff4 fs2 fc1 sc0 ls0 ws0">For<span class="_ _a"> </span>ReLU,<span class="_ _3"> </span>we<span class="_ _a"> </span>have<span class="_ _a"> </span>to<span class="_ _a"> </span>apply<span class="_ _3"> </span>E<span class="_"> </span>q.<span class="_ _a"> </span>(25<span class="_ _5"></span>.9)<span class="_ _a"> </span>to<span class="_ _3"> </span>eac<span class="_ _5"></span>h<span class="_ _3"> </span>neuron.<span class="_ _a"> </span>Note<span class="_ _a"> </span>that<span class="_ _a"> </span>softmax<span class="_ _a"> </span>is<span class="_ _3"> </span>ge<span class="_ _5"></span>nerally</div><div class="t m0 x3 h4 y13e5 ff4 fs2 fc1 sc0 ls0 ws0">not<span class="_ _a"> </span>used<span class="_ _a"> </span>for<span class="_ _3"> </span>hidden<span class="_ _a"> </span>layers.</div><div class="t m0 x6 h4 y13e6 ff4 fs2 fc1 sc0 ls0 ws0">The<span class="_ _7"> </span>net<span class="_ _7"> </span>gradients<span class="_ _7"> </span>are<span class="_ _7"> </span>computed<span class="_ _7"> </span>recursively,<span class="_ _7"> </span>starting<span class="_ _7"> </span>from<span class="_ _7"> </span>the<span class="_ _7"> </span>output<span class="_ _7"> </span>layer<span class="_ _7"> </span><span class="ff6">h<span class="_ _4"> </span><span class="ff5">+<span class="_ _b"></span></span></span>1,</div><div class="t m0 x3 h4 ya49 ff4 fs2 fc1 sc0 ls0 ws0">then<span class="_ _7"> </span>hidden<span class="_ _6"> </span>layer<span class="_ _7"> </span><span class="ff6">h</span>,<span class="_ _7"> </span>and<span class="_ _6"> </span>so<span class="_ _7"> </span>on,<span class="_ _7"> </span>until<span class="_ _6"> </span>we<span class="_ _7"> </span>ﬁnally<span class="_ _7"> </span>c<span class="_ _5"></span>ompute<span class="_ _7"> </span>the<span class="_ _7"> </span>ne<span class="_ _5"></span>t<span class="_ _7"> </span>gradients<span class="_ _7"> </span>at<span class="_ _6"> </span>the<span class="_ _7"> </span>ﬁrst</div><div class="t m0 x3 h4 y13e7 ff4 fs2 fc1 sc0 ls0 ws0">hidden<span class="_ _a"> </span>layer<span class="_ _a"> </span><span class="ff6">l<span class="_ _3"> </span><span class="ff5">=<span class="_ _3"> </span></span></span>1.<span class="_ _a"> </span>That<span class="_ _a"> </span>is,</div><div class="t m0 xc1 h30 y12f0 ff11 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x6e h6 y13e8 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xb5 h8 y12f0 ff5 fs2 fc1 sc0 ls0 ws0">=<span class="_ _4"></span><span class="ff6">∂<span class="_ _f"></span><span class="ffc">f</span></span></div><div class="t m0 x109 h6 y13e9 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xfd h8 y12f0 ff5 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 xeb h18 y13ea ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x5f h1a y12f0 ffc fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xb7 h6 y138e ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xab h8 y12f0 ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff11">δ</span></div><div class="t m0 x87 h5 y13e8 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x5d h18 y13ea ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xe2 h30 y13eb ff11 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x16 h5 y13ec ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">−<span class="ff4">1</span></span></div><div class="t m0 xb5 h8 y13eb ff5 fs2 fc1 sc0 ls0 ws0">=<span class="_ _4"></span><span class="ff6">∂<span class="_ _f"></span><span class="ffc">f</span></span></div><div class="t m0 x109 h5 y13ed ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">−<span class="ff4">1</span></span></div><div class="t m0 x44 h8 y13eb ff5 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 xc2 h18 y13ee ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xb7 h1a y13eb ffc fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 x32 h5 y13ef ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">−<span class="ff4">1</span></span></div><div class="t m0 x90 h8 y13eb ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff11">δ</span></div><div class="t m0 x46 h6 y13ec ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x9b h18 y13ee ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x100 h8 y13eb ff5 fs2 fc1 sc0 ls0 ws0">=<span class="_ _4"></span><span class="ff6">∂<span class="_ _f"></span><span class="ffc">f</span></span></div><div class="t m0 x54 h5 y13ed ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">−<span class="ff4">1</span></span></div><div class="t m0 x3b h8 y13eb ff5 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 x1b h18 y13f0 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x3c h1a y13eb ffc fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xee h5 y13ef ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">−<span class="ff4">1</span></span></div><div class="t m0 xd3 h8 y13eb ff5 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 xb1 h18 y13ee ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x99 h1a y13eb ff6 fs2 fc1 sc0 ls0 ws0">∂<span class="_ _f"></span><span class="ffc">f</span></div><div class="t m0 x3f h6 y13ed ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xf h8 y13eb ff5 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 x28 h18 y13ee ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xd6 h1a y13eb ffc fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xdc h6 y13ef ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xe5 h8 y13eb ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff11">δ</span></div><div class="t m0 x69 h5 y13ec ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x86 h18 y13ee ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x5c h18 y13f0 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x2e h7 y508 ff6 fs2 fc1 sc0 ls0 ws0">.</div><div class="t m0 x2e h7 y13f1 ff6 fs2 fc1 sc0 ls0 ws0">.</div><div class="t m0 x2e h7 y13f2 ff6 fs2 fc1 sc0 ls0 ws0">.</div><div class="t m0 xc1 h30 y12bf ff11 fs2 fc1 sc0 ls0 ws0">δ</div><div class="t m0 x6e h5 y13f3 ff4 fs3 fc1 sc0 ls0 ws0">1</div><div class="t m0 xb5 h8 y12bf ff5 fs2 fc1 sc0 ls0 ws0">=<span class="_ _4"></span><span class="ff6">∂<span class="_ _f"></span><span class="ffc">f</span></span></div><div class="t m0 x109 h5 y13f4 ff4 fs3 fc1 sc0 ls0 ws0">1</div><div class="t m0 xfd h8 y12bf ff5 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 xeb h18 y13f5 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x8 h1a y12bf ffc fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xec h5 y13f6 ff4 fs3 fc1 sc0 ls0 ws0">1</div><div class="t m0 x32 h8 y12bf ff5 fs2 fc1 sc0 ls0 ws0">·</div><div class="t m0 xa2 h18 y13f5 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xa8 h1a y12bf ff6 fs2 fc1 sc0 ls0 ws0">∂<span class="_ _f"></span><span class="ffc">f</span></div><div class="t m0 xc7 h5 y13f4 ff4 fs3 fc1 sc0 ls0 ws0">2</div><div class="t m0 x9b h8 y12bf ff5 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 x47 h18 y13f7 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x88 h1a y12bf ffc fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 x33 h5 y13f6 ff4 fs3 fc1 sc0 ls0 ws0">2</div><div class="t m0 x30 h8 y12bf ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span>·<span class="_ _0"></span>·<span class="_ _0"></span>·</div><div class="t m0 x118 h18 y13f8 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x1b h1a y12bf ff6 fs2 fc1 sc0 ls0 ws0">∂<span class="_ _f"></span><span class="ffc">f</span></div><div class="t m0 x93 h6 y13f4 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x49 h8 y12bf ff5 fs2 fc1 sc0 ls0 ws0">⊙</div><div class="t m0 xa4 h18 y13f8 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xb1 h1a y12bf ffc fs2 fc1 sc0 ls0 ws0">W</div><div class="t m0 xa5 h6 y13f6 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 xbd h8 y12bf ff5 fs2 fc1 sc0 ls0 ws0">·<span class="_ _b"></span><span class="ff11">δ</span></div><div class="t m0 x10 h5 y13f3 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xb3 h18 y13f8 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 xfc h18 y13f7 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x84 h18 y13f5 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x3 h28 y13f9 ff1 fs4 fc2 sc0 ls0 ws0">25.4.5<span class="_ _d"> </span><span class="ff8 fse fc1">T<span class="_ _17"></span>r<span class="_ _2"></span>aining<span class="_ _7"> </span>Deep<span class="_ _7"> </span>MLPs</span></div><div class="t m0 x3 h4 ya ff4 fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _7"> </span>25.2<span class="_ _a"> </span>shows<span class="_ _7"> </span>the<span class="_ _7"> </span>pseudo-code<span class="_ _7"> </span>for<span class="_ _a"> </span>lea<span class="_ _5"></span>rning<span class="_ _7"> </span>the<span class="_ _a"> </span>weig<span class="_"> </span>ht<span class="_ _5"></span>s<span class="_ _a"> </span>and<span class="_ _7"> </span>biases<span class="_ _7"> </span>for<span class="_ _7"> </span>a<span class="_ _a"> </span>dee<span class="_ _5"></span>p</div><div class="t m0 x3 h4 yb ff4 fs2 fc1 sc0 ls0 ws0">MLP.<span class="_ _4"> </span>The<span class="_ _4"> </span>inputs<span class="_ _4"> </span>comprise<span class="_ _4"> </span>the<span class="_ _4"> </span>dataset<span class="_ _4"> </span><span class="ffc">D</span>,<span class="_ _4"> </span>the<span class="_ _b"> </span>number<span class="_ _4"> </span>of<span class="_ _4"> </span>hidden<span class="_ _4"> </span>lay<span class="_ _5"></span>ers<span class="_ _4"> </span><span class="ff6">h</span>,<span class="_ _4"> </span>the<span class="_ _b"> </span>ste<span class="_ _5"></span>p<span class="_ _b"> </span>size<span class="_ _3"> </span>or</div><div class="t m0 x3 h4 yc ff4 fs2 fc1 sc0 ls0 ws0">learning<span class="_ _4"> </span>rate<span class="_ _4"> </span>for<span class="_ _3"> </span>gradient<span class="_ _4"> </span>desce<span class="_"> </span>nt<span class="_ _3"> </span><span class="ff6">η</span>,<span class="_ _3"> </span>an<span class="_ _4"> </span>integ<span class="_ _5"></span>er<span class="_ _4"> </span>threshold<span class="_ _4"> </span><span class="fff">maxi<span class="_ _5"></span>ter<span class="_ _4"> </span></span>denoting<span class="_ _4"> </span>the<span class="_ _4"> </span>number</div><div class="t m0 x3 h4 ye ff4 fs2 fc1 sc0 ls0 ws0">of<span class="_ _a"> </span>it<span class="_"> </span>e<span class="_ _5"></span>rations<span class="_ _a"> </span>for<span class="_ _7"> </span>training,<span class="_ _a"> </span>paramet<span class="_ _5"></span>ers<span class="_ _a"> </span><span class="ff6">n</span></div><div class="t m0 x53 h5 y13b4 ff4 fs3 fc1 sc0 ls0 ws0">1</div><div class="t m0 x39 h7 ye ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span>n</div><div class="t m0 x1d h5 y13b4 ff4 fs3 fc1 sc0 ls0 ws0">2</div><div class="t m0 x30 h8 ye ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span>n</div><div class="t m0 x3c h6 y13b4 ff6 fs3 fc1 sc0 ls0 ws0">h</div><div class="t m0 x48 h4 ye ff4 fs2 fc1 sc0 ls0 ws0">that<span class="_ _a"> </span>denote<span class="_ _7"> </span>the<span class="_ _a"> </span>number<span class="_ _7"> </span>of<span class="_ _7"> </span>neurons</div><div class="t m0 x3 h4 yf ff4 fs2 fc1 sc0 ls0 ws0">(excluding<span class="_ _7"> </span>bias,<span class="_ _7"> </span>which<span class="_ _6"> </span>will<span class="_ _7"> </span>be<span class="_ _6"> </span>added<span class="_ _7"> </span>automatica<span class="_"> </span>lly<span class="_ _5"></span>)<span class="_ _7"> </span>for<span class="_ _7"> </span>each<span class="_ _7"> </span>of<span class="_ _7"> </span>t<span class="_ _5"></span>he<span class="_ _7"> </span>hidden<span class="_ _6"> </span>layers<span class="_ _7"> </span><span class="ff6">l<span class="_ _7"> </span><span class="ff5">=</span></span></div><div class="t m0 x3 h4 y10 ff4 fs2 fc1 sc0 ls0 ws0">1<span class="ff6">,<span class="_ _0"></span></span>2<span class="ff6">,<span class="_ _0"></span><span class="ff5">·<span class="_ _f"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _0"></span>h</span>,<span class="_ _7"> </span>a<span class="_ _5"></span>nd<span class="_ _7"> </span>the<span class="_ _6"> </span>type<span class="_ _7"> </span>of<span class="_ _6"> </span>activation<span class="_ _7"> </span>funct<span class="_ _5"></span>ions<span class="_ _7"> </span><span class="ff6">f</span></div><div class="t m0 x59 h5 y168 ff4 fs3 fc1 sc0 ls0 ws0">1</div><div class="t m0 x5a h7 y10 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span>f</div><div class="t m0 x23 h5 y168 ff4 fs3 fc1 sc0 ls0 ws0">2</div><div class="t m0 xaf h8 y10 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ff5">·<span class="_ _0"></span>·<span class="_ _0"></span>·<span class="_ _a"> </span></span>,<span class="_ _f"></span>f</div><div class="t m0 xf1 h5 y168 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xd6 h4 y10 ff4 fs2 fc1 sc0 ls0 ws0">for<span class="_ _7"> </span>each<span class="_ _6"> </span>of<span class="_ _7"> </span>the<span class="_ _6"> </span>layers</div><div class="t m0 x3 h4 y11 ff4 fs2 fc1 sc0 ls0 ws0">(other<span class="_ _3"> </span>tha<span class="_ _5"></span>n<span class="_ _3"> </span>the<span class="_ _a"> </span>input<span class="_ _a"> </span>layer<span class="_ _3"> </span>that<span class="_ _a"> </span>uses<span class="_ _3"> </span>identity<span class="_ _a"> </span>activat<span class="_ _5"></span>ions).<span class="_ _3"> </span>The<span class="_ _3"> </span>size<span class="_ _a"> </span>of<span class="_ _a"> </span>the<span class="_ _3"> </span>input<span class="_ _a"> </span>(<span class="ff6">d<span class="_ _54"></span></span>)<span class="_ _a"> </span>and</div><div class="t m0 x3 h4 y12 ff4 fs2 fc1 sc0 ls0 ws0">output<span class="_ _a"> </span>(<span class="ff6">p</span>)<span class="_ _a"> </span>lay<span class="_ _5"></span>ers<span class="_ _3"> </span>is<span class="_ _a"> </span>dete<span class="_ _5"></span>rmined<span class="_ _3"> </span>directly<span class="_ _a"> </span>from<span class="_ _a"> </span><span class="ffc">D</span>.</div><div class="t m0 x6 h4 y13 ff4 fs2 fc1 sc0 ls0 ws0">The<span class="_ _7"> </span>MLP<span class="_ _6"> </span>ﬁrst<span class="_ _6"> </span>initializes<span class="_ _7"> </span>the<span class="_ _6"> </span><span class="ff6">(n</span></div><div class="t m0 xa3 h6 y14 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 xa9 h8 y13 ff5 fs2 fc1 sc0 ls0 ws0">×<span class="_ _4"></span><span class="ff6">n</span></div><div class="t m0 xea h5 y14 ff6 fs3 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 x30 h4 y13 ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _6"> </span><span class="ff4">weight<span class="_ _7"> </span>matrices<span class="_ _6"> </span><span class="ffc">W</span></span></div><div class="t m0 xe4 h6 y14 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x89 h4 y13 ff4 fs2 fc1 sc0 ls0 ws0">between<span class="_ _7"> </span>lay<span class="_ _5"></span>ers<span class="_ _7"> </span><span class="ff6">l<span class="_ _9"> </span></span>and</div><div class="t m0 x3 h4 y15 ff6 fs2 fc1 sc0 ls0 ws0">l<span class="_ _a"> </span><span class="ff5">+<span class="_ _3"> </span><span class="ff4">1<span class="_ _9"> </span>with<span class="_ _9"> </span>small<span class="_ _6"> </span>values<span class="_ _9"> </span>chosen<span class="_ _9"> </span>uni<span class="_ _2"></span>formly<span class="_ _9"> </span>at<span class="_ _6"> </span>random,<span class="_ _9"> </span>e.g.,<span class="_ _6"> </span>in<span class="_ _9"> </span>the<span class="_ _9"> </span>range<span class="_ _6"> </span>[<span class="ff5">−</span>0<span class="_ _5"></span><span class="ff6">.</span>01<span class="ff6">,<span class="_ _0"> </span></span>0<span class="ff6">.</span>01<span class="_ _5"></span>].</span></span></div><div class="t m0 x3 h4 y17 ff4 fs2 fc1 sc0 ls0 ws0">The<span class="_ _7"> </span>MLP<span class="_ _a"> </span>considers<span class="_ _7"> </span>each<span class="_ _a"> </span>input<span class="_ _7"> </span>pair<span class="_ _7"> </span><span class="ff6">(<span class="ffc">x</span></span></div><div class="t m0 x91 h6 y18 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xe9 h1a y17 ff6 fs2 fc1 sc0 ls0 ws0">,<span class="_ _f"></span><span class="ffc">y</span></div><div class="t m0 x54 h6 y18 ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x1d h4 y17 ff6 fs2 fc1 sc0 ls0 ws0">)<span class="_ _3"> </span><span class="ff5">∈<span class="_ _a"> </span><span class="ffc">D<span class="ff4">,<span class="_ _a"> </span>and<span class="_ _7"> </span>computes<span class="_ _a"> </span>t<span class="_"> </span>he<span class="_ _7"> </span>predicted<span class="_ _7"> </span>response</span></span></span></div><div class="t m0 x3 h1a y19 ffc fs2 fc1 sc0 ls0 ws0">o</div><div class="t m0 x62 h6 y13fa ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x61 h4 y19 ff4 fs2 fc1 sc0 ls0 ws0">via<span class="_ _a"> </span>the<span class="_ _7"> </span>feed-f<span class="_"> </span>orwa<span class="_"> </span>rd<span class="_ _7"> </span>process.<span class="_ _a"> </span>The<span class="_ _7"> </span>backpropagat<span class="_ _5"></span>ion<span class="_ _a"> </span>phase<span class="_ _7"> </span>begins<span class="_ _a"> </span>by<span class="_ _7"> </span>computing<span class="_ _7"> </span>the</div><div class="t m0 x3 h4 y1a ff4 fs2 fc1 sc0 ls0 ws0">error<span class="_ _7"> </span>betwee<span class="_ _5"></span>n<span class="_ _a"> </span><span class="ffc">o</span></div><div class="t m0 xde h6 y13fb ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 xc5 h4 y1a ff4 fs2 fc1 sc0 ls0 ws0">and<span class="_ _7"> </span>true<span class="_ _7"> </span>response<span class="_ _7"> </span><span class="ffc">y</span></div><div class="t m0 x37 h6 y13fb ff6 fs3 fc1 sc0 ls0 ws0">i</div><div class="t m0 x91 h4 y1a ff4 fs2 fc1 sc0 ls0 ws0">,<span class="_ _7"> </span>and<span class="_ _7"> </span>computing<span class="_ _7"> </span>the<span class="_ _7"> </span>net<span class="_ _7"> </span>gradient<span class="_ _7"> </span>ve<span class="_ _5"></span>ctor<span class="_ _7"> </span><span class="ff11">δ</span></div><div class="t m0 xb h5 y171 ff6 fs3 fc1 sc0 ls0 ws0">h<span class="ff5">+<span class="ff4">1</span></span></div><div class="t m0 xf7 h4 y1a ff4 fs2 fc1 sc0 ls0 ws0">at</div><div class="t m0 x3 h4 y1b ff4 fs2 fc1 sc0 ls0 ws0">the<span class="_ _7"> </span>output<span class="_ _a"> </span>lay<span class="_ _5"></span>er.<span class="_ _a"> </span>These<span class="_ _7"> </span>net<span class="_ _7"> </span>gradient<span class="_"> </span>s<span class="_ _7"> </span>are<span class="_ _7"> </span>backpropagated<span class="_ _a"> </span>f<span class="_ _5"></span>rom<span class="_ _a"> </span>la<span class="_ _5"></span>yer<span class="_ _7"> </span><span class="ff6">h<span class="_ _b"> </span><span class="ff5">+<span class="_ _4"></span></span></span>1<span class="_ _a"> </span>t<span class="_ _5"></span>o<span class="_ _7"> </span>layer<span class="_ _a"> </span><span class="ff6">h</span>,</div><div class="t m0 x3 h4 y1c ff4 fs2 fc1 sc0 ls0 ws0">from<span class="_ _6"> </span><span class="ff6">h<span class="_ _6"> </span></span>to<span class="_ _7"> </span><span class="ff6">h<span class="_ _3"> </span><span class="ff5">−<span class="_ _4"></span></span></span>1,<span class="_ _6"> </span>and<span class="_ _6"> </span>so<span class="_ _6"> </span>on<span class="_ _6"> </span>until<span class="_ _7"> </span>we<span class="_ _6"> </span>obtain<span class="_ _6"> </span>the<span class="_ _6"> </span>net<span class="_ _6"> </span>gradients<span class="_ _7"> </span>a<span class="_ _5"></span>t<span class="_ _6"> </span>the<span class="_ _7"> </span>ﬁrst<span class="_ _6"> </span>hidden<span class="_ _6"> </span>lay<span class="_ _5"></span>er</div><div class="t m0 x3 h4 y1d ff6 fs2 fc1 sc0 ls0 ws0">l<span class="_ _a"> </span><span class="ff5">=<span class="_ _4"></span><span class="ff4">1.<span class="_ _3"> </span>These<span class="_ _a"> </span>net<span class="_ _a"> </span>gradients<span class="_ _3"> </span>are<span class="_ _a"> </span>used<span class="_ _3"> </span>t<span class="_ _5"></span>o<span class="_ _3"> </span>compute<span class="_ _a"> </span>the<span class="_ _3"> </span>we<span class="_ _5"></span>ight<span class="_ _3"> </span>gra<span class="_"> </span>die<span class="_ _5"></span>nt<span class="_ _3"> </span>matrix<span class="_ _a"> </span><span class="ff12">∇</span></span></span></div><div class="t m0 xe8 h2a y176 ffc fs3 fc1 sc0 ls0 ws0">W</div><div class="t m0 xa6 h26 y139 ff6 fsd fc1 sc0 ls0 ws0">l</div><div class="t m0 x76 h4 y1d ff4 fs2 fc1 sc0 ls0 ws0">at<span class="_ _a"> </span>layer</div><div class="t m0 x3 h4 y177 ff6 fs2 fc1 sc0 ls0 ws0">l<span class="_ _5"></span><span class="ff4">,<span class="_ _3"> </span>which<span class="_ _3"> </span>can<span class="_ _3"> </span>in<span class="_ _3"> </span>turn<span class="_ _4"> </span>be<span class="_ _3"> </span>used<span class="_ _3"> </span>to<span class="_ _4"> </span>update<span class="_ _3"> </span>the<span class="_ _3"> </span>weight<span class="_ _4"> </span>mat<span class="_ _5"></span>rix<span class="_ _4"> </span><span class="ffc">W</span></span></div><div class="t m0 xa5 h6 y178 ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x68 h4 y177 ff4 fs2 fc1 sc0 ls0 ws0">.<span class="_ _4"> </span>Likewise,<span class="_ _3"> </span>the<span class="_ _4"> </span>ne<span class="_ _5"></span>t<span class="_ _4"> </span>gradie<span class="_ _5"></span>nts</div><div class="t m0 x3 h4 y179 ff4 fs2 fc1 sc0 ls0 ws0">specify<span class="_ _7"> </span>t<span class="_ _5"></span>he<span class="_ _7"> </span>bias<span class="_ _6"> </span>gradient<span class="_ _6"> </span>vector<span class="_ _7"> </span><span class="ff12">∇</span></div><div class="t m0 x46 h2a y13fc ffc fs3 fc1 sc0 ls0 ws0">b</div><div class="t m0 x82 h26 y13fd ff6 fsd fc1 sc0 ls0 ws0">l</div><div class="t m0 x36 h4 y179 ff4 fs2 fc1 sc0 ls0 ws0">at<span class="_ _7"> </span>la<span class="_ _5"></span>yer<span class="_ _7"> </span><span class="ff6">l<span class="_ _54"></span></span>,<span class="_ _6"> </span>which<span class="_ _7"> </span>is<span class="_ _6"> </span>used<span class="_ _6"> </span>to<span class="_ _7"> </span>update<span class="_ _6"> </span><span class="ffc">b</span></div><div class="t m0 xf3 h6 y13fc ff6 fs3 fc1 sc0 ls0 ws0">l</div><div class="t m0 x5b h4 y179 ff4 fs2 fc1 sc0 ls0 ws0">.<span class="_ _6"> </span>After<span class="_ _7"> </span>each</div><div class="t m0 x3 h4 y17a ff4 fs2 fc1 sc0 ls0 ws0">point<span class="_ _6"> </span>has<span class="_ _7"> </span>be<span class="_"> </span>e<span class="_ _5"></span>n<span class="_ _6"> </span>used<span class="_ _7"> </span>t<span class="_ _5"></span>o<span class="_ _6"> </span>update<span class="_ _6"> </span>the<span class="_ _6"> </span>weights,<span class="_ _7"> </span>that<span class="_ _6"> </span>complete<span class="_"> </span>s<span class="_ _6"> </span>one<span class="_ _6"> </span>iteration<span class="_ _6"> </span>or<span class="_ _6"> </span>epoch<span class="_ _6"> </span>of</div><div class="t m0 x3 h4 y17b ff4 fs2 fc1 sc0 ls0 ws0">training.<span class="_ _6"> </span>The<span class="_ _9"> </span>training<span class="_ _6"> </span>stops<span class="_ _6"> </span>when<span class="_ _9"> </span><span class="fff">maxiter<span class="_ _6"> </span></span>epochs<span class="_ _6"> </span>hav<span class="_ _5"></span>e<span class="_ _6"> </span>been<span class="_ _6"> </span>reache<span class="_ _5"></span>d.<span class="_ _6"> </span>On<span class="_ _6"> </span>the<span class="_ _9"> </span>other</div><div class="t m0 x3 h4 y17c ff4 fs2 fc1 sc0 ls0 ws0">hand,<span class="_ _6"> </span>during<span class="_ _9"> </span>testing,<span class="_ _6"> </span>for<span class="_ _9"> </span>any<span class="_ _6"> </span>input<span class="_ _6"> </span><span class="ffc">x<span class="_ _5"></span></span>,<span class="_ _6"> </span>we<span class="_ _9"> </span>apply<span class="_ _6"> </span>the<span class="_ _6"> </span>f<span class="_ _5"></span>eed-forward<span class="_ _6"> </span>steps<span class="_ _9"> </span>and<span class="_ _6"> </span>print<span class="_ _6"> </span>t<span class="_ _5"></span>he</div><div class="t m0 x3 h4 y1f ff4 fs2 fc1 sc0 ls0 ws0">predicted<span class="_ _a"> </span>output<span class="_ _3"> </span><span class="ffc">o</span>.</div><div class="t m0 x6 h4 y20 ff4 fs2 fc1 sc0 ls0 ws0">It<span class="_ _6"> </span>is<span class="_ _6"> </span>important<span class="_ _6"> </span>to<span class="_ _6"> </span>note<span class="_ _6"> </span>that<span class="_ _6"> </span>Algorithm<span class="_ _6"> </span>25<span class="_ _5"></span>.2<span class="_ _6"> </span>follows<span class="_ _6"> </span>a<span class="_ _6"> </span>stochastic<span class="_ _6"> </span>gradient<span class="_ _6"> </span>descent</div><div class="t m0 x3 h4 y21 ff4 fs2 fc1 sc0 ls0 ws0">approach,<span class="_ _6"> </span>since<span class="_ _6"> </span>the<span class="_ _6"> </span>points<span class="_ _6"> </span>are<span class="_ _6"> </span>c<span class="_"> </span>onsidered<span class="_ _9"> </span>in<span class="_ _6"> </span>random<span class="_ _6"> </span>order,<span class="_ _6"> </span>and<span class="_ _6"> </span>the<span class="_ _6"> </span>weig<span class="_ _5"></span>ht<span class="_ _6"> </span>and<span class="_ _6"> </span>bias</div><div class="t m0 x3 h4 y22 ff4 fs2 fc1 sc0 ls0 ws0">gradients<span class="_ _7"> </span>are<span class="_ _7"> </span>computed<span class="_ _7"> </span>after<span class="_ _7"> </span>observing<span class="_ _7"> </span>each<span class="_ _7"> </span>training<span class="_ _7"> </span>point.<span class="_ _a"> </span>In<span class="_ _6"> </span>practice,<span class="_ _7"> </span>it<span class="_ _7"> </span>is<span class="_ _7"> </span>common</div><div class="c x14 y24 w2 hb"><div class="t m1 x15 hc y25 ff9 fs6 fc1 sc0 ls0 ws0"><span class="fc4 sc0">For Online Reading </span><span class="fc4 sc0">Only</span></div></div><div class="c x16 y26 w3 hd"><div class="t m0 x17 he y27 ff9 fs7 fc3 sc0 ls0 ws0">This version is for online reading only. Unauthorized distribution is not allowed. </div><div class="t m0 x0 he y28 ff9 fs7 fc3 sc0 ls0 ws0">Please cite the book if you find it useful, and leave a review on online platforms.<span class="fc4 sc0"> </span></div><div class="t m0 x18 he y29 ff9 fs7 fc3 sc0 ls0 ws0">Please report all errata to contact@dataminingbook.info</div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
