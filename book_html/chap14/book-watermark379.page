<div id="pf17b" class="pf w0 h0" data-page-no="17b"><div class="pc pc17b w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg17b.png"/><div class="t m0 x4d h12 y36 ffe fs0 fc1 sc0 ls0 ws0">Agglomerative<span class="_ _b"> </span>H<span class="_ _5"></span>ierarchical<span class="_ _b"> </span>Clustering<span class="_ _1a"> </span><span class="ff2">367</span></div><div class="t m0 x59 h4 y8c ff3 fs2 fc1 sc0 ls0 ws0">clusterings.<span class="_ _6"> </span>If<span class="_ _7"> </span>specified,<span class="_ _6"> </span>we<span class="_ _6"> </span>ca<span class="_ _5"></span>n<span class="_ _6"> </span>stop<span class="_ _6"> </span>the<span class="_ _7"> </span>merging<span class="_ _6"> </span>process<span class="_ _7"> </span>when<span class="_ _6"> </span>there<span class="_ _7"> </span>are<span class="_ _6"> </span>exact<span class="_ _5"></span>ly<span class="_ _12"> </span><span class="ff4">k</span></div><div class="t m0 x59 h4 y8d ff3 fs2 fc1 sc0 ls0 ws0">clusters<span class="_ _3"> </span>remaining.</div><div class="t m0 x5c h4 y8e ffc fs2 fc1 sc0 ls0 ws0">Algorithm<span class="_ _c"> </span>14.1:<span class="_ _3"> </span><span class="ff3">Agglome<span class="_"> </span>ra<span class="_ _5"></span>tive<span class="_ _b"> </span>Hierarchica<span class="_ _5"></span>l<span class="_ _3"> </span>Clustering<span class="_ _3"> </span>Algorithm</span></div><div class="t m0 x7d hc y8f ff7 fs2 fc1 sc0 ls0 ws0">A<span class="fs5">G<span class="_ _13"></span>G<span class="_ _13"></span>L<span class="_ _5"></span>O<span class="_ _13"></span>M<span class="_ _13"></span>E<span class="_ _13"></span>R<span class="_ _5"></span>A<span class="_ _13"></span>T<span class="_ _13"></span>I<span class="_ _5"></span>V<span class="_ _13"></span>E<span class="_ _5"></span></span>C<span class="_ _5"></span><span class="fs5">L<span class="_ _13"></span>U<span class="_ _5"></span>S<span class="_ _13"></span>T<span class="_ _13"></span>E<span class="_ _5"></span>R<span class="_ _13"></span>I<span class="_ _13"></span>N<span class="_ _13"></span>G<span class="_ _5"></span></span>(D<span class="ff4">,<span class="_ _4"></span>k<span class="_ _13"></span></span>):</div><div class="t m0 x56 h8 y90 ff7 fsa fc1 sc0 ls0 ws0">1<span class="_ _10"> </span><span class="ffa fs2">C<span class="_ _c"> </span><span class="ff8">←<span class="_ _b"> </span>{<span class="ff5">C</span></span></span></div><div class="t m0 x5a h6 y91 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x1a h7 y90 ff8 fs2 fc1 sc0 ls0 ws0">=<span class="_ _a"></span>{<span class="_ _5"></span><span class="ff7">x</span></div><div class="t m0 x5d h6 y91 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x7e h7 y90 ff8 fs2 fc1 sc0 ls0 ws0">}<span class="_ _a"></span>|<span class="_ _b"> </span><span class="ff7">x</span></div><div class="t m0 x53 h6 y91 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x72 h7 y90 ff8 fs2 fc1 sc0 ls0 ws0">∈<span class="_ _b"> </span><span class="ff7">D</span>}<span class="_ _3"> </span><span class="ff10">//<span class="_"> </span>Each<span class="_"> </span>point<span class="_"> </span>in<span class="_"> </span>separa<span class="_ _5"></span>te<span class="_ _10"> </span>clu<span class="_ _5"></span>ster</span></div><div class="t m0 x56 h7 y92 ff7 fsa fc1 sc0 ls0 ws0">2<span class="_ _10"> </span><span class="ff11 fs2">1<span class="_ _b"> </span><span class="ff8">←<span class="_ _b"> </span>{k<span class="ff7">x</span></span></span></div><div class="t m0 x1a h6 y93 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x7f h7 y92 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _11"></span><span class="ff7">x</span></div><div class="t m0 x5d h6 y93 ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x7e h4 y92 ff8 fs2 fc1 sc0 ls0 ws0">k<span class="_ _4"></span><span class="ff3">:<span class="_ _7"> </span><span class="ff7">x</span></span></div><div class="t m0 x3a h6 y93 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x72 hc y92 ff4 fs2 fc1 sc0 ls0 ws0">,<span class="_ _4"></span><span class="ff7">x</span></div><div class="t m0 x2e h6 y93 ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x34 h7 y92 ff8 fs2 fc1 sc0 ls0 ws0">∈<span class="_ _b"> </span><span class="ff7">D</span>}<span class="_ _3"> </span><span class="ff10">//<span class="_"> </span>Comput<span class="_ _5"></span>e<span class="_ _10"> </span>d<span class="_ _5"></span>istanc<span class="_ _5"></span>e<span class="_ _10"> </span>mat<span class="_ _5"></span>rix</span></div><div class="t m0 x56 hc y94 ff7 fsa fc1 sc0 ls0 ws0">3<span class="_ _10"> </span><span class="fs2">repe<span class="_"> </span>a<span class="_ _5"></span>t</span></div><div class="t m0 x56 h4 y95 ff7 fsa fc1 sc0 ls0 ws0">4<span class="_ _1b"> </span><span class="ff3 fs2">Find<span class="_ _3"> </span>the<span class="_ _3"> </span>closest<span class="_ _3"> </span>pair<span class="_ _3"> </span>of<span class="_ _3"> </span>clusters<span class="_ _3"> </span><span class="ff5">C</span></span></div><div class="t m0 x5 h6 y96 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x38 ha y95 ff4 fs2 fc1 sc0 ls0 ws0">,<span class="_ _4"></span><span class="ff5">C</span></div><div class="t m0 x74 h6 y96 ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x75 h8 y95 ff8 fs2 fc1 sc0 ls0 ws0">∈<span class="_ _b"> </span><span class="ffa">C</span></div><div class="t m0 x56 ha y97 ff7 fsa fc1 sc0 ls0 ws0">5<span class="_ _1b"> </span><span class="ff5 fs2">C</span></div><div class="t m0 x80 h6 y98 ff4 fs4 fc1 sc0 ls0 ws0">i<span class="_ _2"></span>j</div><div class="t m0 x81 h7 y97 ff8 fs2 fc1 sc0 ls0 ws0">←<span class="_ _b"> </span><span class="ff5">C</span></div><div class="t m0 x82 h6 y98 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x5d h7 y97 ff8 fs2 fc1 sc0 ls0 ws0">∪<span class="_ _11"></span><span class="ff5">C</span></div><div class="t m0 x41 h6 y98 ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x3a h18 y97 ff10 fs2 fc1 sc0 ls0 ws0">//<span class="_"> </span>Merge<span class="_"> </span>the<span class="_"> </span>clust<span class="_ _5"></span>ers</div><div class="t m0 x56 h8 y99 ff7 fsa fc1 sc0 ls0 ws0">6<span class="_ _1b"> </span><span class="ffa fs2">C<span class="_ _3"> </span><span class="ff8">←</span></span></div><div class="t m0 x1a hb y9a ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x7f h8 y99 ffa fs2 fc1 sc0 ls0 ws0">C<span class="_ _b"> </span><span class="ff8">\<span class="_ _11"></span>{<span class="ff5">C</span></span></div><div class="t m0 x83 h6 y9b ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x84 ha y99 ff4 fs2 fc1 sc0 ls0 ws0">,<span class="_ _4"></span><span class="ff5">C</span></div><div class="t m0 x72 h6 y9b ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x2d h7 y99 ff8 fs2 fc1 sc0 ls0 ws0">}</div><div class="t m0 x2e hb y9a ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x3b h7 y99 ff8 fs2 fc1 sc0 ls0 ws0">∪<span class="_ _11"></span>{<span class="ff5">C</span></div><div class="t m0 x20 h6 y9b ff4 fs4 fc1 sc0 ls0 ws0">i<span class="_ _2"></span>j</div><div class="t m0 x85 h7 y99 ff8 fs2 fc1 sc0 ls0 ws0">}<span class="_ _3"> </span><span class="ff10">//<span class="_"> </span>Update<span class="_"> </span>the<span class="_"> </span>cluster<span class="_ _5"></span>ing</span></div><div class="t m0 x56 h4 y9c ff7 fsa fc1 sc0 ls0 ws0">7<span class="_ _1b"> </span><span class="ff3 fs2">Update<span class="_ _3"> </span>distance<span class="_ _3"> </span>matrix<span class="_ _3"> </span><span class="ff11">1<span class="_ _3"> </span></span>to<span class="_ _3"> </span>reﬂect<span class="_ _3"> </span>new<span class="_ _3"> </span>clustering</span></div><div class="t m0 x56 h8 y9d ff7 fsa fc1 sc0 ls0 ws0">8<span class="_ _10"> </span><span class="fs2">until<span class="_ _3"> </span><span class="ff8">|<span class="_ _5"></span><span class="ffa">C<span class="_ _13"></span></span>|<span class="_ _a"></span>=<span class="_ _b"> </span><span class="ff4">k</span></span></span></div><div class="t m0 x59 h19 y9e ff1 fs3 fc2 sc0 ls0 ws0">14.2.1<span class="_ _8"> </span><span class="ffc fsb fc1">Distance<span class="_ _f"> </span>betw<span class="_ _2"></span>een<span class="_ _f"> </span>Clusters</span></div><div class="t m0 x59 h4 y9f ff3 fs2 fc1 sc0 ls0 ws0">The<span class="_ _12"> </span>main<span class="_ _7"> </span>step<span class="_ _12"> </span>in<span class="_ _6"> </span>the<span class="_ _6"> </span>alg<span class="_ _5"></span>orithm<span class="_ _12"> </span>is<span class="_ _6"> </span>to<span class="_ _6"> </span>determine<span class="_ _12"> </span>the<span class="_ _6"> </span>closest<span class="_ _6"> </span>pair<span class="_ _6"> </span>of<span class="_ _6"> </span>clusters.<span class="_ _6"> </span>Seve<span class="_ _5"></span>ral</div><div class="t m0 x59 h4 ya0 ff3 fs2 fc1 sc0 ls0 ws0">distance<span class="_ _8"> </span>measures,<span class="_ _8"> </span>such<span class="_ _8"> </span>as<span class="_ _8"> </span>single<span class="_ _8"> </span>link,<span class="_ _8"> </span>complete<span class="_ _8"> </span>link,<span class="_ _8"> </span>g<span class="_ _5"></span>roup<span class="_ _10"> </span>av<span class="_ _5"></span>erage,<span class="_ _8"> </span>and<span class="_ _8"> </span>others</div><div class="t m0 x59 h4 ya1 ff3 fs2 fc1 sc0 ls0 ws0">discussed<span class="_ _f"> </span>in<span class="_ _9"> </span>the<span class="_ _9"> </span>following<span class="_ _f"> </span>para<span class="_ _5"></span>graphs,<span class="_ _f"> </span>ca<span class="_ _5"></span>n<span class="_ _f"> </span>be<span class="_ _f"> </span>used<span class="_ _9"> </span>t<span class="_ _5"></span>o<span class="_ _f"> </span>compute<span class="_ _9"> </span>the<span class="_ _f"> </span>distance<span class="_ _9"> </span>bet<span class="_"> </span>w<span class="_"> </span>e<span class="_ _5"></span>en</div><div class="t m0 x59 h4 ya2 ff3 fs2 fc1 sc0 ls0 ws0">any<span class="_ _f"> </span>two<span class="_ _9"> </span>clusters.<span class="_ _9"> </span>The<span class="_ _f"> </span>be<span class="_ _5"></span>tween-cluster<span class="_ _f"> </span>distances<span class="_ _9"> </span>are<span class="_ _f"> </span>ultima<span class="_ _5"></span>tely<span class="_ _f"> </span>base<span class="_"> </span>d<span class="_ _9"> </span>on<span class="_ _9"> </span>the<span class="_ _f"> </span>distance</div><div class="t m0 x59 h4 ya3 ff3 fs2 fc1 sc0 ls0 ws0">between<span class="_ _10"> </span>two<span class="_ _1"> </span>points,<span class="_ _10"> </span>w<span class="_"> </span>hich<span class="_ _10"> </span>is<span class="_ _10"> </span>typica<span class="_ _5"></span>lly<span class="_ _1"> </span>computed<span class="_ _10"> </span>using<span class="_ _10"> </span>the<span class="_ _10"> </span>Euclidean<span class="_ _10"> </span>distance<span class="_ _10"> </span>or</div><div class="t m0 x59 ha ya4 ff5 fs2 fc1 sc0 ls0 ws0">L</div><div class="t m0 x3 h9 ya5 ff3 fs4 fc1 sc0 ls0 ws0">2</div><div class="t m0 x1 h4 ya4 ff3 fs2 fc1 sc0 ls0 ws0">-<span class="ff4">nor<span class="_ _4"></span>m</span>,<span class="_ _3"> </span>defined<span class="_ _3"> </span>as</div><div class="t m0 x4f h7 ya6 ff8 fs2 fc1 sc0 ls0 ws0">k<span class="ff7">x<span class="_ _11"> </span></span>−<span class="_ _11"></span><span class="ff7">y<span class="_ _5"></span></span>k<span class="_ _a"></span>=</div><div class="t m0 x31 hb ya7 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x6c h6 ya8 ff4 fs4 fc1 sc0 ls0 ws0">d</div><div class="t m0 x32 hb ya9 ffb fs2 fc1 sc0 ls0 ws0">X</div><div class="t m0 x12 h9 yaa ff4 fs4 fc1 sc0 ls0 ws0">i<span class="_ _5"></span><span class="ff8">=<span class="ff3">1</span></span></div><div class="t m0 x55 h1a ya6 ff4 fs2 fc1 sc0 ls0 ws0">(x</div><div class="t m0 x86 h6 yab ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x6 h7 ya6 ff8 fs2 fc1 sc0 ls0 ws0">−<span class="_ _11"></span><span class="ff4">y</span></div><div class="t m0 x6d h6 yab ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x7 h1a ya6 ff4 fs2 fc1 sc0 ls0 ws0">)</div><div class="t m0 x45 h9 yac ff3 fs4 fc1 sc0 ls0 ws0">2</div><div class="t m0 x4e hb ya7 ffb fs2 fc1 sc0 ls0 ws0"></div><div class="t m0 x87 h9 yad ff3 fs4 fc1 sc0 ls0 ws0">1<span class="ff4">/</span>2</div><div class="t m0 x59 h4 yae ff3 fs2 fc1 sc0 ls0 ws0">However,<span class="_ _3"> </span>one<span class="_ _c"> </span>may<span class="_ _3"> </span>use<span class="_ _3"> </span>othe<span class="_ _5"></span>r<span class="_ _3"> </span>distance<span class="_ _3"> </span>metrics,<span class="_ _c"> </span>or<span class="_ _3"> </span>if<span class="_ _3"> </span>a<span class="_ _5"></span>vailable<span class="_ _3"> </span>one<span class="_ _3"> </span>may<span class="_ _3"> </span>a<span class="_ _c"> </span>user-specified</div><div class="t m0 x59 h4 yaf ff3 fs2 fc1 sc0 ls0 ws0">distance<span class="_ _3"> </span>matrix.</div><div class="t m0 x59 h14 yb0 ffc fs2 fc1 sc0 ls0 ws0">Single<span class="_ _c"> </span>Link</div><div class="t m0 x59 h4 yb1 ff3 fs2 fc1 sc0 ls0 ws0">Given<span class="_ _b"> </span>t<span class="_ _5"></span>wo<span class="_ _3"> </span>clusters<span class="_ _b"> </span><span class="ff5">C</span></div><div class="t m0 x88 h6 yb2 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x7e h4 yb1 ff3 fs2 fc1 sc0 ls0 ws0">and<span class="_ _b"> </span><span class="ff5">C</span></div><div class="t m0 x2d h6 yb2 ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x89 h4 yb1 ff3 fs2 fc1 sc0 ls0 ws0">,<span class="_ _3"> </span>the<span class="_ _b"> </span>distance<span class="_ _3"> </span>betwe<span class="_ _5"></span>en<span class="_ _b"> </span>the<span class="_ _5"></span>m,<span class="_ _b"> </span>denote<span class="_ _5"></span>d<span class="_ _b"> </span><span class="ff4">δ<span class="_ _13"></span>(<span class="ff5">C</span></span></div><div class="t m0 x46 h6 yb2 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x47 ha yb1 ff4 fs2 fc1 sc0 ls0 ws0">,<span class="_ _4"></span><span class="ff5">C</span></div><div class="t m0 x2a h6 yb2 ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x1d h4 yb1 ff4 fs2 fc1 sc0 ls0 ws0">)<span class="ff3">,<span class="_ _3"> </span>is<span class="_ _b"> </span>def<span class="_ _5"></span>ined</span></div><div class="t m0 x59 h4 yb3 ff3 fs2 fc1 sc0 ls0 ws0">as<span class="_ _3"> </span>the<span class="_ _3"> </span>minimum<span class="_ _3"> </span>distance<span class="_ _3"> </span>betwee<span class="_"> </span>n<span class="_ _3"> </span>a<span class="_ _3"> </span>point<span class="_ _3"> </span>in<span class="_ _3"> </span><span class="ff5">C</span></div><div class="t m0 x38 h6 yb4 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x39 h4 yb3 ff3 fs2 fc1 sc0 ls0 ws0">and<span class="_ _3"> </span>a<span class="_ _3"> </span>point<span class="_ _3"> </span>in<span class="_ _3"> </span><span class="ff5">C</span></div><div class="t m0 x8a h6 yb4 ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x83 ha yb5 ff4 fs2 fc1 sc0 ls0 ws0">δ<span class="_ _5"></span>(<span class="ff5">C</span></div><div class="t m0 x8b h6 yb6 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x2d ha yb5 ff4 fs2 fc1 sc0 ls0 ws0">,<span class="_ _4"></span><span class="ff5">C</span></div><div class="t m0 x34 h6 yb6 ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x42 h4 yb5 ff4 fs2 fc1 sc0 ls0 ws0">)<span class="_ _a"> </span><span class="ff8">=<span class="_ _b"> </span><span class="ff3">min</span>{k<span class="ff7">x<span class="_ _a"> </span></span>−<span class="_ _11"></span><span class="ff7">y</span>k<span class="_ _a"></span>|<span class="_ _b"> </span><span class="ff7">x<span class="_ _b"> </span></span>∈<span class="_ _b"></span><span class="ff5">C</span></span></div><div class="t m0 x51 h6 yb6 ff4 fs4 fc1 sc0 ls0 ws0">i</div><div class="t m0 x8c h7 yb5 ff4 fs2 fc1 sc0 ls0 ws0">,<span class="_ _4"></span><span class="ff7">y<span class="_ _3"> </span><span class="ff8">∈<span class="_ _a"></span><span class="ff5">C</span></span></span></div><div class="t m0 x8d h6 yb6 ff4 fs4 fc1 sc0 ls0 ws0">j</div><div class="t m0 x8e h7 yb5 ff8 fs2 fc1 sc0 ls0 ws0">}</div><div class="t m0 x7b h4 yb7 ff3 fs2 fc1 sc0 ls0 ws0">(14.2)</div><div class="t m0 x59 h4 yb8 ff3 fs2 fc1 sc0 ls0 ws0">The<span class="_ _7"> </span>name<span class="_ _7"> </span><span class="ff5">single<span class="_ _7"> </span>link<span class="_ _7"> </span></span>c<span class="_"> </span>ome<span class="_ _5"></span>s<span class="_ _6"> </span>f<span class="_ _5"></span>rom<span class="_ _7"> </span>the<span class="_ _7"> </span>observa<span class="_"> </span>t<span class="_ _5"></span>ion<span class="_ _6"> </span>that<span class="_ _1"> </span>if<span class="_ _7"> </span>we<span class="_ _7"> </span>choose<span class="_ _7"> </span>the<span class="_ _7"> </span>minimum</div><div class="t m0 x59 h4 yb9 ff3 fs2 fc1 sc0 ls0 ws0">distance<span class="_ _f"> </span>between<span class="_ _c"> </span>points<span class="_ _f"> </span>in<span class="_ _f"> </span>the<span class="_ _c"> </span>two<span class="_ _f"> </span>clusters<span class="_ _f"> </span>and<span class="_ _c"> </span>connect<span class="_ _f"> </span>those<span class="_ _c"> </span>points,<span class="_ _f"> </span>then<span class="_ _f"> </span>(typically)</div><div class="t m0 x59 h4 yba ff3 fs2 fc1 sc0 ls0 ws0">only<span class="_ _f"> </span>a<span class="_ _c"> </span>single<span class="_ _f"> </span>link<span class="_ _f"> </span>would<span class="_ _c"> </span>e<span class="_ _5"></span>xist<span class="_ _c"> </span>be<span class="_ _5"></span>tween<span class="_ _c"> </span>those<span class="_ _f"> </span>clusters<span class="_ _f"> </span>because<span class="_ _f"> </span>all<span class="_ _c"> </span>othe<span class="_"> </span>r<span class="_ _f"> </span>pairs<span class="_ _f"> </span>of<span class="_ _f"> </span>points</div><div class="t m0 x59 h4 ybb ff3 fs2 fc1 sc0 ls0 ws0">would<span class="_ _3"> </span>be<span class="_ _3"> </span>farther<span class="_ _3"> </span>away<span class="_ _5"></span>.</div><div class="c x48 y30 w2 he"><div class="t m1 x49 hf y31 ffd fs6 fc1 sc0 ls0 ws0"><span class="fc4 sc0">For Online Reading </span><span class="fc4 sc0">Only</span></div></div><div class="c x4a y32 w3 h10"><div class="t m0 x4b h11 y33 ffd fs7 fc3 sc0 ls0 ws0">This version is for online reading only. Unauthorized distribution is not allowed. </div><div class="t m0 x0 h11 y34 ffd fs7 fc3 sc0 ls0 ws0">Please cite the book if you find it useful, and leave a review on online platforms.<span class="fc4 sc0"> </span></div><div class="t m0 x4c h11 y35 ffd fs7 fc3 sc0 ls0 ws0">Please report all errata to contact@dataminingbook.info</div></div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
